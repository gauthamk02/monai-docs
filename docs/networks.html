
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Network architectures &#8212; MONAI 1.5.1 Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=26ac546f" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=cb7e6255"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'networks';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Metrics" href="metrics.html" />
    <link rel="prev" title="Loss functions" href="losses.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.5.1" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/MONAI-logo-color.png" class="logo__image only-light" alt="MONAI 1.5.1 Documentation - Home"/>
    <img src="_static/MONAI-logo-color.png" class="logo__image only-dark pst-js-only" alt="MONAI 1.5.1 Documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="whatsnew.html">
    What’s New
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="highlights.html">
    Highlights
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="precision_accelerating.html">
    Precision and Accelerating
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="contrib.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="bundle_intro.html">
    Bundle
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="lazy_resampling.html">
    Lazy Resampling
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/Project-MONAI/tutorials">
    Tutorials
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/project-monai/monai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/projectmonai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="whatsnew.html">
    What’s New
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="highlights.html">
    Highlights
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="precision_accelerating.html">
    Precision and Accelerating
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contrib.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="bundle_intro.html">
    Bundle
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="lazy_resampling.html">
    Lazy Resampling
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/Project-MONAI/tutorials">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/project-monai/monai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/projectmonai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="apps.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto3dseg.html">Auto3dseg</a></li>
<li class="toctree-l1"><a class="reference internal" href="fl.html">Federated Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bundle.html">Model Bundle</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Loss functions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Network architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="inferers.html">Inference methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="handlers.html">Event handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize.html">Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="api.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Network architectures</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="network-architectures">
<span id="networks"></span><h1>Network architectures<a class="headerlink" href="#network-architectures" title="Link to this heading">#</a></h1>
<section id="module-monai.networks.blocks">
<span id="blocks"></span><h2>Blocks<a class="headerlink" href="#module-monai.networks.blocks" title="Link to this heading">#</a></h2>
<section id="adn">
<h3><cite>ADN</cite><a class="headerlink" href="#adn" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ADN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ADN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/acti_norm.py#L19-L101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ADN" title="Link to this definition">#</a></dt>
<dd><p>Constructs a sequential module of optional activation (A), dropout (D), and normalization (N) layers
with an arbitrary order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Norm</span><span class="p">)</span> <span class="o">--</span> <span class="p">(</span><span class="n">Dropout</span><span class="p">)</span> <span class="o">--</span> <span class="p">(</span><span class="n">Acti</span><span class="p">)</span> <span class="o">--</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the ordering of activation, dropout, and normalization. Defaults to “NDA”.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <cite>C</cite> from an expected input of size (N, C, H[, W, D]).</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>norm_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – determine the spatial dimensions of the normalization layer.
defaults to <cite>dropout_dim</cite> if unspecified.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>dropout_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>determine the spatial dimensions of dropout.
defaults to <cite>norm_dim</cite> if unspecified.</p>
<ul>
<li><p>When dropout_dim = 1, randomly zeroes some of the elements for each channel.</p></li>
<li><p>When dropout_dim = 2, Randomly zeroes out entire channels (a channel is a 2D feature map).</p></li>
<li><p>When dropout_dim = 3, Randomly zeroes out entire channels (a channel is a 3D feature map).</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># activation, group norm, dropout</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">norm_params</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;GROUP&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_groups&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;affine&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ADN</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm_params</span><span class="p">,</span> <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dropout_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ordering</span><span class="o">=</span><span class="s2">&quot;AND&quot;</span><span class="p">)</span>
<span class="n">ADN</span><span class="p">(</span>
    <span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="n">ReLU</span><span class="p">()</span>
    <span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">GroupNorm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">(</span><span class="n">D</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># LeakyReLU, dropout</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">act_params</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;leakyrelu&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;negative_slope&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;inplace&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ADN</span><span class="p">(</span><span class="n">act</span><span class="o">=</span><span class="n">act_params</span><span class="p">,</span> <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dropout_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ordering</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">)</span>
<span class="n">ADN</span><span class="p">(</span>
    <span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="n">LeakyReLU</span><span class="p">(</span><span class="n">negative_slope</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">(</span><span class="n">D</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#module-monai.networks.layers.Dropout" title="monai.networks.layers.Dropout"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Dropout</span></code></a>
<a class="reference internal" href="#module-monai.networks.layers.Act" title="monai.networks.layers.Act"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Act</span></code></a>
<a class="reference internal" href="#module-monai.networks.layers.Norm" title="monai.networks.layers.Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Norm</span></code></a>
<a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a></p>
</div>
</dd></dl>

</section>
<section id="convolution">
<h3><cite>Convolution</cite><a class="headerlink" href="#convolution" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.Convolution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Convolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_transposed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/convolutions.py#L25-L171"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Convolution" title="Link to this definition">#</a></dt>
<dd><p>Constructs a convolution with normalization, optional dropout, and optional activation layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Conv</span><span class="o">|</span><span class="n">ConvTrans</span><span class="p">)</span> <span class="o">--</span> <span class="p">(</span><span class="n">Norm</span> <span class="o">--</span> <span class="n">Dropout</span> <span class="o">--</span> <span class="n">Acti</span><span class="p">)</span> <span class="o">--</span>
</pre></div>
</div>
<p>if <code class="docutils literal notranslate"><span class="pre">conv_only</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="p">(</span><span class="n">Conv</span><span class="o">|</span><span class="n">ConvTrans</span><span class="p">)</span> <span class="o">--</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.blocks</span><span class="w"> </span><span class="kn">import</span> <span class="n">Convolution</span>

<span class="n">conv</span> <span class="o">=</span> <span class="n">Convolution</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">adn_ordering</span><span class="o">=</span><span class="s2">&quot;ADN&quot;</span><span class="p">,</span>
    <span class="n">act</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;prelu&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}),</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;normalized_shape&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)}),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conv</span><span class="p">)</span>
</pre></div>
</div>
<p>output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Convolution</span><span class="p">(</span>
  <span class="p">(</span><span class="n">conv</span><span class="p">):</span> <span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="n">adn</span><span class="p">):</span> <span class="n">ADN</span><span class="p">(</span>
    <span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="n">PReLU</span><span class="p">(</span><span class="n">num_parameters</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="n">D</span><span class="p">):</span> <span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">LayerNorm</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride. Defaults to 1.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size. Defaults to 3.</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the ordering of activation, normalization, and dropout.
Defaults to “NDA”.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>dropout_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>determine the spatial dimensions of dropout. Defaults to 1.</p>
<ul>
<li><p>When dropout_dim = 1, randomly zeroes some of the elements for each channel.</p></li>
<li><p>When dropout_dim = 2, Randomly zeroes out entire channels (a channel is a 2D feature map).</p></li>
<li><p>When dropout_dim = 3, Randomly zeroes out entire channels (a channel is a 3D feature map).</p></li>
</ul>
<p>The value of dropout_dim should be no larger than the value of <cite>spatial_dims</cite>.</p>
</p></li>
<li><p><strong>dilation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dilation rate. Defaults to 1.</p></li>
<li><p><strong>groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – controls the connections between inputs and outputs. Defaults to 1.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term. Defaults to True.</p></li>
<li><p><strong>conv_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use the convolutional layer only. Defaults to False.</p></li>
<li><p><strong>is_transposed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True uses ConvTrans instead of Conv. Defaults to False.</p></li>
<li><p><strong>padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – controls the amount of implicit zero-paddings on both sides for padding number of points
for each dimension. Defaults to None.</p></li>
<li><p><strong>output_padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – controls the additional size added to one side of the output shape.
Defaults to None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#module-monai.networks.layers.Conv" title="monai.networks.layers.Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Conv</span></code></a>
<a class="reference internal" href="#monai.networks.blocks.ADN" title="monai.networks.blocks.ADN"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ADN</span></code></a></p>
</div>
</dd></dl>

</section>
<section id="crf">
<h3><cite>CRF</cite><a class="headerlink" href="#crf" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.CRF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">CRF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bilateral_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bilateral_spatial_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bilateral_color_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_spatial_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compatibility_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/crf.py#L23-L111"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.CRF" title="Link to this definition">#</a></dt>
<dd><p>Conditional Random Field: Combines message passing with a class
compatibility convolution into an iterative process designed
to successively minimise the energy of the class labeling.</p>
<p>In this implementation, the message passing step is a weighted
combination of a gaussian filter and a bilateral filter.
The bilateral term is included to respect existing structure
within the reference tensor.</p>
<dl class="simple">
<dt>See:</dt><dd><p><a class="reference external" href="https://arxiv.org/abs/1502.03240">https://arxiv.org/abs/1502.03240</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.CRF.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bilateral_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bilateral_spatial_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bilateral_color_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_spatial_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compatibility_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/crf.py#L38-L69"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.CRF.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the number of iterations.</p></li>
<li><p><strong>bilateral_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the weighting of the bilateral term in the message passing step.</p></li>
<li><p><strong>gaussian_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the weighting of the gaussian term in the message passing step.</p></li>
<li><p><strong>bilateral_spatial_sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – standard deviation in spatial coordinates for the bilateral term.</p></li>
<li><p><strong>bilateral_color_sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – standard deviation in color space for the bilateral term.</p></li>
<li><p><strong>gaussian_spatial_sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – standard deviation in spatial coordinates for the gaussian term.</p></li>
<li><p><strong>update_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – determines the magnitude of each update.</p></li>
<li><p><strong>compatibility_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a matrix describing class compatibility,
should be NxN where N is the number of classes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.CRF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_tensor</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/crf.py#L71-L111"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.CRF.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – tensor containing initial class logits.</p></li>
<li><p><strong>reference_tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the reference tensor used to guide the message passing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="residualunit">
<h3><cite>ResidualUnit</cite><a class="headerlink" href="#residualunit" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ResidualUnit">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ResidualUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subunits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/convolutions.py#L174-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResidualUnit" title="Link to this definition">#</a></dt>
<dd><p>Residual module with multiple convolutions and a residual connection.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.blocks</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResidualUnit</span>

<span class="n">convs</span> <span class="o">=</span> <span class="n">ResidualUnit</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">adn_ordering</span><span class="o">=</span><span class="s2">&quot;AN&quot;</span><span class="p">,</span>
    <span class="n">act</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;prelu&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}),</span>
    <span class="n">norm</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;normalized_shape&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)}),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">convs</span><span class="p">)</span>
</pre></div>
</div>
<p>output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ResidualUnit</span><span class="p">(</span>
  <span class="p">(</span><span class="n">conv</span><span class="p">):</span> <span class="n">Sequential</span><span class="p">(</span>
    <span class="p">(</span><span class="n">unit0</span><span class="p">):</span> <span class="n">Convolution</span><span class="p">(</span>
      <span class="p">(</span><span class="n">conv</span><span class="p">):</span> <span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
      <span class="p">(</span><span class="n">adn</span><span class="p">):</span> <span class="n">ADN</span><span class="p">(</span>
        <span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="n">PReLU</span><span class="p">(</span><span class="n">num_parameters</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">LayerNorm</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="n">unit1</span><span class="p">):</span> <span class="n">Convolution</span><span class="p">(</span>
      <span class="p">(</span><span class="n">conv</span><span class="p">):</span> <span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
      <span class="p">(</span><span class="n">adn</span><span class="p">):</span> <span class="n">ADN</span><span class="p">(</span>
        <span class="p">(</span><span class="n">A</span><span class="p">):</span> <span class="n">PReLU</span><span class="p">(</span><span class="n">num_parameters</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">(</span><span class="n">N</span><span class="p">):</span> <span class="n">LayerNorm</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">elementwise_affine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span>
  <span class="p">(</span><span class="n">residual</span><span class="p">):</span> <span class="n">Identity</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride. Defaults to 1.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size. Defaults to 3.</p></li>
<li><p><strong>subunits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of convolutions. Defaults to 2.</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the ordering of activation, normalization, and dropout.
Defaults to “NDA”.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>dropout_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>determine the dimensions of dropout. Defaults to 1.</p>
<ul>
<li><p>When dropout_dim = 1, randomly zeroes some of the elements for each channel.</p></li>
<li><p>When dropout_dim = 2, Randomly zero out entire channels (a channel is a 2D feature map).</p></li>
<li><p>When dropout_dim = 3, Randomly zero out entire channels (a channel is a 3D feature map).</p></li>
</ul>
<p>The value of dropout_dim should be no larger than the value of <cite>dimensions</cite>.</p>
</p></li>
<li><p><strong>dilation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dilation rate. Defaults to 1.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term. Defaults to True.</p></li>
<li><p><strong>last_conv_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – for the last subunit, whether to use the convolutional layer only.
Defaults to False.</p></li>
<li><p><strong>padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – controls the amount of implicit zero-paddings on both sides for padding number of points
for each dimension. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#monai.networks.blocks.Convolution" title="monai.networks.blocks.Convolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.Convolution</span></code></a></p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ResidualUnit.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/convolutions.py#L315-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResidualUnit.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="swish">
<h3><cite>Swish</cite><a class="headerlink" href="#swish" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.Swish">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Swish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L41-L69"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Swish" title="Link to this definition">#</a></dt>
<dd><p>Applies the element-wise function:</p>
<div class="math notranslate nohighlight">
\[\text{Swish}(x) = x * \text{Sigmoid}(\alpha * x) ~~~~\text{for constant value}~ \alpha.\]</div>
<p>Citation: Searching for Activation Functions, Ramachandran et al., 2017, <a class="reference external" href="https://arxiv.org/abs/1710.05941">https://arxiv.org/abs/1710.05941</a>.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, *)\)</span> where <cite>*</cite> means, any number of additional dimensions</p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((N, *)\)</span>, same shape as the input</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">Act</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Act</span><span class="p">[</span><span class="s1">&#39;swish&#39;</span><span class="p">]()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.Swish.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L68-L69"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Swish.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="memoryefficientswish">
<h3><cite>MemoryEfficientSwish</cite><a class="headerlink" href="#memoryefficientswish" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.MemoryEfficientSwish">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">MemoryEfficientSwish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L93-L130"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MemoryEfficientSwish" title="Link to this definition">#</a></dt>
<dd><p>Applies the element-wise function:</p>
<div class="math notranslate nohighlight">
\[\text{Swish}(x) = x * \text{Sigmoid}(\alpha * x) ~~~~\text{for constant value}~ \alpha=1.\]</div>
<p>Memory efficient implementation for training following recommendation from:
<a class="github reference external" href="https://github.com/lukemelas/EfficientNet-PyTorch/issues/18#issuecomment-511677853">lukemelas/EfficientNet-PyTorch#18</a></p>
<p>Results in ~ 30% memory saving during training as compared to Swish()</p>
<p>Citation: Searching for Activation Functions, Ramachandran et al., 2017, <a class="reference external" href="https://arxiv.org/abs/1710.05941">https://arxiv.org/abs/1710.05941</a>.</p>
<p>From Pytorch 1.7.0+, the optimized version of <cite>Swish</cite> named <cite>SiLU</cite> is implemented,
this class will utilize <cite>torch.nn.functional.silu</cite> to do the calculation if meets the version.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, *)\)</span> where <cite>*</cite> means, any number of additional
dimensions</p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((N, *)\)</span>, same shape as the input</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">Act</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Act</span><span class="p">[</span><span class="s1">&#39;memswish&#39;</span><span class="p">]()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.MemoryEfficientSwish.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L129-L130"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MemoryEfficientSwish.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="fpn">
<h3><cite>FPN</cite><a class="headerlink" href="#fpn" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ExtraFPNBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ExtraFPNBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L68-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ExtraFPNBlock" title="Link to this definition">#</a></dt>
<dd><p>Base class for the extra block in the FPN.</p>
<p>Same code as <a class="github reference external" href="https://github.com/pytorch/vision/blob/release/0.12/torchvision/ops/feature_pyramid_network.py">pytorch/vision</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ExtraFPNBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L75-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ExtraFPNBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Compute extended set of results of the FPN and their names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – the result of the FPN</p></li>
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – the original feature maps</p></li>
<li><p><strong>names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – the names for each one of the original feature maps</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>the extended set of results of the FPN</p></li>
<li><p>the extended set of names for the results</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.FeaturePyramidNetwork">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">FeaturePyramidNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L135-L266"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FeaturePyramidNetwork" title="Link to this definition">#</a></dt>
<dd><p>Module that adds a FPN from on top of a set of feature maps. This is based on
<a class="reference external" href="https://arxiv.org/abs/1612.03144">“Feature Pyramid Network for Object Detection”</a>.</p>
<p>The feature maps are currently supposed to be in increasing depth
order.</p>
<p>The input to the model is expected to be an OrderedDict[Tensor], containing
the feature maps on top of which the FPN will be added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – 2D or 3D images</p></li>
<li><p><strong>in_channels_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of channels for each feature map that
is passed to the module</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels of the FPN representation</p></li>
<li><p><strong>extra_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="#monai.networks.blocks.ExtraFPNBlock" title="monai.networks.blocks.feature_pyramid_network.ExtraFPNBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtraFPNBlock</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if provided, extra operations will
be performed. It is expected to take the fpn features, the original
features and the names of the original features as input, and returns
a new list of feature maps and their corresponding names</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">FeaturePyramidNetwork</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get some dummy data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;feat0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;feat2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;feat3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># compute the FPN on top of x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># returns</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="p">[(</span><span class="s1">&#39;feat0&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="p">(</span><span class="s1">&#39;feat2&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">])),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="p">(</span><span class="s1">&#39;feat3&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FeaturePyramidNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L235-L266"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FeaturePyramidNetwork.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the FPN for a set of feature maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – feature maps for each feature level.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>feature maps after FPN layers. They are ordered from highest resolution first.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FeaturePyramidNetwork.get_result_from_inner_blocks">
<span class="sig-name descname"><span class="pre">get_result_from_inner_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L207-L219"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FeaturePyramidNetwork.get_result_from_inner_blocks" title="Link to this definition">#</a></dt>
<dd><p>This is equivalent to self.inner_blocks[idx](x),
but torchscript doesn’t support this yet</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FeaturePyramidNetwork.get_result_from_layer_blocks">
<span class="sig-name descname"><span class="pre">get_result_from_layer_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L221-L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FeaturePyramidNetwork.get_result_from_layer_blocks" title="Link to this definition">#</a></dt>
<dd><p>This is equivalent to self.layer_blocks[idx](x),
but torchscript doesn’t support this yet</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.LastLevelMaxPool">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">LastLevelMaxPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L91-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LastLevelMaxPool" title="Link to this definition">#</a></dt>
<dd><p>Applies a max_pool2d or max_pool3d on top of the last feature map. Serves as an <code class="docutils literal notranslate"><span class="pre">extra_blocks</span></code>
in <a class="reference internal" href="#monai.networks.blocks.FeaturePyramidNetwork" title="monai.networks.blocks.feature_pyramid_network.FeaturePyramidNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeaturePyramidNetwork</span></code></a> .</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LastLevelMaxPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L102-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LastLevelMaxPool.forward" title="Link to this definition">#</a></dt>
<dd><p>Compute extended set of results of the FPN and their names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – the result of the FPN</p></li>
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – the original feature maps</p></li>
<li><p><strong>names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – the names for each one of the original feature maps</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>the extended set of results of the FPN</p></li>
<li><p>the extended set of names for the results</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.LastLevelP6P7">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">LastLevelP6P7</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L108-L132"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LastLevelP6P7" title="Link to this definition">#</a></dt>
<dd><p>This module is used in RetinaNet to generate extra layers, P6 and P7.
Serves as an <code class="docutils literal notranslate"><span class="pre">extra_blocks</span></code>
in <a class="reference internal" href="#monai.networks.blocks.FeaturePyramidNetwork" title="monai.networks.blocks.feature_pyramid_network.FeaturePyramidNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeaturePyramidNetwork</span></code></a> .</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LastLevelP6P7.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/feature_pyramid_network.py#L125-L132"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LastLevelP6P7.forward" title="Link to this definition">#</a></dt>
<dd><p>Compute extended set of results of the FPN and their names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – the result of the FPN</p></li>
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – the original feature maps</p></li>
<li><p><strong>names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – the names for each one of the original feature maps</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>the extended set of results of the FPN</p></li>
<li><p>the extended set of names for the results</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.BackboneWithFPN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">BackboneWithFPN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/backbone_fpn_utils.py#L67-L135"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.BackboneWithFPN" title="Link to this definition">#</a></dt>
<dd><p>Adds an FPN on top of a model.
Internally, it uses torchvision.models._utils.IntermediateLayerGetter to
extract a submodel that returns the feature maps specified in return_layers.
The same limitations of IntermediateLayerGetter apply here.</p>
<p>Same code as <a class="github reference external" href="https://github.com/pytorch/vision/blob/release/0.12/torchvision/models/detection/backbone_utils.py">pytorch/vision</a>
Except that this class uses spatial_dims</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backbone</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – backbone network</p></li>
<li><p><strong>return_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – a dict containing the names
of the modules for which the activations will be returned as
the key of the dict, and the value of the dict is the name
of the returned activation (which the user can specify).</p></li>
<li><p><strong>in_channels_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of channels for each feature map
that is returned, in the order they are present in the OrderedDict</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels in the FPN.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – 2D or 3D images</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.BackboneWithFPN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/backbone_fpn_utils.py#L123-L135"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.BackboneWithFPN.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the resulted feature maps of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input images</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>feature maps after FPN layers. They are ordered from highest resolution first.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="mish">
<h3><cite>Mish</cite><a class="headerlink" href="#mish" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.Mish">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Mish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L133-L164"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Mish" title="Link to this definition">#</a></dt>
<dd><p>Applies the element-wise function:</p>
<div class="math notranslate nohighlight">
\[\text{Mish}(x) = x * tanh(\text{softplus}(x)).\]</div>
<p>Citation: Mish: A Self Regularized Non-Monotonic Activation Function, Diganta Misra, 2019, <a class="reference external" href="https://arxiv.org/abs/1908.08681">https://arxiv.org/abs/1908.08681</a>.</p>
<p>From Pytorch 1.9.0+, the optimized version of <cite>Mish</cite> is implemented,
this class will utilize <cite>torch.nn.functional.mish</cite> to do the calculation if meets the version.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, *)\)</span> where <cite>*</cite> means, any number of additional dimensions</p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((N, *)\)</span>, same shape as the input</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">Act</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Act</span><span class="p">[</span><span class="s1">&#39;mish&#39;</span><span class="p">]()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.Mish.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L163-L164"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Mish.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="geglu">
<h3><cite>GEGLU</cite><a class="headerlink" href="#geglu" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.GEGLU">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">GEGLU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L167-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.GEGLU" title="Link to this definition">#</a></dt>
<dd><p>Applies the element-wise function:</p>
<div class="math notranslate nohighlight">
\[\text{GEGLU}(x) = x_1 * \text{Sigmoid}(x_2)\]</div>
<p>where <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are split from the input tensor along the last dimension.</p>
<p>Citation: GLU Variants Improve Transformer, Noam Shazeer, 2020, <a class="reference external" href="https://arxiv.org/abs/2002.05202">https://arxiv.org/abs/2002.05202</a>.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, *, 2 * D)\)</span></p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((N, *, D)\)</span>, where <cite>*</cite> means, any number of additional dimensions</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.GEGLU.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/activation.py#L182-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.GEGLU.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="gcn-module">
<h3><cite>GCN Module</cite><a class="headerlink" href="#gcn-module" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.GCN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">GCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplanes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L26-L57"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.GCN" title="Link to this definition">#</a></dt>
<dd><p>The Global Convolutional Network module using large 1D
Kx1 and 1xK kernels to represent 2D kernels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.GCN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplanes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L32-L45"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.GCN.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplanes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>planes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>ks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel size for one dimension. Defaults to 7.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.GCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L47-L57"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.GCN.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, inplanes, spatial_1, spatial_2).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="refinement-module">
<h3><cite>Refinement Module</cite><a class="headerlink" href="#refinement-module" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.Refine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planes</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L60-L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Refine" title="Link to this definition">#</a></dt>
<dd><p>Simple residual block to refine the details of the activation maps.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.Refine.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planes</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L65-L79"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Refine.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>planes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.Refine.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L81-L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Refine.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, planes, spatial_1, spatial_2).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="fcn-module">
<h3><cite>FCN Module</cite><a class="headerlink" href="#fcn-module" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.FCN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">FCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L97-L195"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FCN" title="Link to this definition">#</a></dt>
<dd><p>2D FCN network with 3 input channels. The small decoder is built
with the GCN and Refine modules.
The code is adapted from <a class="reference external" href="https://github.com/lsqshr/AH-Net/blob/master/net2d.py">lsqshr’s official 2D code</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels. Defaults to 1.</p></li>
<li><p><strong>upsample_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>[<code class="docutils literal notranslate"><span class="pre">&quot;transpose&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>]
The mode of upsampling manipulations.
Using the second mode cannot guarantee the model’s reproducibility. Defaults to <code class="docutils literal notranslate"><span class="pre">bilinear</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">transpose</span></code>, uses transposed convolution layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bilinear</span></code>, uses bilinear interpolation.</p></li>
</ul>
</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, returns a model pre-trained on ImageNet</p></li>
<li><p><strong>progress</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, displays a progress bar of the download to stderr.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L161-L195"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FCN.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, 3, spatial_1, spatial_2).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="multi-channel-fcn-module">
<h3><cite>Multi-Channel FCN Module</cite><a class="headerlink" href="#multi-channel-fcn-module" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.MCFCN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">MCFCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L198-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MCFCN" title="Link to this definition">#</a></dt>
<dd><p>The multi-channel version of the 2D FCN module.
Adds a projection layer to take arbitrary number of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels. Defaults to 3.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels. Defaults to 1.</p></li>
<li><p><strong>upsample_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>[<code class="docutils literal notranslate"><span class="pre">&quot;transpose&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>]
The mode of upsampling manipulations.
Using the second mode cannot guarantee the model’s reproducibility. Defaults to <code class="docutils literal notranslate"><span class="pre">bilinear</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">transpose</span></code>, uses transposed convolution layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bilinear</span></code>, uses bilinear interpolate.</p></li>
</ul>
</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, returns a model pre-trained on ImageNet</p></li>
<li><p><strong>progress</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, displays a progress bar of the download to stderr.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.MCFCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fcn.py#L238-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MCFCN.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, in_channels, spatial_1, spatial_2).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="dynamic-unet-block">
<h3><cite>Dynamic-Unet Block</cite><a class="headerlink" href="#dynamic-unet-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetResBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetResBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('leakyrelu',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L25-L111"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetResBlock" title="Link to this definition">#</a></dt>
<dd><p>A skip-connection based module that can be used for DynUNet, based on:
<a class="reference external" href="https://arxiv.org/abs/1904.08128">Automated Design of Deep Learning Methods for Biomedical Image Segmentation</a>.
<a class="reference external" href="https://arxiv.org/abs/1809.10486">nnU-Net: Self-adapting Framework for U-Net-Based Medical Image Segmentation</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout probability.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetResBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L98-L111"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetResBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetBasicBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetBasicBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('leakyrelu',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L114-L177"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetBasicBlock" title="Link to this definition">#</a></dt>
<dd><p>A CNN module that can be used for DynUNet, based on:
<a class="reference external" href="https://arxiv.org/abs/1904.08128">Automated Design of Deep Learning Methods for Biomedical Image Segmentation</a>.
<a class="reference external" href="https://arxiv.org/abs/1809.10486">nnU-Net: Self-adapting Framework for U-Net-Based Medical Image Segmentation</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout probability.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetBasicBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L170-L177"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetBasicBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetUpBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetUpBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('leakyrelu',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L180-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetUpBlock" title="Link to this definition">#</a></dt>
<dd><p>An upsampling module that can be used for DynUNet, based on:
<a class="reference external" href="https://arxiv.org/abs/1904.08128">Automated Design of Deep Learning Methods for Biomedical Image Segmentation</a>.
<a class="reference external" href="https://arxiv.org/abs/1809.10486">nnU-Net: Self-adapting Framework for U-Net-Based Medical Image Segmentation</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride.</p></li>
<li><p><strong>upsample_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size for transposed convolution layers.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout probability.</p></li>
<li><p><strong>trans_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – transposed convolution bias.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetUpBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L239-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetUpBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetOutBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetOutBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L247-L267"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetOutBlock" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetOutBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dynunet_block.py#L266-L267"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetOutBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="denseblock">
<h3><cite>DenseBlock</cite><a class="headerlink" href="#denseblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.DenseBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">DenseBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/denseblock.py#L25-L44"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.DenseBlock" title="Link to this definition">#</a></dt>
<dd><p>A DenseBlock is a sequence of layers where each layer’s outputs are concatenated with their inputs. This has the
effect of accumulating outputs from previous layers as inputs to later ones and as the final output of the block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>]) – sequence of nn.Module objects to define the individual layers of the dense block</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.DenseBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/denseblock.py#L39-L44"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.DenseBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="segresnet-block">
<h3><cite>SegResnet Block</cite><a class="headerlink" href="#segresnet-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ResBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ResBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('RELU',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/segresnet_block.py#L44-L96"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResBlock" title="Link to this definition">#</a></dt>
<dd><p>ResBlock employs skip connection and two convolution blocks and is used
in SegResNet based on <a class="reference external" href="https://arxiv.org/pdf/1810.11654.pdf">3D MRI brain tumor segmentation using autoencoder regularization</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ResBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('RELU',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/segresnet_block.py#L51-L81"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, could be 1, 2 or 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – convolution kernel size, the value should be an odd number. Defaults to 3.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">RELU</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ResBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/segresnet_block.py#L83-L96"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="sablock-block">
<h3><cite>SABlock Block</cite><a class="headerlink" href="#sablock-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SABlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SABlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_pos_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_combined_linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flash_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/selfattention.py#L26-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SABlock" title="Link to this definition">#</a></dt>
<dd><p>A self-attention block, based on: “Dosovitskiy et al.,
An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale &lt;<a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SABlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_pos_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_combined_linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flash_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/selfattention.py#L32-L154"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SABlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – dimension of hidden layer.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – number of attention heads.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – fraction of the input units to drop. Defaults to 0.0.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – bias term for the qkv linear layer. Defaults to False.</p></li>
<li><p><strong>save_attn</strong> (<em>bool</em><em>, </em><em>optional</em>) – to make accessible the attention matrix. Defaults to False.</p></li>
<li><p><strong>dim_head</strong> (<em>int</em><em>, </em><em>optional</em>) – dimension of each head. Defaults to hidden_size // num_heads.</p></li>
<li><p><strong>hidden_input_size</strong> (<em>int</em><em>, </em><em>optional</em>) – dimension of the input tensor. Defaults to hidden_size.</p></li>
<li><p><strong>causal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use causal attention (see <a class="reference external" href="https://arxiv.org/abs/1706.03762">https://arxiv.org/abs/1706.03762</a>).</p></li>
<li><p><strong>sequence_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if causal is True, it is necessary to specify the sequence length.</p></li>
<li><p><strong>rel_pos_embedding</strong> (<em>str</em><em>, </em><em>optional</em>) – Add relative positional embeddings to the attention map.
For now only “decomposed” is supported (see <a class="reference external" href="https://arxiv.org/abs/2112.01526">https://arxiv.org/abs/2112.01526</a>). 2D and 3D are supported.</p></li>
<li><p><strong>input_size</strong> (<em>tuple</em><em>(</em><em>spatial_dim</em><em>)</em><em>, </em><em>optional</em>) – Input resolution for calculating the relative
positional parameter size.</p></li>
<li><p><strong>attention_dtype</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – cast attention operations to this dtype.</p></li>
<li><p><strong>include_fc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to include the final linear layer. Default to True.</p></li>
<li><p><strong>use_combined_linear</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use a single linear layer for qkv projection, default to True.</p></li>
<li><p><strong>use_flash_attention</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, use Pytorch’s inbuilt flash attention for a memory efficient attention mechanism
(see <a class="reference external" href="https://pytorch.org/docs/2.2/generated/torch.nn.functional.scaled_dot_product_attention.html">https://pytorch.org/docs/2.2/generated/torch.nn.functional.scaled_dot_product_attention.html</a>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SABlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/selfattention.py#L156-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SABlock.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>B</em>) – input tensor. B x (s_dim_1 * … * s_dim_n) x C</p></li>
<li><p><strong>attn_mask</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – mask to apply to the attention matrix.</p></li>
<li><p><strong>x</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>B x (s_dim_1 * … * s_dim_n) x C</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="cablock-block">
<h3><cite>CABlock Block</cite><a class="headerlink" href="#cablock-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.CABlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">CABlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flash_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/cablock.py#L78-L182"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.CABlock" title="Link to this definition">#</a></dt>
<dd><p>Multi-DConv Head Transposed Self-Attention (MDTA): Differs from standard self-attention
by operating on feature channels instead of spatial dimensions. Incorporates depth-wise
convolutions for local mixing before attention, achieving linear complexity vs quadratic
in vanilla attention. Based on SW Zamir, et al., 2022 &lt;<a class="reference external" href="https://arxiv.org/abs/2111.09881">https://arxiv.org/abs/2111.09881</a>&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> – Number of spatial dimensions (2D or 3D)</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of input channels</p></li>
<li><p><strong>num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of attention heads</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use bias in convolution layers</p></li>
<li><p><strong>flash_attention</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use flash attention optimization. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If flash attention is not available in current PyTorch version</p></li>
<li><p><strong>ValueError</strong> – If spatial_dims is greater than 3</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.CABlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/cablock.py#L146-L182"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.CABlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass for MDTA attention.
1. Apply depth-wise convolutions to Q, K, V
2. Reshape Q, K, V for multi-head attention
3. Compute attention matrix using flash or normal attention
4. Reshape and project out attention output</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="feedforward-block">
<h3><cite>FeedForward Block</cite><a class="headerlink" href="#feedforward-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.FeedForward">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">FeedForward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffn_expansion_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/cablock.py#L27-L75"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FeedForward" title="Link to this definition">#</a></dt>
<dd><p>Gated-DConv Feed-Forward Network (GDFN) that controls feature flow using gating mechanism.
Uses depth-wise convolutions for local context mixing and GELU-activated gating for refined feature selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of spatial dimensions (2D or 3D)</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of input channels</p></li>
<li><p><strong>ffn_expansion_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Factor to expand hidden features dimension</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use bias in convolution layers</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FeedForward.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/cablock.py#L72-L75"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FeedForward.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="squeeze-and-excitation">
<h3><cite>Squeeze-and-Excitation</cite><a class="headerlink" href="#squeeze-and-excitation" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ChannelSELayer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ChannelSELayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L23-L89"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ChannelSELayer" title="Link to this definition">#</a></dt>
<dd><p>Re-implementation of the Squeeze-and-Excitation block based on:
“Hu et al., Squeeze-and-Excitation Networks, <a class="reference external" href="https://arxiv.org/abs/1709.01507">https://arxiv.org/abs/1709.01507</a>”.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ChannelSELayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L29-L72"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ChannelSELayer.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, could be 1, 2, or 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the reduction ratio r in the paper. Defaults to 2.</p></li>
<li><p><strong>acti_type_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type of the hidden squeeze layer. Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;relu&quot;,</span> <span class="pre">{&quot;inplace&quot;:</span> <span class="pre">True})</span></code>.</p></li>
<li><p><strong>acti_type_2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type of the output squeeze layer. Defaults to “sigmoid”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">r</span></code> is nonpositive or larger than <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#module-monai.networks.layers.Act" title="monai.networks.layers.Act"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Act</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ChannelSELayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L74-L89"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ChannelSELayer.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, in_channels, spatial_1[, spatial_2, …]).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="transformer-block">
<h3><cite>Transformer Block</cite><a class="headerlink" href="#transformer-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.TransformerBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">TransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cross_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flash_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_combined_linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/transformerblock.py#L22-L100"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.TransformerBlock" title="Link to this definition">#</a></dt>
<dd><p>A transformer block, based on: “Dosovitskiy et al.,
An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale &lt;<a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.TransformerBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cross_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flash_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_combined_linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/transformerblock.py#L28-L91"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.TransformerBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – dimension of hidden layer.</p></li>
<li><p><strong>mlp_dim</strong> (<em>int</em>) – dimension of feedforward layer.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – number of attention heads.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – fraction of the input units to drop. Defaults to 0.0.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – apply bias term for the qkv linear layer. Defaults to False.</p></li>
<li><p><strong>save_attn</strong> (<em>bool</em><em>, </em><em>optional</em>) – to make accessible the attention matrix. Defaults to False.</p></li>
<li><p><strong>use_flash_attention</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, use Pytorch’s inbuilt flash attention for a memory efficient attention mechanism
(see <a class="reference external" href="https://pytorch.org/docs/2.2/generated/torch.nn.functional.scaled_dot_product_attention.html">https://pytorch.org/docs/2.2/generated/torch.nn.functional.scaled_dot_product_attention.html</a>).</p></li>
<li><p><strong>include_fc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to include the final linear layer. Default to True.</p></li>
<li><p><strong>use_combined_linear</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use a single linear layer for qkv projection, default to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.TransformerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/transformerblock.py#L93-L100"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.TransformerBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="unetr-block">
<h3><cite>UNETR Block</cite><a class="headerlink" href="#unetr-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrBasicBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetrBasicBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L209-L259"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrBasicBlock" title="Link to this definition">#</a></dt>
<dd><p>A CNN module that can be used for UNETR, based on: “Hatamizadeh et al.,
UNETR: Transformers for 3D Medical Image Segmentation &lt;<a class="reference external" href="https://arxiv.org/abs/2103.10504">https://arxiv.org/abs/2103.10504</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrBasicBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L215-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrBasicBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>res_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – bool argument to determine if residual block is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrBasicBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L258-L259"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrBasicBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrUpBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetrUpBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L22-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrUpBlock" title="Link to this definition">#</a></dt>
<dd><p>An upsampling module that can be used for UNETR: “Hatamizadeh et al.,
UNETR: Transformers for 3D Medical Image Segmentation &lt;<a class="reference external" href="https://arxiv.org/abs/2103.10504">https://arxiv.org/abs/2103.10504</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrUpBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L28-L79"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrUpBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>upsample_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size for transposed convolution layers.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>res_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – bool argument to determine if residual block is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrUpBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L81-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrUpBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrPrUpBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UnetrPrUpBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L89-L206"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrPrUpBlock" title="Link to this definition">#</a></dt>
<dd><p>A projection upsampling module that can be used for UNETR: “Hatamizadeh et al.,
UNETR: Transformers for 3D Medical Image Segmentation &lt;<a class="reference external" href="https://arxiv.org/abs/2103.10504">https://arxiv.org/abs/2103.10504</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrPrUpBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L95-L200"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrPrUpBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>num_layer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of upsampling blocks.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution stride.</p></li>
<li><p><strong>upsample_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size for transposed convolution layers.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>conv_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – bool argument to determine if convolutional block is used.</p></li>
<li><p><strong>res_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – bool argument to determine if residual block is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UnetrPrUpBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/unetr_block.py#L202-L206"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UnetrPrUpBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="residual-squeeze-and-excitation">
<h3><cite>Residual Squeeze-and-Excitation</cite><a class="headerlink" href="#residual-squeeze-and-excitation" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ResidualSELayer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ResidualSELayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leakyrelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L92-L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResidualSELayer" title="Link to this definition">#</a></dt>
<dd><p>A “squeeze-and-excitation”-like layer with a residual connection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--+--</span> <span class="n">SE</span> <span class="o">--</span><span class="n">o</span><span class="o">--</span>
  <span class="o">|</span>        <span class="o">|</span>
  <span class="o">+--------+</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ResidualSELayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leakyrelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L101-L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ResidualSELayer.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, could be 1, 2, or 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the reduction ratio r in the paper. Defaults to 2.</p></li>
<li><p><strong>acti_type_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – defaults to “leakyrelu”.</p></li>
<li><p><strong>acti_type_2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – defaults to “relu”.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#monai.networks.blocks.ChannelSELayer" title="monai.networks.blocks.ChannelSELayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ChannelSELayer</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="squeeze-and-excitation-block">
<h3><cite>Squeeze-and-Excitation Block</cite><a class="headerlink" href="#squeeze-and-excitation-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SEBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SEBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chns_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chns_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chns_3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_param_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_param_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_param_3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L130-L230"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SEBlock" title="Link to this definition">#</a></dt>
<dd><p>Residual module enhanced with Squeeze-and-Excitation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">----+-</span> <span class="n">conv1</span> <span class="o">--</span>  <span class="n">conv2</span> <span class="o">--</span> <span class="n">conv3</span> <span class="o">--</span> <span class="n">SE</span> <span class="o">-</span><span class="n">o</span><span class="o">---</span>
    <span class="o">|</span>                                  <span class="o">|</span>
    <span class="o">+---</span><span class="p">(</span><span class="n">channel</span> <span class="n">project</span> <span class="k">if</span> <span class="n">needed</span><span class="p">)</span><span class="o">----+</span>
</pre></div>
</div>
<p>Re-implementation of the SE-Resnet block based on:
“Hu et al., Squeeze-and-Excitation Networks, <a class="reference external" href="https://arxiv.org/abs/1709.01507">https://arxiv.org/abs/1709.01507</a>”.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SEBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chns_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chns_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chns_3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_param_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_param_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_param_3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L142-L216"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SEBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, could be 1, 2, or 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>n_chns_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels in the 1st convolution.</p></li>
<li><p><strong>n_chns_2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels in the 2nd convolution.</p></li>
<li><p><strong>n_chns_3</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels in the 3rd convolution.</p></li>
<li><p><strong>conv_param_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – additional parameters to the 1st convolution.
Defaults to <code class="docutils literal notranslate"><span class="pre">{&quot;kernel_size&quot;:</span> <span class="pre">1,</span> <span class="pre">&quot;norm&quot;:</span> <span class="pre">Norm.BATCH,</span> <span class="pre">&quot;act&quot;:</span> <span class="pre">(&quot;relu&quot;,</span> <span class="pre">{&quot;inplace&quot;:</span> <span class="pre">True})}</span></code></p></li>
<li><p><strong>conv_param_2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – additional parameters to the 2nd convolution.
Defaults to <code class="docutils literal notranslate"><span class="pre">{&quot;kernel_size&quot;:</span> <span class="pre">3,</span> <span class="pre">&quot;norm&quot;:</span> <span class="pre">Norm.BATCH,</span> <span class="pre">&quot;act&quot;:</span> <span class="pre">(&quot;relu&quot;,</span> <span class="pre">{&quot;inplace&quot;:</span> <span class="pre">True})}</span></code></p></li>
<li><p><strong>conv_param_3</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – additional parameters to the 3rd convolution.
Defaults to <code class="docutils literal notranslate"><span class="pre">{&quot;kernel_size&quot;:</span> <span class="pre">1,</span> <span class="pre">&quot;norm&quot;:</span> <span class="pre">Norm.BATCH,</span> <span class="pre">&quot;act&quot;:</span> <span class="pre">None}</span></code></p></li>
<li><p><strong>project</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="#monai.networks.blocks.Convolution" title="monai.networks.blocks.convolutions.Convolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Convolution</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – in the case of residual chns and output chns doesn’t match, a project
(Conv) layer/block is used to adjust the number of chns. In SENET, it is
consisted with a Conv layer as well as a Norm layer.
Defaults to None (chns are matchable) or a Conv layer with kernel size 1.</p></li>
<li><p><strong>r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the reduction ratio r in the paper. Defaults to 2.</p></li>
<li><p><strong>acti_type_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type of the hidden squeeze layer. Defaults to “relu”.</p></li>
<li><p><strong>acti_type_2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type of the output squeeze layer. Defaults to “sigmoid”.</p></li>
<li><p><strong>acti_type_final</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type of the end of the block. Defaults to “relu”.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#monai.networks.blocks.ChannelSELayer" title="monai.networks.blocks.ChannelSELayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ChannelSELayer</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SEBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L218-L230"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SEBlock.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, in_channels, spatial_1[, spatial_2, …]).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="squeeze-and-excitation-bottleneck">
<h3><cite>Squeeze-and-Excitation Bottleneck</cite><a class="headerlink" href="#squeeze-and-excitation-bottleneck" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SEBottleneck">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SEBottleneck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L233-L278"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SEBottleneck" title="Link to this definition">#</a></dt>
<dd><p>Bottleneck for SENet154.</p>
</dd></dl>

</section>
<section id="squeeze-and-excitation-resnet-bottleneck">
<h3><cite>Squeeze-and-Excitation Resnet Bottleneck</cite><a class="headerlink" href="#squeeze-and-excitation-resnet-bottleneck" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SEResNetBottleneck">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SEResNetBottleneck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L281-L328"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SEResNetBottleneck" title="Link to this definition">#</a></dt>
<dd><p>ResNet bottleneck with a Squeeze-and-Excitation module. It follows Caffe
implementation and uses <cite>strides=stride</cite> in <cite>conv1</cite> and not in <cite>conv2</cite>
(the latter is used in the torchvision implementation of ResNet).</p>
</dd></dl>

</section>
<section id="squeeze-and-excitation-resnext-bottleneck">
<h3><cite>Squeeze-and-Excitation ResNeXt Bottleneck</cite><a class="headerlink" href="#squeeze-and-excitation-resnext-bottleneck" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SEResNeXtBottleneck">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SEResNeXtBottleneck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/squeeze_and_excitation.py#L331-L378"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SEResNeXtBottleneck" title="Link to this definition">#</a></dt>
<dd><p>ResNeXt bottleneck type C with a Squeeze-and-Excitation module.</p>
</dd></dl>

</section>
<section id="simple-aspp">
<h3><cite>Simple ASPP</cite><a class="headerlink" href="#simple-aspp" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SimpleASPP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SimpleASPP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BATCH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LEAKYRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/aspp.py#L24-L107"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SimpleASPP" title="Link to this definition">#</a></dt>
<dd><p>A simplified version of the atrous spatial pyramid pooling (ASPP) module.</p>
<p>Chen et al., Encoder-Decoder with Atrous Separable Convolution for Semantic Image Segmentation.
<a class="reference external" href="https://arxiv.org/abs/1802.02611">https://arxiv.org/abs/1802.02611</a></p>
<p>Wang et al., A Noise-robust Framework for Automatic Segmentation of COVID-19 Pneumonia Lesions
from CT Images. <a class="reference external" href="https://ieeexplore.ieee.org/document/9109297">https://ieeexplore.ieee.org/document/9109297</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SimpleASPP.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BATCH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LEAKYRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/aspp.py#L35-L98"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SimpleASPP.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, could be 1, 2, or 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>conv_out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels of each atrous conv.
The final number of output channels is conv_out_channels * len(kernel_sizes).</p></li>
<li><p><strong>kernel_sizes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – a sequence of four convolutional kernel sizes.
Defaults to (1, 3, 3, 3) for four (dilated) convolutions.</p></li>
<li><p><strong>dilations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – a sequence of four convolutional dilation parameters.
Defaults to (1, 2, 4, 6) for four (dilated) convolutions.</p></li>
<li><p><strong>norm_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – final kernel-size-one convolution normalization type.
Defaults to batch norm.</p></li>
<li><p><strong>acti_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – final kernel-size-one convolution activation type.
Defaults to leaky ReLU.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in convolution blocks. Defaults to False.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">kernel_sizes</span></code> length differs from <code class="docutils literal notranslate"><span class="pre">dilations</span></code>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#module-monai.networks.layers.Act" title="monai.networks.layers.Act"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Act</span></code></a>
<a class="reference internal" href="#module-monai.networks.layers.Conv" title="monai.networks.layers.Conv"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Conv</span></code></a>
<a class="reference internal" href="#module-monai.networks.layers.Norm" title="monai.networks.layers.Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.Norm</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SimpleASPP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/aspp.py#L100-L107"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SimpleASPP.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape (batch, channel, spatial_1[, spatial_2, …]).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="maxavgpooling">
<h3><cite>MaxAvgPooling</cite><a class="headerlink" href="#maxavgpooling" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.MaxAvgPool">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">MaxAvgPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L26-L66"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MaxAvgPool" title="Link to this definition">#</a></dt>
<dd><p>Downsample with both maxpooling and avgpooling,
double the channel size by concatenating the downsampled feature maps.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.MaxAvgPool.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L32-L56"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MaxAvgPool.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the kernel size of both pooling operations.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the stride of the window. Default value is <cite>kernel_size</cite>.</p></li>
<li><p><strong>padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – implicit zero padding to be added to both pooling operations.</p></li>
<li><p><strong>ceil_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – when True, will use ceil instead of floor to compute the output shape.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.MaxAvgPool.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L58-L66"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MaxAvgPool.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in shape (batch, channel, spatial_1[, spatial_2, …]).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor in shape (batch, 2*channel, spatial_1[, spatial_2, …]).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="upsampling">
<h3><cite>Upsampling</cite><a class="headerlink" href="#upsampling" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.UpSample">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">UpSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">deconv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">linear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_pad_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L26-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UpSample" title="Link to this definition">#</a></dt>
<dd><p>Upsamples data by <cite>scale_factor</cite>.
Supported modes are:</p>
<blockquote>
<div><ul class="simple">
<li><p>“deconv”: uses a transposed convolution.</p></li>
<li><p>“deconvgroup”: uses a transposed group convolution.</p></li>
<li><p>“nontrainable”: uses <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Upsample</span></code>.</p></li>
<li><p>“pixelshuffle”: uses <a class="reference internal" href="#monai.networks.blocks.SubpixelUpsample" title="monai.networks.blocks.SubpixelUpsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.SubpixelUpsample</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>This operation will cause non-deterministic when <code class="docutils literal notranslate"><span class="pre">mode</span></code> is <code class="docutils literal notranslate"><span class="pre">UpsampleMode.NONTRAINABLE</span></code>.
Please check the link below for more details:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms">https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms</a>
This module can optionally take a pre-convolution
(often used to map the number of features from <cite>in_channels</cite> to <cite>out_channels</cite>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.UpSample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">deconv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">linear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_pad_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L43-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.UpSample.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of channels of the input image.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of channels of the output image. Defaults to <cite>in_channels</cite>.</p></li>
<li><p><strong>scale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – multiplier for spatial size. Has to match input size if it is a tuple. Defaults to 2.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel size used during transposed convolutions. Defaults to <cite>scale_factor</cite>.</p></li>
<li><p><strong>size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – spatial size of the output image.
Only used when <code class="docutils literal notranslate"><span class="pre">mode</span></code> is <code class="docutils literal notranslate"><span class="pre">UpsampleMode.NONTRAINABLE</span></code>.
In torch.nn.functional.interpolate, only one of <cite>size</cite> or <cite>scale_factor</cite> should be defined,
thus if size is defined, <cite>scale_factor</cite> will not be used.
Defaults to None.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.UpsampleMode" title="monai.utils.enums.UpsampleMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpsampleMode</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – {<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;deconvgroup&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>}. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>.</p></li>
<li><p><strong>pre_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a conv block applied before upsampling. Defaults to “default”.
When <code class="docutils literal notranslate"><span class="pre">conv_block</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>, one reserved conv layer will be utilized when
Only used in the “nontrainable” or “pixelshuffle” mode.</p></li>
<li><p><strong>post_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a conv block applied after upsampling. Defaults to None. Only used in the “nontrainable”  mode.</p></li>
<li><p><strong>interp_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bicubic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;trilinear&quot;</span></code>}
Only used in the “nontrainable” mode.
If ends with <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> will use <code class="docutils literal notranslate"><span class="pre">spatial</span> <span class="pre">dims</span></code> to determine the correct interpolation.
This corresponds to linear, bilinear, trilinear for 1D, 2D, and 3D respectively.
The interpolation mode. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>.
See also: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Upsample.html">https://pytorch.org/docs/stable/generated/torch.nn.Upsample.html</a></p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – set the align_corners parameter of <cite>torch.nn.Upsample</cite>. Defaults to True.
Only used in the “nontrainable” mode.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in the default preconv and deconv layers. Defaults to True.</p></li>
<li><p><strong>apply_pad_pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True the upsampled tensor is padded then average pooling is applied with a kernel the
size of <cite>scale_factor</cite> with a stride of 1. See also: <a class="reference internal" href="#monai.networks.blocks.SubpixelUpsample" title="monai.networks.blocks.SubpixelUpsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.SubpixelUpsample</span></code></a>.
Only used in the “pixelshuffle” mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.blocks.Upsample">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Upsample</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L26-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Upsample" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.blocks.UpSample" title="monai.networks.blocks.upsample.UpSample"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpSample</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelUpsample">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SubpixelUpsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_pad_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L187-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelUpsample" title="Link to this definition">#</a></dt>
<dd><p>Upsample via using a subpixel CNN. This module supports 1D, 2D and 3D input images.
The module is consisted with two parts. First of all, a convolutional layer is employed
to increase the number of channels into: <code class="docutils literal notranslate"><span class="pre">in_channels</span> <span class="pre">*</span> <span class="pre">(scale_factor</span> <span class="pre">**</span> <span class="pre">dimensions)</span></code>.
Secondly, a pixel shuffle manipulation is utilized to aggregates the feature maps from
low resolution space and build the super resolution space.
The first part of the module is not fixed, a sequential layers can be used to replace the
default single layer.</p>
<p>See: Shi et al., 2016, “Real-Time Single Image and Video Super-Resolution
Using a nEfficient Sub-Pixel Convolutional Neural Network.”</p>
<p>See: Aitken et al., 2017, “Checkerboard artifact free sub-pixel convolution”.</p>
<p>The idea comes from:
<a class="reference external" href="https://arxiv.org/abs/1609.05158">https://arxiv.org/abs/1609.05158</a></p>
<p>The pixel shuffle mechanism refers to:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.PixelShuffle.html#torch.nn.PixelShuffle">https://pytorch.org/docs/stable/generated/torch.nn.PixelShuffle.html#torch.nn.PixelShuffle</a>.
and:
<a class="github reference external" href="https://github.com/pytorch/pytorch/pull/6340">pytorch/pytorch#6340</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelUpsample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_pad_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L212-L272"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelUpsample.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of channels of the input image.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional number of channels of the output image.</p></li>
<li><p><strong>scale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – multiplier for spatial size. Defaults to 2.</p></li>
<li><p><strong>conv_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>a conv block to extract feature maps before upsampling. Defaults to None.</p>
<ul>
<li><p>When <code class="docutils literal notranslate"><span class="pre">conv_block</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>, one reserved conv layer will be utilized.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">conv_block</span></code> is an <code class="docutils literal notranslate"><span class="pre">nn.module</span></code>,
please ensure the output number of channels is divisible <code class="docutils literal notranslate"><span class="pre">(scale_factor</span> <span class="pre">**</span> <span class="pre">dimensions)</span></code>.</p></li>
</ul>
</p></li>
<li><p><strong>apply_pad_pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True the upsampled tensor is padded then average pooling is applied with a kernel the
size of <cite>scale_factor</cite> with a stride of 1. This implements the nearest neighbour resize convolution
component of subpixel convolutions described in Aitken et al.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in the default conv_block. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelUpsample.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L274-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelUpsample.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in shape (batch, channel, spatial_1[, spatial_2, …).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.blocks.Subpixelupsample">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Subpixelupsample</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L187-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Subpixelupsample" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.blocks.SubpixelUpsample" title="monai.networks.blocks.upsample.SubpixelUpsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubpixelUpsample</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelUpSample">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SubpixelUpSample</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py#L187-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelUpSample" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.blocks.SubpixelUpsample" title="monai.networks.blocks.upsample.SubpixelUpsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubpixelUpsample</span></code></a></p>
</dd></dl>

</section>
<section id="downsampling">
<h3><cite>Downsampling</cite><a class="headerlink" href="#downsampling" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.DownSample">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">DownSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">conv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L69-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.DownSample" title="Link to this definition">#</a></dt>
<dd><p>Downsamples data by <cite>scale_factor</cite>.</p>
<p>Supported modes are:</p>
<ul class="simple">
<li><p>“conv”: uses a strided convolution for learnable downsampling.</p></li>
<li><p>“convgroup”: uses a grouped strided convolution for efficient feature reduction.</p></li>
<li><p>“nontrainable”: uses <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Upsample</span></code> with inverse scale factor.</p></li>
<li><p>“pixelunshuffle”: uses <code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.PixelUnshuffle</span></code> for channel-space rearrangement.</p></li>
</ul>
<p>This operation will cause non-deterministic behavior when <code class="docutils literal notranslate"><span class="pre">mode</span></code> is <code class="docutils literal notranslate"><span class="pre">DownsampleMode.NONTRAINABLE</span></code>.
Please check the link below for more details:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms">https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms</a></p>
<p>This module can optionally take a pre-convolution
(often used to map the number of features from <cite>in_channels</cite> to <cite>out_channels</cite>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.DownSample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">conv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L88-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.DownSample.__init__" title="Link to this definition">#</a></dt>
<dd><p>Downsamples data by <cite>scale_factor</cite>.
Supported modes are:</p>
<blockquote>
<div><ul class="simple">
<li><p>DownsampleMode.CONV: uses a strided convolution for learnable downsampling.</p></li>
<li><p>DownsampleMode.CONVGROUP: uses a grouped strided convolution for efficient feature reduction.</p></li>
<li><p>DownsampleMode.MAXPOOL: uses maxpooling for non-learnable downsampling.</p></li>
<li><p>DownsampleMode.AVGPOOL: uses average pooling for non-learnable downsampling.</p></li>
<li><p>DownsampleMode.PIXELUNSHUFFLE: uses <a class="reference internal" href="#monai.networks.blocks.SubpixelDownsample" title="monai.networks.blocks.SubpixelDownsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.SubpixelDownsample</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>This operation will cause non-deterministic behavior when <code class="docutils literal notranslate"><span class="pre">mode</span></code> is <code class="docutils literal notranslate"><span class="pre">DownsampleMode.NONTRAINABLE</span></code>.
Please check the link below for more details:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms">https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms</a></p>
<p>This module can optionally take a pre-convolution and post-convolution
(often used to map the number of features from <cite>in_channels</cite> to <cite>out_channels</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of channels of the input image.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of channels of the output image. Defaults to <cite>in_channels</cite>.</p></li>
<li><p><strong>scale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – multiplier for spatial size reduction. Has to match input size if it is a tuple. Defaults to 2.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel size used during convolutions. Defaults to <cite>scale_factor</cite>.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.DownsampleMode" title="monai.utils.enums.DownsampleMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">DownsampleMode</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – {<code class="docutils literal notranslate"><span class="pre">DownsampleMode.CONV</span></code>, <code class="docutils literal notranslate"><span class="pre">DownsampleMode.CONVGROUP</span></code>, <code class="docutils literal notranslate"><span class="pre">DownsampleMode.MAXPOOL</span></code>, <code class="docutils literal notranslate"><span class="pre">DownsampleMode.AVGPOOL</span></code>,
<code class="docutils literal notranslate"><span class="pre">DownsampleMode.PIXELUNSHUFFLE</span></code>}. Defaults to <code class="docutils literal notranslate"><span class="pre">DownsampleMode.CONV</span></code>.</p></li>
<li><p><strong>pre_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a conv block applied before downsampling. Defaults to “default”.
When <code class="docutils literal notranslate"><span class="pre">conv_block</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>, one reserved conv layer will be utilized.
Only used in the “maxpool”, “avgpool” or “pixelunshuffle” modes.</p></li>
<li><p><strong>post_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a conv block applied after downsampling. Defaults to None. Only used in the “maxpool” and “avgpool” modes.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in the default preconv and conv layers. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.blocks.Downsample">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Downsample</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L69-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Downsample" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.blocks.DownSample" title="monai.networks.blocks.downsample.DownSample"><code class="xref py py-class docutils literal notranslate"><span class="pre">DownSample</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelDownsample">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SubpixelDownsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L221-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelDownsample" title="Link to this definition">#</a></dt>
<dd><p>Downsample via using a subpixel CNN. This module supports 1D, 2D and 3D input images.
The module consists of two parts. First, a convolutional layer is employed
to adjust the number of channels. Secondly, a pixel unshuffle manipulation
rearranges the spatial information into channel space, effectively reducing
spatial dimensions while increasing channel depth.</p>
<p>The pixel unshuffle operation is the inverse of pixel shuffle, rearranging dimensions
from (B, C, H*r, W*r) to (B, C*r², H, W) for 2D images or from (B, C, H*r, W*r, D*r) to (B, C*r³, H, W, D) in 3D case.</p>
<p>Example: (1, 1, 4, 4) with r=2 becomes (1, 4, 2, 2).</p>
<p>See: Shi et al., 2016, “Real-Time Single Image and Video Super-Resolution
Using a nEfficient Sub-Pixel Convolutional Neural Network.”</p>
<p>The pixel unshuffle mechanism is the inverse operation of:
<a class="github reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/upsample.py">Project-MONAI/MONAI</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelDownsample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L241-L283"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelDownsample.__init__" title="Link to this definition">#</a></dt>
<dd><p>Downsamples data by rearranging spatial information into channel space.
This reduces spatial dimensions while increasing channel depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of channels of the input image.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional number of channels of the output image.</p></li>
<li><p><strong>scale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – factor to reduce the spatial dimensions by. Defaults to 2.</p></li>
<li><p><strong>conv_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a conv block to adjust channels before downsampling. Defaults to None.
When <code class="docutils literal notranslate"><span class="pre">conv_block</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>, one reserved conv layer will be utilized.
When <code class="docutils literal notranslate"><span class="pre">conv_block</span></code> is an <code class="docutils literal notranslate"><span class="pre">nn.module</span></code>,
please ensure the input number of channels matches requirements.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in the default conv_block. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelDownsample.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L285-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelDownsample.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in shape (batch, channel, spatial_1[, spatial_2, …).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor with reduced spatial dimensions and increased channel depth.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.blocks.Subpixeldownsample">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Subpixeldownsample</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L221-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Subpixeldownsample" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.blocks.SubpixelDownsample" title="monai.networks.blocks.downsample.SubpixelDownsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubpixelDownsample</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.blocks.SubpixelDownSample">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">SubpixelDownSample</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/downsample.py#L221-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.SubpixelDownSample" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.blocks.SubpixelDownsample" title="monai.networks.blocks.downsample.SubpixelDownsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubpixelDownsample</span></code></a></p>
</dd></dl>

</section>
<section id="registration-residual-conv-block">
<h3><cite>Registration Residual Conv Block</cite><a class="headerlink" href="#registration-residual-conv-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationResidualConvBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">RegistrationResidualConvBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L73-L125"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationResidualConvBlock" title="Link to this definition">#</a></dt>
<dd><p>A block with skip links and layer - norm - activation.
Only changes the number of channels, the spatial size is kept same.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationResidualConvBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L79-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationResidualConvBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels</p></li>
<li><p><strong>num_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of layers inside the block</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel_size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationResidualConvBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L107-L125"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationResidualConvBlock.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>, insize_1, insize_2, [insize_3])</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>, insize_1, insize_2, [insize_3]),
with the same spatial size as <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="registration-down-sample-block">
<h3><cite>Registration Down Sample Block</cite><a class="headerlink" href="#registration-down-sample-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationDownSampleBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">RegistrationDownSampleBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L128-L172"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationDownSampleBlock" title="Link to this definition">#</a></dt>
<dd><p>A down-sample module used in RegUNet to half the spatial size.
The number of channels is kept same.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationDownSampleBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L137-L155"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationDownSampleBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – channels</p></li>
<li><p><strong>pooling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use MaxPool if True, strided conv if False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationDownSampleBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L157-L172"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationDownSampleBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Halves the spatial dimensions and keeps the same channel.
output in shape (batch, <code class="docutils literal notranslate"><span class="pre">channels</span></code>, insize_1 / 2, insize_2 / 2, [insize_3 / 2]),</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">channels</span></code>, insize_1, insize_2, [insize_3])</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when input spatial dimensions are not even.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="registration-extraction-block">
<h3><cite>Registration Extraction Block</cite><a class="headerlink" href="#registration-extraction-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationExtractionBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">RegistrationExtractionBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L191-L257"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationExtractionBlock" title="Link to this definition">#</a></dt>
<dd><p>The Extraction Block used in RegUNet.
Extracts feature from each <code class="docutils literal notranslate"><span class="pre">extract_levels</span></code> and takes the average.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationExtractionBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L197-L238"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationExtractionBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions</p></li>
<li><p><strong>extract_levels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – spatial levels to extract feature from, 0 refers to the input scale</p></li>
<li><p><strong>num_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – number of channels at each scale level,
List or Tuple of length equals to <cite>depth</cite> of the RegNet</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels</p></li>
<li><p><strong>kernel_initializer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel initializer</p></li>
<li><p><strong>activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel activation function</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – feature map interpolation mode, default to “nearest”.</p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – whether to align corners for feature map interpolation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.RegistrationExtractionBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/regunet_block.py#L240-L257"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.RegistrationExtractionBlock.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – Decoded feature at different spatial levels, sorted from deep to shallow</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – output image size</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor of shape (batch, <cite>out_channels</cite>, size1, size2, size3), where (size1, size2, size3) = <code class="docutils literal notranslate"><span class="pre">image_size</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="localnet-downsample-block">
<h3><cite>LocalNet DownSample Block</cite><a class="headerlink" href="#localnet-downsample-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetDownSampleBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">LocalNetDownSampleBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L115-L168"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetDownSampleBlock" title="Link to this definition">#</a></dt>
<dd><p>A down-sample module that can be used for LocalNet, based on:
<a class="reference external" href="https://doi.org/10.1016/j.media.2018.07.002">Weakly-supervised convolutional neural networks for multimodal image registration</a>.
<a class="reference external" href="https://arxiv.org/abs/1711.01666">Label-driven weakly-supervised learning for multimodal deformable image registration</a>.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetDownSampleBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L127-L146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetDownSampleBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – when <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code> is even</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetDownSampleBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L148-L168"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetDownSampleBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Halves the spatial dimensions.
A tuple of (x, mid) is returned:</p>
<blockquote>
<div><ul class="simple">
<li><p>x is the downsample result, in shape (batch, <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>, insize_1 / 2, insize_2 / 2, [insize_3 / 2]),</p></li>
<li><p>mid is the mid-level feature, in shape (batch, <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>, insize_1, insize_2, [insize_3])</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>, insize_1, insize_2, [insize_3])</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when input spatial dimensions are not even.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="localnet-upsample-block">
<h3><cite>LocalNet UpSample Block</cite><a class="headerlink" href="#localnet-upsample-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetUpSampleBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">LocalNetUpSampleBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L171-L248"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetUpSampleBlock" title="Link to this definition">#</a></dt>
<dd><p>An up-sample module that can be used for LocalNet, based on:
<a class="reference external" href="https://doi.org/10.1016/j.media.2018.07.002">Weakly-supervised convolutional neural networks for multimodal image registration</a>.
<a class="reference external" href="https://arxiv.org/abs/1711.01666">Label-driven weakly-supervised learning for multimodal deformable image registration</a>.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetUpSampleBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L183-L216"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetUpSampleBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – interpolation mode of the additive upsampling, default to ‘nearest’.</p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – whether to align corners for the additive upsampling, default to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when <code class="docutils literal notranslate"><span class="pre">in_channels</span> <span class="pre">!=</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">out_channels</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetUpSampleBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L226-L248"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetUpSampleBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Halves the channel and doubles the spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – feature to be up-sampled, in shape (batch, <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>, insize_1, insize_2, [insize_3])</p></li>
<li><p><strong>mid</strong> – mid-level feature saved during down-sampling,
in shape (batch, <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>, midsize_1, midsize_2, [midsize_3])</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when <code class="docutils literal notranslate"><span class="pre">midsize</span> <span class="pre">!=</span> <span class="pre">insize</span> <span class="pre">*</span> <span class="pre">2</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="localnet-feature-extractor-block">
<h3><cite>LocalNet Feature Extractor Block</cite><a class="headerlink" href="#localnet-feature-extractor-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetFeatureExtractorBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">LocalNetFeatureExtractorBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L251-L301"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetFeatureExtractorBlock" title="Link to this definition">#</a></dt>
<dd><p>A feature-extraction module that can be used for LocalNet, based on:
<a class="reference external" href="https://doi.org/10.1016/j.media.2018.07.002">Weakly-supervised convolutional neural networks for multimodal image registration</a>.
<a class="reference external" href="https://arxiv.org/abs/1711.01666">Label-driven weakly-supervised learning for multimodal deformable image registration</a>.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetFeatureExtractorBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L263-L293"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetFeatureExtractorBlock.__init__" title="Link to this definition">#</a></dt>
<dd><p>Args:
spatial_dims: number of spatial dimensions.
in_channels: number of input channels.
out_channels: number of output channels.
act: activation type and arguments. Defaults to ReLU.
kernel_initializer: kernel initializer. Defaults to None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.LocalNetFeatureExtractorBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/localnet_block.py#L295-L301"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.LocalNetFeatureExtractorBlock.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>, insize_1, insize_2, [insize_3])</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="mlp-block">
<h3><cite>MLP Block</cite><a class="headerlink" href="#mlp-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.MLPBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">MLPBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vit'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/mlp.py#L25-L80"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MLPBlock" title="Link to this definition">#</a></dt>
<dd><p>A multi-layer perceptron block, based on: “Dosovitskiy et al.,
An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale &lt;<a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.MLPBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vit'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/mlp.py#L31-L73"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MLPBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of hidden layer.</p></li>
<li><p><strong>mlp_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of feedforward layer. If 0, <cite>hidden_size</cite> will be used.</p></li>
<li><p><strong>dropout_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – fraction of the input units to drop.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to GELU. Also supports “GEGLU” and others.</p></li>
<li><p><strong>dropout_mode</strong> – dropout mode, can be “vit” or “swin”.
“vit” mode uses two dropout instances as implemented in
<a class="github reference external" href="https://github.com/google-research/vision_transformer/blob/main/vit_jax/models.py#L87">google-research/vision_transformer</a>
“swin” corresponds to one instance as implemented in
<a class="github reference external" href="https://github.com/microsoft/Swin-Transformer/blob/main/models/swin_mlp.py#L23">microsoft/Swin-Transformer</a>
“vista3d” mode does not use dropout.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.MLPBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/mlp.py#L75-L80"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.MLPBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="patch-embedding-block">
<h3><cite>Patch Embedding Block</cite><a class="headerlink" href="#patch-embedding-block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.PatchEmbeddingBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">PatchEmbeddingBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'learnable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/patchembedding.py#L32-L138"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.PatchEmbeddingBlock" title="Link to this definition">#</a></dt>
<dd><p>A patch embedding block, based on: “Dosovitskiy et al.,
An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale &lt;<a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>&gt;”</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.blocks</span><span class="w"> </span><span class="kn">import</span> <span class="n">PatchEmbeddingBlock</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PatchEmbeddingBlock</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="n">proj_type</span><span class="o">=</span><span class="s2">&quot;conv&quot;</span><span class="p">,</span> <span class="n">pos_embed_type</span><span class="o">=</span><span class="s2">&quot;sincos&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.PatchEmbeddingBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'learnable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/patchembedding.py#L45-L121"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.PatchEmbeddingBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of input channels.</p></li>
<li><p><strong>img_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of input image.</p></li>
<li><p><strong>patch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of patch size.</p></li>
<li><p><strong>hidden_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of hidden layer.</p></li>
<li><p><strong>num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of attention heads.</p></li>
<li><p><strong>proj_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – patch embedding layer type.</p></li>
<li><p><strong>pos_embed_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – position embedding layer type.</p></li>
<li><p><strong>dropout_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – fraction of the input units to drop.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.PatchEmbeddingBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/patchembedding.py#L132-L138"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.PatchEmbeddingBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="factorizedincreaseblock">
<h3><cite>FactorizedIncreaseBlock</cite><a class="headerlink" href="#factorizedincreaseblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.FactorizedIncreaseBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">FactorizedIncreaseBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L22-L69"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FactorizedIncreaseBlock" title="Link to this definition">#</a></dt>
<dd><p>Up-sampling the features by two using linear interpolation and convolutions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FactorizedIncreaseBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L27-L69"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FactorizedIncreaseBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels</p></li>
<li><p><strong>out_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="factorizedreduceblock">
<h3><cite>FactorizedReduceBlock</cite><a class="headerlink" href="#factorizedreduceblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.FactorizedReduceBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">FactorizedReduceBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L72-L136"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FactorizedReduceBlock" title="Link to this definition">#</a></dt>
<dd><p>Down-sampling the feature by 2 using stride.
The length along each spatial dimension must be a multiple of 2.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FactorizedReduceBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L78-L124"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FactorizedReduceBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels</p></li>
<li><p><strong>out_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.FactorizedReduceBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L126-L136"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.FactorizedReduceBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>The length along each spatial dimension must be a multiple of 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="p3dacticonvnormblock">
<h3><cite>P3DActiConvNormBlock</cite><a class="headerlink" href="#p3dacticonvnormblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.P3DActiConvNormBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">P3DActiConvNormBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L139-L221"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.P3DActiConvNormBlock" title="Link to this definition">#</a></dt>
<dd><p>– (act) – (conv) – (norm) –</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.P3DActiConvNormBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L144-L221"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.P3DActiConvNormBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel size to be expanded to 3D.</p></li>
<li><p><strong>padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – padding size to be expanded to 3D.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>mode for the anisotropic kernels:</p>
<ul>
<li><p>0: <code class="docutils literal notranslate"><span class="pre">(k,</span> <span class="pre">k,</span> <span class="pre">1)</span></code>, <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">k)</span></code>,</p></li>
<li><p>1: <code class="docutils literal notranslate"><span class="pre">(k,</span> <span class="pre">1,</span> <span class="pre">k)</span></code>, <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">k,</span> <span class="pre">1)</span></code>,</p></li>
<li><p>2: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">k,</span> <span class="pre">k)</span></code>. <code class="docutils literal notranslate"><span class="pre">(k,</span> <span class="pre">1,</span> <span class="pre">1)</span></code>.</p></li>
</ul>
</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="acticonvnormblock">
<h3><cite>ActiConvNormBlock</cite><a class="headerlink" href="#acticonvnormblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.ActiConvNormBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">ActiConvNormBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L224-L271"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ActiConvNormBlock" title="Link to this definition">#</a></dt>
<dd><p>– (Acti) – (Conv) – (Norm) –</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.ActiConvNormBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/dints_block.py#L229-L271"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.ActiConvNormBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel size of the convolution.</p></li>
<li><p><strong>padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – padding size of the convolution.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="warp">
<h3><cite>Warp</cite><a class="headerlink" href="#warp" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.Warp">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">Warp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'border'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/warp.py#L30-L144"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Warp" title="Link to this definition">#</a></dt>
<dd><p>Warp an image with given dense displacement field (DDF).</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.Warp.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'border'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/warp.py#L35-L92"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Warp.__init__" title="Link to this definition">#</a></dt>
<dd><p>For pytorch native APIs, the possible values are:</p>
<blockquote>
<div><ul class="simple">
<li><p>mode: <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bicubic&quot;</span></code>.</p></li>
<li><p>padding_mode: <code class="docutils literal notranslate"><span class="pre">&quot;zeros&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;border&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reflection&quot;</span></code></p></li>
</ul>
</div></blockquote>
<p>See also: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html">https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html</a></p>
<p>For MONAI C++/CUDA extensions, the possible values are:</p>
<blockquote>
<div><ul class="simple">
<li><p>mode: <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bicubic&quot;</span></code>, 0, 1, …</p></li>
<li><p>padding_mode: <code class="docutils literal notranslate"><span class="pre">&quot;zeros&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;border&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reflection&quot;</span></code>, 0, 1, …</p></li>
</ul>
</div></blockquote>
<p>See also: <a class="reference internal" href="#monai.networks.layers.grid_pull" title="monai.networks.layers.grid_pull"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.grid_pull</span></code></a></p>
<ul class="simple">
<li><dl class="simple">
<dt>jitter: bool, default=False</dt><dd><p>Define reference grid on non-integer values
Reference: B. Likar and F. Pernus. A heirarchical approach to elastic registration
based on mutual information. Image and Vision Computing, 19:33-44, 2001.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.Warp.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddf</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/warp.py#L113-L144"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.Warp.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in shape (batch, num_channels, H, W[, D])</p></li>
<li><p><strong>ddf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor in the same spatial size as image, in shape (batch, <code class="docutils literal notranslate"><span class="pre">spatial_dims</span></code>, H, W[, D])</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>warped_image in the same shape as image (batch, num_channels, H, W[, D])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="dvf2ddf">
<h3><cite>DVF2DDF</cite><a class="headerlink" href="#dvf2ddf" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.blocks.DVF2DDF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.</span></span><span class="sig-name descname"><span class="pre">DVF2DDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/warp.py#L147-L177"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.DVF2DDF" title="Link to this definition">#</a></dt>
<dd><p>Layer calculates a dense displacement field (DDF) from a dense velocity field (DVF)
with scaling and squaring.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.blocks.DVF2DDF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dvf</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/warp.py#L166-L177"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.DVF2DDF.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dvf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – dvf to be transformed, in shape (batch, <code class="docutils literal notranslate"><span class="pre">spatial_dims</span></code>, H, W[,D])</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dense displacement field</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="varnetblock">
<h3><cite>VarNetBlock</cite><a class="headerlink" href="#varnetblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.blocks.varnetblock.</span></span><span class="sig-name descname"><span class="pre">VarNetBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refinement_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/blocks/varnetblock.py#L21-L81"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock" title="Link to this definition">#</a></dt>
<dd><p>A variational block based on Sriram et. al., “End-to-end variational networks for accelerated MRI reconstruction”.
It applies data consistency and refinement to the intermediate kspace and combines those results.</p>
<p>Modified and adopted from: <a class="github reference external" href="https://github.com/facebookresearch/fastMRI">facebookresearch/fastMRI</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>refinement_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – the model used for refinement (typically a U-Net but can be any deep learning model
that performs well when the input and output are in image domain (e.g., a convolutional network).</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – is 2 for 2D data and is 3 for 3D data</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_kspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_kspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sens_maps</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/blocks/varnetblock.py#L60-L81"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_kspace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Predicted kspace from the previous block. It’s a 2D kspace (B,C,H,W,2)
with the last dimension being 2 (for real/imaginary parts) and C denoting the
coil dimension. 3D data will have the shape (B,C,H,W,D,2).</p></li>
<li><p><strong>ref_kspace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – reference kspace for applying data consistency (is the under-sampled kspace in MRI reconstruction).
Its shape is the same as current_kspace.</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the under-sampling mask with shape (1,1,1,W,1) for 2D data or (1,1,1,1,D,1) for 3D data.</p></li>
<li><p><strong>sens_maps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – coil sensitivity maps with the same shape as current_kspace</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Output of VarNetBlock with the same shape as current_kspace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock.soft_dc">
<span class="sig-name descname"><span class="pre">soft_dc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_kspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/blocks/varnetblock.py#L43-L58"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock.soft_dc" title="Link to this definition">#</a></dt>
<dd><p>Applies data consistency to input x. Suppose x is an intermediate estimate of the kspace and ref_kspace
is the reference under-sampled measurement. This function returns mask * (x - ref_kspace). View this as the
residual between the original under-sampled kspace and the estimate given by the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – 2D kspace (B,C,H,W,2) with the last dimension being 2 (for real/imaginary parts) and C denoting the
coil dimension. 3D data will have the shape (B,C,H,W,D,2).</p></li>
<li><p><strong>ref_kspace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – original under-sampled kspace with the same shape as x.</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the under-sampling mask with shape (1,1,1,W,1) for 2D data or (1,1,1,1,D,1) for 3D data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Output of DC block with the same shape as x</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-monai.networks.blocks.fft_utils_t">
<span id="n-dim-fourier-transform"></span><h3>N-Dim Fourier Transform<a class="headerlink" href="#module-monai.networks.blocks.fft_utils_t" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.blocks.fft_utils_t.fftn_centered_t">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.fft_utils_t.</span></span><span class="sig-name descname"><span class="pre">fftn_centered_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fft_utils_t.py#L157-L198"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.fft_utils_t.fftn_centered_t" title="Link to this definition">#</a></dt>
<dd><p>Pytorch-based fft for spatial_dims-dim signals. “centered” means this function automatically takes care
of the required ifft and fft shifts.
This is equivalent to do ifft in numpy based on numpy.fft.fftn, numpy.fft.fftshift, and numpy.fft.ifftshift</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – image that can be
1) real-valued: the shape is (C,H,W) for 2D spatial inputs and (C,H,W,D) for 3D, or
2) complex-valued: the shape is (C,H,W,2) for 2D spatial data and (C,H,W,D,2) for 3D. C is the number of channels.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions (e.g., is 2 for an image, and is 3 for a volume)</p></li>
<li><p><strong>is_complex</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, then the last dimension of the input im is expected to be 2 (representing real and imaginary channels)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>“out” which is the output kspace (fourier of im)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># the last dim belongs to real/imaginary parts</span>
<span class="c1"># output1 and output2 will be identical</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftn</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))),</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;ortho&quot;</span><span class="p">)</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span> <span class="n">torch</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">output1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

<span class="n">output2</span> <span class="o">=</span> <span class="n">fftn_centered</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">is_complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.blocks.fft_utils_t.ifftn_centered_t">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.fft_utils_t.</span></span><span class="sig-name descname"><span class="pre">ifftn_centered_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ksp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fft_utils_t.py#L113-L154"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.fft_utils_t.ifftn_centered_t" title="Link to this definition">#</a></dt>
<dd><p>Pytorch-based ifft for spatial_dims-dim signals. “centered” means this function automatically takes care
of the required ifft and fft shifts.
This is equivalent to do fft in numpy based on numpy.fft.ifftn, numpy.fft.fftshift, and numpy.fft.ifftshift</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ksp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – k-space data that can be
1) real-valued: the shape is (C,H,W) for 2D spatial inputs and (C,H,W,D) for 3D, or
2) complex-valued: the shape is (C,H,W,2) for 2D spatial data and (C,H,W,D,2) for 3D. C is the number of channels.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions (e.g., is 2 for an image, and is 3 for a volume)</p></li>
<li><p><strong>is_complex</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, then the last dimension of the input ksp is expected to be 2 (representing real and imaginary channels)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>“out” which is the output image (inverse fourier of ksp)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="n">ksp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># the last dim belongs to real/imaginary parts</span>
<span class="c1"># output1 and output2 will be identical</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftn</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">view_as_complex</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">ksp</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))),</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;ortho&quot;</span><span class="p">)</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span> <span class="n">torch</span><span class="o">.</span><span class="n">view_as_real</span><span class="p">(</span><span class="n">output1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

<span class="n">output2</span> <span class="o">=</span> <span class="n">ifftn_centered</span><span class="p">(</span><span class="n">ksp</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">is_complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.blocks.fft_utils_t.roll">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.fft_utils_t.</span></span><span class="sig-name descname"><span class="pre">roll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_dims</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fft_utils_t.py#L45-L66"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.fft_utils_t.roll" title="Link to this definition">#</a></dt>
<dd><p>Similar to np.roll but applies to PyTorch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input data (k-space or image) that can be
1) real-valued: the shape is (C,H,W) for 2D spatial inputs and (C,H,W,D) for 3D, or
2) complex-valued: the shape is (C,H,W,2) for 2D spatial data and (C,H,W,D,2) for 3D. C is the number of channels.</p></li>
<li><p><strong>shift</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the amount of shift along each of shift_dims dimensions</p></li>
<li><p><strong>shift_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimensions over which the shift is applied</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shifted version of x</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is called when fftshift and ifftshift are not available in the running pytorch version</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.blocks.fft_utils_t.roll_1d">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.fft_utils_t.</span></span><span class="sig-name descname"><span class="pre">roll_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_dim</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fft_utils_t.py#L18-L42"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.fft_utils_t.roll_1d" title="Link to this definition">#</a></dt>
<dd><p>Similar to roll but for only one dim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input data (k-space or image) that can be
1) real-valued: the shape is (C,H,W) for 2D spatial inputs and (C,H,W,D) for 3D, or
2) complex-valued: the shape is (C,H,W,2) for 2D spatial data and (C,H,W,D,2) for 3D. C is the number of channels.</p></li>
<li><p><strong>shift</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the amount of shift along each of shift_dims dimension</p></li>
<li><p><strong>shift_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the dimension over which the shift is applied</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>1d-shifted version of x</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is called when fftshift and ifftshift are not available in the running pytorch version</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.blocks.fft_utils_t.fftshift">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.fft_utils_t.</span></span><span class="sig-name descname"><span class="pre">fftshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_dims</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fft_utils_t.py#L69-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.fft_utils_t.fftshift" title="Link to this definition">#</a></dt>
<dd><p>Similar to np.fft.fftshift but applies to PyTorch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input data (k-space or image) that can be
1) real-valued: the shape is (C,H,W) for 2D spatial inputs and (C,H,W,D) for 3D, or
2) complex-valued: the shape is (C,H,W,2) for 2D spatial data and (C,H,W,D,2) for 3D. C is the number of channels.</p></li>
<li><p><strong>shift_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimensions over which the shift is applied</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>fft-shifted version of x</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is called when fftshift is not available in the running pytorch version</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.blocks.fft_utils_t.ifftshift">
<span class="sig-prename descclassname"><span class="pre">monai.networks.blocks.fft_utils_t.</span></span><span class="sig-name descname"><span class="pre">ifftshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_dims</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/blocks/fft_utils_t.py#L91-L110"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.blocks.fft_utils_t.ifftshift" title="Link to this definition">#</a></dt>
<dd><p>Similar to np.fft.ifftshift but applies to PyTorch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input data (k-space or image) that can be
1) real-valued: the shape is (C,H,W) for 2D spatial inputs and (C,H,W,D) for 3D, or
2) complex-valued: the shape is (C,H,W,2) for 2D spatial data and (C,H,W,D,2) for 3D. C is the number of channels.</p></li>
<li><p><strong>shift_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimensions over which the shift is applied</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ifft-shifted version of x</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is called when ifftshift is not available in the running pytorch version</p>
</div>
</dd></dl>

</section>
</section>
<section id="layers">
<h2>Layers<a class="headerlink" href="#layers" title="Link to this heading">#</a></h2>
<section id="module-monai.networks.layers.factories">
<span id="factories"></span><h3><cite>Factories</cite><a class="headerlink" href="#module-monai.networks.layers.factories" title="Link to this heading">#</a></h3>
<p>Defines factories for creating layers in generic, extensible, and dimensionally independent ways. A separate factory
object is created for each type of layer, and factory functions keyed to names are added to these objects. Whenever
a layer is requested the factory name and any necessary arguments are passed to the factory object. The return value
is typically a type but can be any callable producing a layer object.</p>
<p>The factory objects contain functions keyed to names converted to upper case, these names can be referred to as members
of the factory so that they can function as constant identifiers. eg. instance normalization is named <cite>Norm.INSTANCE</cite>.</p>
<p>For example, to get a transpose convolution layer the name is needed and then a dimension argument is provided which is
passed to the factory function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">Conv</span><span class="o">.</span><span class="n">CONVTRANS</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">Conv</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="n">dimension</span><span class="p">]</span>
</pre></div>
</div>
<p>This allows the <cite>dimension</cite> value to be set in the constructor, for example so that the dimensionality of a network is
parameterizable. Not all factories require arguments after the name, the caller must be aware which are required.</p>
<p>Defining new factories involves creating the object then associating it with factory functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fact</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>

<span class="nd">@fact</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_something</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># do something with x and y to choose which layer type to return</span>
    <span class="k">return</span> <span class="n">SomeLayerType</span>
<span class="o">...</span>

<span class="c1"># request object from factory TEST with 1 and 2 as values for x and y</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">fact</span><span class="p">[</span><span class="n">fact</span><span class="o">.</span><span class="n">TEST</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Typically the caller of a factory would know what arguments to pass (ie. the dimensionality of the requested type) but
can be parameterized with the factory name and the arguments to pass to the created type at instantiation time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">use_factory</span><span class="p">(</span><span class="n">fact_args</span><span class="p">):</span>
    <span class="n">fact_name</span><span class="p">,</span> <span class="n">type_args</span> <span class="o">=</span> <span class="n">split_args</span>
    <span class="n">layer_type</span> <span class="o">=</span> <span class="n">fact</span><span class="p">[</span><span class="n">fact_name</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">layer_type</span><span class="p">(</span><span class="o">**</span><span class="n">type_args</span><span class="p">)</span>
<span class="o">...</span>

<span class="n">kw_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;arg0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;arg1&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">use_factory</span><span class="p">(</span> <span class="p">(</span><span class="n">fact</span><span class="o">.</span><span class="n">TEST</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.LayerFactory">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">LayerFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/factories.py#L76-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LayerFactory" title="Link to this definition">#</a></dt>
<dd><p>Factory object for creating layers, this uses given factory functions to actually produce the types or constructing
callables. These functions are referred to by name and can be added at any time.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.LayerFactory.add_factory_callable">
<span class="sig-name descname"><span class="pre">add_factory_callable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/factories.py#L90-L98"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LayerFactory.add_factory_callable" title="Link to this definition">#</a></dt>
<dd><p>Add the factory function to this object under the given name, with optional description.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.LayerFactory.add_factory_class">
<span class="sig-name descname"><span class="pre">add_factory_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/factories.py#L100-L104"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LayerFactory.add_factory_class" title="Link to this definition">#</a></dt>
<dd><p>Adds a factory function which returns the supplied class under the given name, with optional description.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.LayerFactory.factory_function">
<span class="sig-name descname"><span class="pre">factory_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/factories.py#L106-L115"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LayerFactory.factory_function" title="Link to this definition">#</a></dt>
<dd><p>Decorator for adding a factory function with the given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.LayerFactory.get_constructor">
<span class="sig-name descname"><span class="pre">get_constructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factory_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/factories.py#L117-L131"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LayerFactory.get_constructor" title="Link to this definition">#</a></dt>
<dd><p>Get the constructor for the given factory name and arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">factory_name</span></code> is not a <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="split-args">
<h3><cite>split_args</cite><a class="headerlink" href="#split-args" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.split_args">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">split_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/factories.py#L163-L194"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.split_args" title="Link to this definition">#</a></dt>
<dd><p>Split arguments in a way to be suitable for using with the factory types. If <cite>args</cite> is a string it’s interpreted as
the type name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>str</em><em> or </em><em>a tuple</em><em> of </em><em>object name and kwarg dict</em>) – input arguments to be parsed.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">args</span></code> type is not in <code class="docutils literal notranslate"><span class="pre">Union[str,</span> <span class="pre">Tuple[Union[str,</span> <span class="pre">Callable],</span> <span class="pre">dict]]</span></code>.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">act_type</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">split_args</span><span class="p">(</span><span class="s2">&quot;PRELU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monai</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Act</span><span class="p">[</span><span class="n">act_type</span><span class="p">]</span>
<span class="go">&lt;class &#39;torch.nn.modules.activation.PReLU&#39;&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">act_type</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">split_args</span><span class="p">((</span><span class="s2">&quot;PRELU&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_parameters&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">monai</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Act</span><span class="p">[</span><span class="n">act_type</span><span class="p">](</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
<span class="go">PReLU(num_parameters=1)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-monai.networks.layers.Dropout">
<span id="dropout"></span><h3><cite>Dropout</cite><a class="headerlink" href="#module-monai.networks.layers.Dropout" title="Link to this heading">#</a></h3>
<p>Layer Factory ‘Dropout layers’: Factory for creating dropout layers.
Please see <a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a> for additional args parsing.</p>
<p>The supported members are: <code class="docutils literal notranslate"><span class="pre">dropout</span></code>, <code class="docutils literal notranslate"><span class="pre">alphadropout</span></code></p>
</section>
<section id="module-monai.networks.layers.Act">
<span id="act"></span><h3><cite>Act</cite><a class="headerlink" href="#module-monai.networks.layers.Act" title="Link to this heading">#</a></h3>
<p>Layer Factory ‘Activation layers’: Factory for creating activation layers.
Please see <a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a> for additional args parsing.</p>
<p>The supported members are: <code class="docutils literal notranslate"><span class="pre">elu</span></code>, <code class="docutils literal notranslate"><span class="pre">relu</span></code>, <code class="docutils literal notranslate"><span class="pre">leakyrelu</span></code>, <code class="docutils literal notranslate"><span class="pre">prelu</span></code>, <code class="docutils literal notranslate"><span class="pre">relu6</span></code>, <code class="docutils literal notranslate"><span class="pre">selu</span></code>, <code class="docutils literal notranslate"><span class="pre">celu</span></code>, <code class="docutils literal notranslate"><span class="pre">gelu</span></code>, <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>, <code class="docutils literal notranslate"><span class="pre">tanh</span></code>, <code class="docutils literal notranslate"><span class="pre">softmax</span></code>, <code class="docutils literal notranslate"><span class="pre">logsoftmax</span></code>, <code class="docutils literal notranslate"><span class="pre">swish</span></code>, <code class="docutils literal notranslate"><span class="pre">memswish</span></code>, <code class="docutils literal notranslate"><span class="pre">mish</span></code>, <code class="docutils literal notranslate"><span class="pre">geglu</span></code></p>
</section>
<section id="module-monai.networks.layers.Norm">
<span id="norm"></span><h3><cite>Norm</cite><a class="headerlink" href="#module-monai.networks.layers.Norm" title="Link to this heading">#</a></h3>
<p>Layer Factory ‘Normalization layers’: Factory for creating normalization layers.
Please see <a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a> for additional args parsing.</p>
<p>The supported members are: <code class="docutils literal notranslate"><span class="pre">instance</span></code>, <code class="docutils literal notranslate"><span class="pre">batch</span></code>, <code class="docutils literal notranslate"><span class="pre">instance_nvfuser</span></code>, <code class="docutils literal notranslate"><span class="pre">group</span></code>, <code class="docutils literal notranslate"><span class="pre">layer</span></code>, <code class="docutils literal notranslate"><span class="pre">localresponse</span></code>, <code class="docutils literal notranslate"><span class="pre">syncbatch</span></code></p>
</section>
<section id="module-monai.networks.layers.Conv">
<span id="conv"></span><h3><cite>Conv</cite><a class="headerlink" href="#module-monai.networks.layers.Conv" title="Link to this heading">#</a></h3>
<p>Layer Factory ‘Convolution layers’: Factory for creating convolution layers.
Please see <a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a> for additional args parsing.</p>
<p>The supported members are: <code class="docutils literal notranslate"><span class="pre">conv</span></code>, <code class="docutils literal notranslate"><span class="pre">convtrans</span></code></p>
</section>
<section id="module-monai.networks.layers.Pad">
<span id="pad"></span><h3><cite>Pad</cite><a class="headerlink" href="#module-monai.networks.layers.Pad" title="Link to this heading">#</a></h3>
<p>Layer Factory ‘Padding layers’: Factory for creating padding layers.
Please see <a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a> for additional args parsing.</p>
<p>The supported members are: <code class="docutils literal notranslate"><span class="pre">replicationpad</span></code>, <code class="docutils literal notranslate"><span class="pre">constantpad</span></code></p>
</section>
<section id="module-monai.networks.layers.Pool">
<span id="pool"></span><h3><cite>Pool</cite><a class="headerlink" href="#module-monai.networks.layers.Pool" title="Link to this heading">#</a></h3>
<p>Layer Factory ‘Pooling layers’: Factory for creating pooling layers.
Please see <a class="reference internal" href="#monai.networks.layers.split_args" title="monai.networks.layers.split_args"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.layers.split_args</span></code></a> for additional args parsing.</p>
<p>The supported members are: <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">adaptivemax</span></code>, <code class="docutils literal notranslate"><span class="pre">avg</span></code>, <code class="docutils literal notranslate"><span class="pre">adaptiveavg</span></code></p>
</section>
<section id="channelpad">
<h3><cite>ChannelPad</cite><a class="headerlink" href="#channelpad" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.ChannelPad">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">ChannelPad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pad</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L55-L100"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ChannelPad" title="Link to this definition">#</a></dt>
<dd><p>Expand the input tensor’s channel dimension from length <cite>in_channels</cite> to <cite>out_channels</cite>,
by padding or a projection.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.ChannelPad.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pad</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L61-L93"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ChannelPad.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.ChannelMatching" title="monai.utils.enums.ChannelMatching"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelMatching</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;project&quot;</span></code>}
Specifies handling residual branch and conv branch channel mismatches. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>: with zero padding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;project&quot;</span></code>: with a trainable conv with kernel size one.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.ChannelPad.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L95-L100"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ChannelPad.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="skipconnection">
<h3><cite>SkipConnection</cite><a class="headerlink" href="#skipconnection" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.SkipConnection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">SkipConnection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">submodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cat'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L103-L136"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.SkipConnection" title="Link to this definition">#</a></dt>
<dd><p>Combine the forward pass input with the result from the given submodule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--+--</span><span class="n">submodule</span><span class="o">--</span><span class="n">o</span><span class="o">--</span>
  <span class="o">|</span><span class="n">_____________</span><span class="o">|</span>
</pre></div>
</div>
<p>The available modes are <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mul&quot;</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.SkipConnection.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">submodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cat'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L113-L125"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.SkipConnection.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>submodule</strong> – the module defines the trainable branch.</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the dimension over which the tensors are concatenated.
Used when mode is <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <a class="reference internal" href="utils.html#monai.utils.enums.SkipMode" title="monai.utils.enums.SkipMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SkipMode</span></code></a>]) – <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mul&quot;</span></code>. defaults to <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.SkipConnection.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L127-L136"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.SkipConnection.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="flatten">
<h3><cite>Flatten</cite><a class="headerlink" href="#flatten" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.Flatten">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">Flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L139-L145"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.Flatten" title="Link to this definition">#</a></dt>
<dd><p>Flattens the given input in the forward pass to be [B,-1] in shape.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.Flatten.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L144-L145"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.Flatten.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="reshape">
<h3><cite>Reshape</cite><a class="headerlink" href="#reshape" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.Reshape">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">Reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L148-L167"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.Reshape" title="Link to this definition">#</a></dt>
<dd><p>Reshapes input tensors to the given shape (minus batch dimension), retaining original batch size.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.Reshape.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L153-L162"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.Reshape.__init__" title="Link to this definition">#</a></dt>
<dd><p>Given a shape list/tuple <cite>shape</cite> of integers (s0, s1, … , sn), this layer will reshape input tensors of
shape (batch, s0 * s1 * … * sn) to shape (batch, s0, s1, … , sn).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – list/tuple of integer shape dimensions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.Reshape.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L164-L167"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.Reshape.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="separable-filtering">
<h3><cite>separable_filtering</cite><a class="headerlink" href="#separable-filtering" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.separable_filtering">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">separable_filtering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L207-L249"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.separable_filtering" title="Link to this definition">#</a></dt>
<dd><p>Apply 1-D convolutions along each spatial dimension of <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the input image. must have shape (batch, channels, H[, W, …]).</p></li>
<li><p><strong>kernels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – kernel along each spatial dimension.
could be a single kernel (duplicated for all spatial dimensions), or
a list of <cite>spatial_dims</cite> number of kernels.</p></li>
<li><p><strong>mode</strong> (<em>string</em><em>, </em><em>optional</em>) – padding mode passed to convolution class. <code class="docutils literal notranslate"><span class="pre">'zeros'</span></code>, <code class="docutils literal notranslate"><span class="pre">'reflect'</span></code>, <code class="docutils literal notranslate"><span class="pre">'replicate'</span></code>
or <code class="docutils literal notranslate"><span class="pre">'circular'</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">'zeros'</span></code>. See <code class="docutils literal notranslate"><span class="pre">torch.nn.Conv1d()</span></code> for more information.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">x</span></code> is not a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">separable_filtering</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># batch_size 2, channels 4, 32x32 2D images</span>
<span class="go"># applying a [-1, 0, 1] filter along each of the spatial dimensions.</span>
<span class="go"># the output shape is the same as the input shape.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">separable_filtering</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)))</span>
<span class="go"># applying `[-1, 0, 1]`, `[1, 0, -1]` filters along two spatial dimensions respectively.</span>
<span class="go"># the output shape is the same as the input shape.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">separable_filtering</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">))])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="apply-filter">
<h3><cite>apply_filter</cite><a class="headerlink" href="#apply-filter" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.apply_filter">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">apply_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L252-L300"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.apply_filter" title="Link to this definition">#</a></dt>
<dd><p>Filtering <cite>x</cite> with <cite>kernel</cite> independently for each batch and channel respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the input image, must have shape (batch, channels, H[, W, D]).</p></li>
<li><p><strong>kernel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – <cite>kernel</cite> must at least have the spatial shape (H_k[, W_k, D_k]).
<cite>kernel</cite> shape must be broadcastable to the <cite>batch</cite> and <cite>channels</cite> dimensions of <cite>x</cite>.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <cite>conv*d()</cite> functions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The filtered <cite>x</cite>.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">apply_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># batch_size 2, channels 5, 10x10 2D images</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>   <span class="c1"># spatial kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># channel-wise kernels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># batch-, channel-wise kernels</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="gaussianfilter">
<h3><cite>GaussianFilter</cite><a class="headerlink" href="#gaussianfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.GaussianFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">GaussianFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'erf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L542-L595"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.GaussianFilter" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.GaussianFilter.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'erf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L544-L587"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.GaussianFilter.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.
must have shape (Batch, channels, H[, W, …]).</p></li>
<li><p><strong>sigma</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – std. could be a single value, or <cite>spatial_dims</cite> number of values.</p></li>
<li><p><strong>truncated</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – spreads how many stds.</p></li>
<li><p><strong>approx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>discrete Gaussian kernel type, available options are “erf”, “sampled”, and “scalespace”.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">erf</span></code> approximation interpolates the error function;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampled</span></code> uses a sampled Gaussian kernel;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scalespace</span></code> corresponds to
<a class="reference external" href="https://en.wikipedia.org/wiki/Scale_space_implementation#The_discrete_Gaussian_kernel">https://en.wikipedia.org/wiki/Scale_space_implementation#The_discrete_Gaussian_kernel</a>
based on the modified Bessel functions.</p></li>
</ul>
</p></li>
<li><p><strong>requires_grad</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to store the gradients for sigma.
if True, <cite>sigma</cite> will be the initial value of the parameters of this module
(for example <cite>parameters()</cite> iterator could be used to get the parameters);
otherwise this module will fix the kernels using <cite>sigma</cite> as the std.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.GaussianFilter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L589-L595"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.GaussianFilter.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – in shape [Batch, chns, H, W, D].</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="medianfilter">
<h3><cite>MedianFilter</cite><a class="headerlink" href="#medianfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.MedianFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">MedianFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L501-L539"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.MedianFilter" title="Link to this definition">#</a></dt>
<dd><p>Apply median filter to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>radius</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the blurring kernel radius (radius of 1 corresponds to 3x3x3 kernel when spatial_dims=3).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered input tensor.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MedianFilter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blur</span> <span class="o">=</span> <span class="n">MedianFilter</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># 3x3x3 kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">blur</span><span class="p">(</span><span class="n">in_tensor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 5, 7, 6])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.MedianFilter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_passes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L530-L539"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.MedianFilter.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input tensor, median filtering will be applied to the last <cite>spatial_dims</cite> dimensions.</p></li>
<li><p><strong>number_of_passes</strong> – median filtering will be repeated this many times</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="median-filter">
<h3><cite>median_filter</cite><a class="headerlink" href="#median-filter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.median_filter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">median_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L441-L498"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.median_filter" title="Link to this definition">#</a></dt>
<dd><p>Apply median filter to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input tensor; median filtering will be applied to the last <cite>spatial_dims</cite> dimensions.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the convolution kernel size.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions to apply median filtering.</p></li>
<li><p><strong>kernel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – an optional customized kernel.</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the <cite>conv</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the filtered input tensor, shape remains the same as <code class="docutils literal notranslate"><span class="pre">in_tensor</span></code></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">median_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">median_filter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 5, 7, 6])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="bilateralfilter">
<h3><cite>BilateralFilter</cite><a class="headerlink" href="#bilateralfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.BilateralFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">BilateralFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L23-L63"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.BilateralFilter" title="Link to this definition">#</a></dt>
<dd><p>Blurs the input tensor spatially whilst preserving edges. Can run on 1D, 2D, or 3D,
tensors (on top of Batch and Channel dimensions). Two implementations are provided,
an exact solution and a much faster approximation which uses a permutohedral lattice.</p>
<dl class="simple">
<dt>See:</dt><dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Bilateral_filter">https://en.wikipedia.org/wiki/Bilateral_filter</a>
<a class="reference external" href="https://graphics.stanford.edu/papers/permutohedral/">https://graphics.stanford.edu/papers/permutohedral/</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – input tensor.</p></li>
<li><p><strong>spatial_sigma</strong> – the standard deviation of the spatial blur. Higher values can
hurt performance when not using the approximate method (see fast approx).</p></li>
<li><p><strong>color_sigma</strong> – the standard deviation of the color blur. Lower values preserve
edges better whilst higher values tend to a simple gaussian spatial blur.</p></li>
<li><p><strong>approx</strong> (<em>fast</em>) – This flag chooses between two implementations. The approximate method may
produce artifacts in some scenarios whereas the exact solution may be intolerably
slow for high spatial standard deviations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.BilateralFilter.backward">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L58-L63"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.BilateralFilter.backward" title="Link to this definition">#</a></dt>
<dd><p>autograd backward</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.BilateralFilter.forward">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast_approx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L47-L56"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.BilateralFilter.forward" title="Link to this definition">#</a></dt>
<dd><p>autograd forward</p>
</dd></dl>

</dd></dl>

</section>
<section id="trainablebilateralfilter">
<h3><cite>TrainableBilateralFilter</cite><a class="headerlink" href="#trainablebilateralfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.TrainableBilateralFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">TrainableBilateralFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_sigma</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L184-L262"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.TrainableBilateralFilter" title="Link to this definition">#</a></dt>
<dd><p>Implementation of a trainable bilateral filter layer as proposed in the corresponding publication.
All filter parameters can be trained data-driven. The spatial filter kernels x, y, and z determine
image smoothing whereas the color parameter specifies the amount of edge preservation.
Can run on 1D, 2D, or 3D tensors (on top of Batch and Channel dimensions).</p>
<dl class="simple">
<dt>See:</dt><dd><p>F. Wagner, et al., Ultralow-parameter denoising: Trainable bilateral filter layers in
computed tomography, Medical Physics (2022), <a class="reference external" href="https://doi.org/10.1002/mp.15718">https://doi.org/10.1002/mp.15718</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – input tensor to be filtered.</p></li>
<li><p><strong>spatial_sigma</strong> – tuple (sigma_x, sigma_y, sigma_z) initializing the trainable standard
deviations of the spatial filter kernels. Tuple length must equal the number of
spatial input dimensions.</p></li>
<li><p><strong>color_sigma</strong> – trainable standard deviation of the intensity range kernel. This filter
parameter determines the degree of edge preservation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.TrainableBilateralFilter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L233-L262"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.TrainableBilateralFilter.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="trainablejointbilateralfilter">
<h3><cite>TrainableJointBilateralFilter</cite><a class="headerlink" href="#trainablejointbilateralfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.TrainableJointBilateralFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">TrainableJointBilateralFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_sigma</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L349-L437"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.TrainableJointBilateralFilter" title="Link to this definition">#</a></dt>
<dd><p>Implementation of a trainable joint bilateral filter layer as proposed in the corresponding publication.
The guidance image is used as additional (edge) information during filtering. All filter parameters and the
guidance image can be trained data-driven. The spatial filter kernels x, y, and z determine
image smoothing whereas the color parameter specifies the amount of edge preservation.
Can run on 1D, 2D, or 3D tensors (on top of Batch and Channel dimensions). Input tensor shape must match
guidance tensor shape.</p>
<dl class="simple">
<dt>See:</dt><dd><p>F. Wagner, et al., Trainable joint bilateral filters for enhanced prediction stability in
low-dose CT, Scientific Reports (2022), <a class="reference external" href="https://doi.org/10.1038/s41598-022-22530-4">https://doi.org/10.1038/s41598-022-22530-4</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – input tensor to be filtered.</p></li>
<li><p><strong>guide</strong> – guidance image tensor to be used during filtering.</p></li>
<li><p><strong>spatial_sigma</strong> – tuple (sigma_x, sigma_y, sigma_z) initializing the trainable standard
deviations of the spatial filter kernels. Tuple length must equal the number of
spatial input dimensions.</p></li>
<li><p><strong>color_sigma</strong> – trainable standard deviation of the intensity range kernel. This filter
parameter determines the degree of edge preservation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.TrainableJointBilateralFilter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guidance_tensor</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L401-L437"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.TrainableJointBilateralFilter.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="phlfilter">
<h3><cite>PHLFilter</cite><a class="headerlink" href="#phlfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.PHLFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">PHLFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/filtering.py#L66-L101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.PHLFilter" title="Link to this definition">#</a></dt>
<dd><p>Filters input based on arbitrary feature vectors. Uses a permutohedral
lattice data structure to efficiently approximate n-dimensional gaussian
filtering. Complexity is broadly independent of kernel size. Most applicable
to higher filter dimensions and larger kernel sizes.</p>
<dl class="simple">
<dt>See:</dt><dd><p><a class="reference external" href="https://graphics.stanford.edu/papers/permutohedral/">https://graphics.stanford.edu/papers/permutohedral/</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – input tensor to be filtered.</p></li>
<li><p><strong>features</strong> – feature tensor used to filter the input.</p></li>
<li><p><strong>sigmas</strong> – the standard deviations of each feature in the filter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="gaussianmixturemodel">
<h3><cite>GaussianMixtureModel</cite><a class="headerlink" href="#gaussianmixturemodel" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.GaussianMixtureModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">GaussianMixtureModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixture_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixture_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_build</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/gmm.py#L21-L77"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.GaussianMixtureModel" title="Link to this definition">#</a></dt>
<dd><p>Takes an initial labeling and uses a mixture of Gaussians to approximate each classes
distribution in the feature space. Each unlabeled element is then assigned a probability
of belonging to each class based on it’s fit to each classes approximated distribution.</p>
<dl class="simple">
<dt>See:</dt><dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mixture_model">https://en.wikipedia.org/wiki/Mixture_model</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="savitzkygolayfilter">
<h3><cite>SavitzkyGolayFilter</cite><a class="headerlink" href="#savitzkygolayfilter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.SavitzkyGolayFilter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">SavitzkyGolayFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L303-L367"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.SavitzkyGolayFilter" title="Link to this definition">#</a></dt>
<dd><p>Convolve a Tensor along a particular axis with a Savitzky-Golay kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Length of the filter window, must be a positive odd integer.</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Order of the polynomial to fit to each window, must be less than <code class="docutils literal notranslate"><span class="pre">window_length</span></code>.</p></li>
<li><p><strong>axis</strong> (<em>optional</em>) – Axis along which to apply the filter kernel. Default 2 (first spatial dimension).</p></li>
<li><p><strong>mode</strong> (<em>string</em><em>, </em><em>optional</em>) – padding mode passed to convolution class. <code class="docutils literal notranslate"><span class="pre">'zeros'</span></code>, <code class="docutils literal notranslate"><span class="pre">'reflect'</span></code>, <code class="docutils literal notranslate"><span class="pre">'replicate'</span></code> or</p></li>
<li><p><strong>Default</strong> (<em>'circular'.</em>) – <code class="docutils literal notranslate"><span class="pre">'zeros'</span></code>. See torch.nn.Conv1d() for more information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.SavitzkyGolayFilter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L324-L355"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.SavitzkyGolayFilter.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor or array-like to filter. Must be real, in shape <code class="docutils literal notranslate"><span class="pre">[Batch,</span> <span class="pre">chns,</span> <span class="pre">spatial1,</span> <span class="pre">spatial2,</span> <span class="pre">...]</span></code> and
have a device type of <code class="docutils literal notranslate"><span class="pre">'cpu'</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">x</span></code> filtered by Savitzky-Golay kernel with window length <code class="docutils literal notranslate"><span class="pre">self.window_length</span></code> using
polynomials of order <code class="docutils literal notranslate"><span class="pre">self.order</span></code>, along axis specified in <code class="docutils literal notranslate"><span class="pre">self.axis</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hilberttransform">
<h3><cite>HilbertTransform</cite><a class="headerlink" href="#hilberttransform" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.HilbertTransform">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">HilbertTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L370-L427"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.HilbertTransform" title="Link to this definition">#</a></dt>
<dd><p>Determine the analytical signal of a Tensor along a particular axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Axis along which to apply Hilbert transform. Default 2 (first spatial dimension).</p></li>
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Number of Fourier components (i.e. FFT size). Default: <code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.HilbertTransform.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L384-L427"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.HilbertTransform.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Tensor or array-like to transform. Must be real and in shape <code class="docutils literal notranslate"><span class="pre">[Batch,</span> <span class="pre">chns,</span> <span class="pre">spatial1,</span> <span class="pre">spatial2,</span> <span class="pre">...]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Analytical signal of <code class="docutils literal notranslate"><span class="pre">x</span></code>, transformed along axis specified in <code class="docutils literal notranslate"><span class="pre">self.axis</span></code> using
FFT of size <code class="docutils literal notranslate"><span class="pre">self.N</span></code>. The absolute value of <code class="docutils literal notranslate"><span class="pre">x_ht</span></code> relates to the envelope of <code class="docutils literal notranslate"><span class="pre">x</span></code> along axis <code class="docutils literal notranslate"><span class="pre">self.axis</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="affine-transform">
<h3><cite>Affine Transform</cite><a class="headerlink" href="#affine-transform" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.AffineTransform">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">AffineTransform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">bilinear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">zeros</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_indexing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L439-L592"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.AffineTransform" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.AffineTransform.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">bilinear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">zeros</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_indexing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L441-L500"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.AffineTransform.__init__" title="Link to this definition">#</a></dt>
<dd><p>Apply affine transformations with a batch of affine matrices.</p>
<p>When <cite>normalized=False</cite> and <cite>reverse_indexing=True</cite>,
it does the commonly used resampling in the ‘pull’ direction
following the <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.affine_transform</span></code> convention.
In this case <cite>theta</cite> is equivalent to (ndim+1, ndim+1) input <code class="docutils literal notranslate"><span class="pre">matrix</span></code> of <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.affine_transform</span></code>,
operates on homogeneous coordinates.
See also: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.affine_transform.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.affine_transform.html</a></p>
<p>When <cite>normalized=True</cite> and <cite>reverse_indexing=False</cite>,
it applies <cite>theta</cite> to the normalized coordinates (coords. in the range of [-1, 1]) directly.
This is often used with <cite>align_corners=False</cite> to achieve resolution-agnostic resampling,
thus useful as a part of trainable modules such as the spatial transformer networks.
See also: <a class="reference external" href="https://pytorch.org/tutorials/intermediate/spatial_transformer_tutorial.html">https://pytorch.org/tutorials/intermediate/spatial_transformer_tutorial.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – output spatial shape, the full output shape will be
<cite>[N, C, *spatial_size]</cite> where N and C are inferred from the <cite>src</cite> input of <cite>self.forward</cite>.</p></li>
<li><p><strong>normalized</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – indicating whether the provided affine matrix <cite>theta</cite> is defined
for the normalized coordinates. If <cite>normalized=False</cite>, <cite>theta</cite> will be converted
to operate on normalized coordinates as pytorch affine_grid works with the normalized
coordinates.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>}
Interpolation mode to calculate output values. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>.
See also: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html">https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html</a></p></li>
<li><p><strong>padding_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;zeros&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;border&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reflection&quot;</span></code>}
Padding mode for outside grid values. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;zeros&quot;</span></code>.
See also: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html">https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html</a></p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – see also <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html">https://pytorch.org/docs/stable/generated/torch.nn.functional.grid_sample.html</a>.</p></li>
<li><p><strong>reverse_indexing</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to reverse the spatial indexing of image and coordinates.
set to <cite>False</cite> if <cite>theta</cite> follows pytorch’s default “D, H, W” convention.
set to <cite>True</cite> if <cite>theta</cite> follows <cite>scipy.ndimage</cite> default “i, j, k” convention.</p></li>
<li><p><strong>zero_centered</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – whether the affine is applied to coordinates in a zero-centered value range.
With <cite>zero_centered=True</cite>, for example, the center of rotation will be the
spatial center of the input; with <cite>zero_centered=False</cite>, the center of rotation will be the
origin of the input. This option is only available when <cite>normalized=False</cite>,
where the default behaviour is <cite>False</cite> if unspecified.
See also: <a class="reference internal" href="#monai.networks.utils.normalize_transform" title="monai.networks.utils.normalize_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">monai.networks.utils.normalize_transform()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.AffineTransform.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L502-L592"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.AffineTransform.forward" title="Link to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">theta</span></code> must be an affine transformation matrix with shape
3x3 or Nx3x3 or Nx2x3 or 2x3 for spatial 2D transforms,
4x4 or Nx4x4 or Nx3x4 or 3x4 for spatial 3D transforms,
where <cite>N</cite> is the batch size. <cite>theta</cite> will be converted into float Tensor for the computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<em>array_like</em>) – image in spatial 2D or 3D (N, C, spatial_dims),
where N is the batch dim, C is the number of channels.</p></li>
<li><p><strong>theta</strong> (<em>array_like</em>) – Nx3x3, Nx2x3, 3x3, 2x3 for spatial 2D inputs,
Nx4x4, Nx3x4, 3x4, 4x4 for spatial 3D inputs. When the batch dimension is omitted,
<cite>theta</cite> will be repeated N times, N is the batch dim of <cite>src</cite>.</p></li>
<li><p><strong>spatial_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – output spatial shape, the full output shape will be
<cite>[N, C, *spatial_size]</cite> where N and C are inferred from the <cite>src</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">theta</span></code> is not a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">theta</span></code> is not one of [Nxdxd, dxd].</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">theta</span></code> is not one of [Nx3x3, Nx4x4].</p></li>
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">src</span></code> is not a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">src</span></code> spatially is not one of [2D, 3D].</p></li>
<li><p><strong>ValueError</strong> – When affine and image batch dimension differ.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="grid-pull">
<h3><cite>grid_pull</cite><a class="headerlink" href="#grid-pull" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.grid_pull">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">grid_pull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L60-L132"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.grid_pull" title="Link to this definition">#</a></dt>
<dd><p>Sample an image with respect to a deformation field.</p>
<p><cite>interpolation</cite> can be an int, a string or an InterpolationType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">nearest</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;linear&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">linear</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;quadratic&#39;</span>  <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">quadratic</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;cubic&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">cubic</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;fourth&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fourth</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;fifth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fifth</span>
<span class="o">-</span> <span class="mi">6</span> <span class="ow">or</span> <span class="s1">&#39;sixth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">sixth</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;seventh&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">seventh</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order [W, H, D],
to specify dimension-specific interpolation orders.</p>
<p><cite>bound</cite> can be an int, a string or a BoundType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;replicate&#39;</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">replicate</span> <span class="ow">or</span> <span class="s1">&#39;border&#39;</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;dct1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;mirror&#39;</span>       <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct1</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;dct2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;reflect&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct2</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;dst1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antimirror&#39;</span>   <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst1</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;dst2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antireflect&#39;</span>  <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst2</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;dft&#39;</span>       <span class="ow">or</span> <span class="s1">&#39;wrap&#39;</span>         <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dft</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;zero&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;zeros&#39;</span>        <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">zero</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order [W, H, D],
to specify dimension-specific boundary conditions.
<cite>sliding</cite> is a specific condition than only applies to flow fields
(with as many channels as dimensions). It cannot be dimension-specific.
Note that:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dft</cite> corresponds to circular padding</p></li>
<li><p><cite>dct2</cite> corresponds to Neumann boundary conditions (symmetric)</p></li>
<li><p><cite>dst2</cite> corresponds to Dirichlet boundary conditions (antisymmetric)</p></li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_cosine_transform">https://en.wikipedia.org/wiki/Discrete_cosine_transform</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_sine_transform">https://en.wikipedia.org/wiki/Discrete_sine_transform</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.BoundType)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.InterpolationType)</span></code></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Input image. <cite>(B, C, Wi, Hi, Di)</cite>.</p></li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Deformation field. <cite>(B, Wo, Ho, Do, 1|2|3)</cite>.</p></li>
<li><p><strong>interpolation</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>] </em><em>, </em><em>optional</em>) – Interpolation order.
Defaults to <cite>‘linear’</cite>.</p></li>
<li><p><strong>bound</strong> (<em>BoundType</em><em>, or </em><em>list</em><em>[</em><em>BoundType</em><em>]</em><em>, </em><em>optional</em>) – Boundary conditions.
Defaults to <cite>‘zero’</cite>.</p></li>
<li><p><strong>extrapolate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Extrapolate out-of-bound data.
Defaults to <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deformed image <cite>(B, C, Wo, Ho, Do)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="grid-push">
<h3><cite>grid_push</cite><a class="headerlink" href="#grid-push" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.grid_push">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">grid_push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L160-L237"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.grid_push" title="Link to this definition">#</a></dt>
<dd><p>Splat an image with respect to a deformation field (pull adjoint).</p>
<p><cite>interpolation</cite> can be an int, a string or an InterpolationType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">nearest</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;linear&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">linear</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;quadratic&#39;</span>  <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">quadratic</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;cubic&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">cubic</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;fourth&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fourth</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;fifth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fifth</span>
<span class="o">-</span> <span class="mi">6</span> <span class="ow">or</span> <span class="s1">&#39;sixth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">sixth</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;seventh&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">seventh</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order <cite>[W, H, D]</cite>,
to specify dimension-specific interpolation orders.</p>
<p><cite>bound</cite> can be an int, a string or a BoundType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;replicate&#39;</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">replicate</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;dct1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;mirror&#39;</span>       <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct1</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;dct2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;reflect&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct2</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;dst1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antimirror&#39;</span>   <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst1</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;dst2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antireflect&#39;</span>  <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst2</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;dft&#39;</span>       <span class="ow">or</span> <span class="s1">&#39;wrap&#39;</span>         <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dft</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;zero&#39;</span>                        <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">zero</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order <cite>[W, H, D]</cite>,
to specify dimension-specific boundary conditions.
<cite>sliding</cite> is a specific condition than only applies to flow fields
(with as many channels as dimensions). It cannot be dimension-specific.
Note that:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dft</cite> corresponds to circular padding</p></li>
<li><p><cite>dct2</cite> corresponds to Neumann boundary conditions (symmetric)</p></li>
<li><p><cite>dst2</cite> corresponds to Dirichlet boundary conditions (antisymmetric)</p></li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_cosine_transform">https://en.wikipedia.org/wiki/Discrete_cosine_transform</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_sine_transform">https://en.wikipedia.org/wiki/Discrete_sine_transform</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.BoundType)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.InterpolationType)</span></code></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Input image <cite>(B, C, Wi, Hi, Di)</cite>.</p></li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Deformation field <cite>(B, Wi, Hi, Di, 1|2|3)</cite>.</p></li>
<li><p><strong>shape</strong> – Shape of the source image.</p></li>
<li><p><strong>interpolation</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>] </em><em>, </em><em>optional</em>) – Interpolation order.
Defaults to <cite>‘linear’</cite>.</p></li>
<li><p><strong>bound</strong> (<em>BoundType</em><em>, or </em><em>list</em><em>[</em><em>BoundType</em><em>]</em><em>, </em><em>optional</em>) – Boundary conditions.
Defaults to <cite>‘zero’</cite>.</p></li>
<li><p><strong>extrapolate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Extrapolate out-of-bound data.
Defaults to <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Splatted image <cite>(B, C, Wo, Ho, Do)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="grid-count">
<h3><cite>grid_count</cite><a class="headerlink" href="#grid-count" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.grid_count">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">grid_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L261-L337"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.grid_count" title="Link to this definition">#</a></dt>
<dd><p>Splatting weights with respect to a deformation field (pull adjoint).</p>
<p>This function is equivalent to applying grid_push to an image of ones.</p>
<p><cite>interpolation</cite> can be an int, a string or an InterpolationType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">nearest</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;linear&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">linear</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;quadratic&#39;</span>  <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">quadratic</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;cubic&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">cubic</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;fourth&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fourth</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;fifth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fifth</span>
<span class="o">-</span> <span class="mi">6</span> <span class="ow">or</span> <span class="s1">&#39;sixth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">sixth</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;seventh&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">seventh</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order [W, H, D],
to specify dimension-specific interpolation orders.</p>
<p><cite>bound</cite> can be an int, a string or a BoundType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;replicate&#39;</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">replicate</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;dct1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;mirror&#39;</span>       <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct1</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;dct2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;reflect&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct2</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;dst1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antimirror&#39;</span>   <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst1</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;dst2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antireflect&#39;</span>  <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst2</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;dft&#39;</span>       <span class="ow">or</span> <span class="s1">&#39;wrap&#39;</span>         <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dft</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;zero&#39;</span>                        <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">zero</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order [W, H, D],
to specify dimension-specific boundary conditions.
<cite>sliding</cite> is a specific condition than only applies to flow fields
(with as many channels as dimensions). It cannot be dimension-specific.
Note that:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dft</cite> corresponds to circular padding</p></li>
<li><p><cite>dct2</cite> corresponds to Neumann boundary conditions (symmetric)</p></li>
<li><p><cite>dst2</cite> corresponds to Dirichlet boundary conditions (antisymmetric)</p></li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_cosine_transform">https://en.wikipedia.org/wiki/Discrete_cosine_transform</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_sine_transform">https://en.wikipedia.org/wiki/Discrete_sine_transform</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.BoundType)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.InterpolationType)</span></code></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Deformation field <cite>(B, Wi, Hi, Di, 2|3)</cite>.</p></li>
<li><p><strong>shape</strong> – shape of the source image.</p></li>
<li><p><strong>interpolation</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>] </em><em>, </em><em>optional</em>) – Interpolation order.
Defaults to <cite>‘linear’</cite>.</p></li>
<li><p><strong>bound</strong> (<em>BoundType</em><em>, or </em><em>list</em><em>[</em><em>BoundType</em><em>]</em><em>, </em><em>optional</em>) – Boundary conditions.
Defaults to <cite>‘zero’</cite>.</p></li>
<li><p><strong>extrapolate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Extrapolate out-of-bound data.
Defaults to <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Splat weights <cite>(B, 1, Wo, Ho, Do)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="grid-grad">
<h3><cite>grid_grad</cite><a class="headerlink" href="#grid-grad" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.grid_grad">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">grid_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/spatial_transforms.py#L365-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.grid_grad" title="Link to this definition">#</a></dt>
<dd><p>Sample an image with respect to a deformation field.</p>
<p><cite>interpolation</cite> can be an int, a string or an InterpolationType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">nearest</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;linear&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">linear</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;quadratic&#39;</span>  <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">quadratic</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;cubic&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">cubic</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;fourth&#39;</span>     <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fourth</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;fifth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">fifth</span>
<span class="o">-</span> <span class="mi">6</span> <span class="ow">or</span> <span class="s1">&#39;sixth&#39;</span>      <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">sixth</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;seventh&#39;</span>    <span class="ow">or</span> <span class="n">InterpolationType</span><span class="o">.</span><span class="n">seventh</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order [W, H, D],
to specify dimension-specific interpolation orders.</p>
<p><cite>bound</cite> can be an int, a string or a BoundType.
Possible values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s1">&#39;replicate&#39;</span> <span class="ow">or</span> <span class="s1">&#39;nearest&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">replicate</span>
<span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="s1">&#39;dct1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;mirror&#39;</span>       <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct1</span>
<span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s1">&#39;dct2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;reflect&#39;</span>      <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dct2</span>
<span class="o">-</span> <span class="mi">3</span> <span class="ow">or</span> <span class="s1">&#39;dst1&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antimirror&#39;</span>   <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst1</span>
<span class="o">-</span> <span class="mi">4</span> <span class="ow">or</span> <span class="s1">&#39;dst2&#39;</span>      <span class="ow">or</span> <span class="s1">&#39;antireflect&#39;</span>  <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dst2</span>
<span class="o">-</span> <span class="mi">5</span> <span class="ow">or</span> <span class="s1">&#39;dft&#39;</span>       <span class="ow">or</span> <span class="s1">&#39;wrap&#39;</span>         <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">dft</span>
<span class="o">-</span> <span class="mi">7</span> <span class="ow">or</span> <span class="s1">&#39;zero&#39;</span>                        <span class="ow">or</span> <span class="n">BoundType</span><span class="o">.</span><span class="n">zero</span>
</pre></div>
</div>
<p>A list of values can be provided, in the order [W, H, D],
to specify dimension-specific boundary conditions.
<cite>sliding</cite> is a specific condition than only applies to flow fields
(with as many channels as dimensions). It cannot be dimension-specific.
Note that:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dft</cite> corresponds to circular padding</p></li>
<li><p><cite>dct2</cite> corresponds to Neumann boundary conditions (symmetric)</p></li>
<li><p><cite>dst2</cite> corresponds to Dirichlet boundary conditions (antisymmetric)</p></li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_cosine_transform">https://en.wikipedia.org/wiki/Discrete_cosine_transform</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Discrete_sine_transform">https://en.wikipedia.org/wiki/Discrete_sine_transform</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.BoundType)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">help(monai._C.InterpolationType)</span></code></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Input image. <cite>(B, C, Wi, Hi, Di)</cite>.</p></li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Deformation field. <cite>(B, Wo, Ho, Do, 2|3)</cite>.</p></li>
<li><p><strong>interpolation</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>] </em><em>, </em><em>optional</em>) – Interpolation order.
Defaults to <cite>‘linear’</cite>.</p></li>
<li><p><strong>bound</strong> (<em>BoundType</em><em>, or </em><em>list</em><em>[</em><em>BoundType</em><em>]</em><em>, </em><em>optional</em>) – Boundary conditions.
Defaults to <cite>‘zero’</cite>.</p></li>
<li><p><strong>extrapolate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Extrapolate out-of-bound data. Defaults to <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled gradients (B, C, Wo, Ho, Do, 1|2|3).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="lltm">
<h3><cite>LLTM</cite><a class="headerlink" href="#lltm" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.LLTM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">LLTM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_size</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L617-L646"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LLTM" title="Link to this definition">#</a></dt>
<dd><p>This recurrent unit is similar to an LSTM, but differs in that it lacks a forget
gate and uses an Exponential Linear Unit (ELU) as its internal activation function.
Because this unit never forgets, call it LLTM, or Long-Long-Term-Memory unit.
It has both C++ and CUDA implementation, automatically switch according to the
target device where put this module to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – size of input feature data</p></li>
<li><p><strong>state_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – size of the state of recurrent unit</p></li>
</ul>
</dd>
</dl>
<p>Referring to: <a class="reference external" href="https://pytorch.org/tutorials/advanced/cpp_extension.html">https://pytorch.org/tutorials/advanced/cpp_extension.html</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.LLTM.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/simplelayers.py#L645-L646"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.LLTM.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="conjugategradient">
<h3><cite>ConjugateGradient</cite><a class="headerlink" href="#conjugategradient" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.layers.ConjugateGradient">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.layers.</span></span><span class="sig-name descname"><span class="pre">ConjugateGradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linear_op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/conjugate_gradient.py#L42-L112"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ConjugateGradient" title="Link to this definition">#</a></dt>
<dd><p>Congugate Gradient (CG) solver for linear systems Ax = y.</p>
<p>For linear_op that is positive definite and self-adjoint, CG is
guaranteed to converge CG is often used to solve linear systems of the form
Ax = y, where A is too large to store explicitly, but can be computed via a
linear operator.</p>
<p>As a result, here we won’t set A explicitly as a matrix, but rather as a
linear operator. For example, A could be a FFT/IFFT operation</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.ConjugateGradient.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linear_op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/conjugate_gradient.py#L55-L64"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ConjugateGradient.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linear_op</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>) – Linear operator</p></li>
<li><p><strong>num_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of iterations to run CG</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.ConjugateGradient.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/conjugate_gradient.py#L87-L112"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ConjugateGradient.forward" title="Link to this definition">#</a></dt>
<dd><p>run conjugate gradient for num_iter iterations to solve Ax = y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – tensor (real or complex); Initial guess for linear system Ax = y.</p></li>
<li><p><strong>For</strong> (<em>The size</em><em> of </em><em>x should be applicable to the linear operator.</em>)</p></li>
<li><p><strong>example</strong></p></li>
<li><p><strong>FFT</strong> (<em>if the linear operator is</em>)</p></li>
<li><p><strong>the</strong> (<em>then x is HCHW; if</em>)</p></li>
<li><p><strong>multiplication</strong> (<em>linear operator is a matrix</em>)</p></li>
<li><p><strong>vector</strong> (<em>then x is a</em>)</p></li>
<li><p><strong>y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – tensor (real or complex); Measurement. Same size as x</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Solution to Ax = y</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.layers.ConjugateGradient.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsold</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/conjugate_gradient.py#L66-L85"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.ConjugateGradient.update" title="Link to this definition">#</a></dt>
<dd><p>perform one iteration of the CG method. It takes the current solution x,
the current search direction p, the current residual r, and the old
residual norm rsold as inputs. Then it computes the new solution, search
direction, residual, and residual norm, and returns them.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-monai.networks.layers.convutils">
<span id="utilities"></span><h3><cite>Utilities</cite><a class="headerlink" href="#module-monai.networks.layers.convutils" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.convutils.calculate_out_shape">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.convutils.</span></span><span class="sig-name descname"><span class="pre">calculate_out_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/convutils.py#L56-L75"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.convutils.calculate_out_shape" title="Link to this definition">#</a></dt>
<dd><p>Calculate the output tensor shape when applying a convolution to a tensor of shape <cite>inShape</cite> with kernel size
<cite>kernel_size</cite>, stride value <cite>stride</cite>, and input padding value <cite>padding</cite>. All arguments can be scalars or multiple
values, return value is a scalar if all inputs are scalars.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, …], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.convutils.gaussian_1d">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.convutils.</span></span><span class="sig-name descname"><span class="pre">gaussian_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'erf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/convutils.py#L78-L131"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.convutils.gaussian_1d" title="Link to this definition">#</a></dt>
<dd><p>one dimensional Gaussian kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – std of the kernel</p></li>
<li><p><strong>truncated</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – tail length</p></li>
<li><p><strong>approx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>discrete Gaussian kernel type, available options are “erf”, “sampled”, and “scalespace”.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">erf</span></code> approximation interpolates the error function;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampled</span></code> uses a sampled Gaussian kernel;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scalespace</span></code> corresponds to
<a class="reference external" href="https://en.wikipedia.org/wiki/Scale_space_implementation#The_discrete_Gaussian_kernel">https://en.wikipedia.org/wiki/Scale_space_implementation#The_discrete_Gaussian_kernel</a>
based on the modified Bessel functions.</p></li>
</ul>
</p></li>
<li><p><strong>normalize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to normalize the kernel with <cite>kernel.sum()</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">truncated</span></code> is non-positive.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D torch tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.convutils.polyval">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.convutils.</span></span><span class="sig-name descname"><span class="pre">polyval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/convutils.py#L134-L157"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.convutils.polyval" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the polynomial defined by <cite>coef</cite> at <cite>x</cite>.</p>
<p>For a 1D sequence of coef (length n), evaluate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">coef</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef</strong> – a sequence of floats representing the coefficients of the polynomial</p></li>
<li><p><strong>x</strong> – float or a sequence of floats representing the variable of the polynomial</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D torch tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.convutils.same_padding">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.convutils.</span></span><span class="sig-name descname"><span class="pre">same_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/convutils.py#L22-L43"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.convutils.same_padding" title="Link to this definition">#</a></dt>
<dd><p>Return the padding value needed to ensure a convolution using the given kernel size produces an output of the same
shape as the input for a stride of 1, otherwise ensure a shape of the input divided by the stride rounded down.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – When <code class="docutils literal notranslate"><span class="pre">np.any((kernel_size</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">dilation</span> <span class="pre">%</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">1)</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, …], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-monai.networks.layers.utils">
<dt class="sig sig-object py" id="monai.networks.layers.utils.get_act_layer">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.utils.</span></span><span class="sig-name descname"><span class="pre">get_act_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/utils.py#L55-L75"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.utils.get_act_layer" title="Link to this definition">#</a></dt>
<dd><p>Create an activation layer instance.</p>
<p>For example, to create activation layers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_act_layer</span>

<span class="n">s_layer</span> <span class="o">=</span> <span class="n">get_act_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;swish&quot;</span><span class="p">)</span>
<span class="n">p_layer</span> <span class="o">=</span> <span class="n">get_act_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;prelu&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_parameters&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – an activation type string or a tuple of type string and parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.utils.get_dropout_layer">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.utils.</span></span><span class="sig-name descname"><span class="pre">get_dropout_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/utils.py#L78-L104"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.utils.get_dropout_layer" title="Link to this definition">#</a></dt>
<dd><p>Create a dropout layer instance.</p>
<p>For example, to create dropout layers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_dropout_layer</span>

<span class="n">d_layer</span> <span class="o">=</span> <span class="n">get_dropout_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;dropout&quot;</span><span class="p">)</span>
<span class="n">a_layer</span> <span class="o">=</span> <span class="n">get_dropout_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;alphadropout&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – a dropout ratio or a tuple of dropout type and parameters.</p></li>
<li><p><strong>dropout_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the spatial dimension of the dropout operation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.utils.get_norm_layer">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.utils.</span></span><span class="sig-name descname"><span class="pre">get_norm_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/utils.py#L24-L52"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.utils.get_norm_layer" title="Link to this definition">#</a></dt>
<dd><p>Create a normalization layer instance.</p>
<p>For example, to create normalization layers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_norm_layer</span>

<span class="n">g_layer</span> <span class="o">=</span> <span class="n">get_norm_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_groups&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="n">n_layer</span> <span class="o">=</span> <span class="n">get_norm_layer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;instance&quot;</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – a normalization type string or a tuple of type string and parameters.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of spatial dimensions of the input.</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of features/channels when the normalization layer requires this parameter
but it is not specified in the norm parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.layers.utils.get_pool_layer">
<span class="sig-prename descclassname"><span class="pre">monai.networks.layers.utils.</span></span><span class="sig-name descname"><span class="pre">get_pool_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/layers/utils.py#L107-L128"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.layers.utils.get_pool_layer" title="Link to this definition">#</a></dt>
<dd><p>Create a pooling layer instance.</p>
<p>For example, to create adaptiveavg layer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_pool_layer</span>

<span class="n">pool_layer</span> <span class="o">=</span> <span class="n">get_pool_layer</span><span class="p">((</span><span class="s2">&quot;adaptiveavg&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;output_size&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}),</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – a pooling type string or a tuple of type string and parameters.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of spatial dimensions of the input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="nets">
<h2>Nets<a class="headerlink" href="#nets" title="Link to this heading">#</a></h2>
<section id="ahnet">
<h3><cite>AHNet</cite><a class="headerlink" href="#ahnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.AHNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">AHNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psp_block_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transpose'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/ahnet.py#L303-L534"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.AHNet" title="Link to this definition">#</a></dt>
<dd><p>AHNet based on <a class="reference external" href="https://arxiv.org/pdf/1711.08580.pdf">Anisotropic Hybrid Network</a>.
Adapted from <a class="reference external" href="https://github.com/lsqshr/AH-Net/blob/master/net3d.py">lsqshr’s official code</a>.
Except from the original network that supports 3D inputs, this implementation also supports 2D inputs.
According to the <a class="reference external" href="https://github.com/Project-MONAI/MONAI/issues/1023">tests for deconvolutions</a>, using
<code class="docutils literal notranslate"><span class="pre">&quot;transpose&quot;</span></code> rather than linear interpolations is faster. Therefore, this implementation sets <code class="docutils literal notranslate"><span class="pre">&quot;transpose&quot;</span></code>
as the default upsampling method.</p>
<p>To meet the requirements of the structure, the input size for each spatial dimension
(except the last one) should be: divisible by 2 ** (psp_block_num + 3) and no less than 32 in <code class="docutils literal notranslate"><span class="pre">transpose</span></code> mode,
and should be divisible by 32 and no less than 2 ** (psp_block_num + 3) in other upsample modes.
In addition, the input size for the last spatial dimension should be divisible by 32, and at least one spatial size
should be no less than 64.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of residual blocks for 4 layers of the network (layer1…layer4). Defaults to <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data. Defaults to 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for the network. Default to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for the network. Defaults to 1.</p></li>
<li><p><strong>psp_block_num</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the number of pyramid volumetric pooling modules used at the end of the network before the final
output layer for extracting multiscale features. The number should be an integer that belongs to [0,4]. Defaults
to 4.</p></li>
<li><p><strong>upsample_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>[<code class="docutils literal notranslate"><span class="pre">&quot;transpose&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;trilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">nearest</span></code>]
The mode of upsampling manipulations.
Using the last two modes cannot guarantee the model’s reproducibility. Defaults to <code class="docutils literal notranslate"><span class="pre">transpose</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;transpose&quot;</span></code>, uses transposed convolution layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, uses bilinear interpolate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;trilinear&quot;</span></code>, uses trilinear interpolate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, uses nearest interpolate.</p></li>
</ul>
</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to load pretrained weights from ResNet50 to initialize convolution layers, default to False.</p></li>
<li><p><strong>progress</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, displays a progress bar of the download of pretrained weights to stderr.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.AHNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/ahnet.py#L471-L504"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.AHNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="densenet">
<h3><cite>DenseNet</cite><a class="headerlink" href="#densenet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DenseNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DenseNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">12,</span> <span class="pre">24,</span> <span class="pre">16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/densenet.py#L152-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DenseNet" title="Link to this definition">#</a></dt>
<dd><p>Densenet based on: <a class="reference external" href="https://arxiv.org/pdf/1608.06993.pdf">Densely Connected Convolutional Networks</a>.
Adapted from PyTorch Hub 2D version: <a class="reference external" href="https://pytorch.org/vision/stable/models.html#id16">https://pytorch.org/vision/stable/models.html#id16</a>.
This network is non-deterministic When <cite>spatial_dims</cite> is 3 and CUDA is enabled. Please check the link below
for more details:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms">https://pytorch.org/docs/stable/generated/torch.use_deterministic_algorithms.html#torch.use_deterministic_algorithms</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of the input channel.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of the output classes.</p></li>
<li><p><strong>init_features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of filters in the first convolution layer.</p></li>
<li><p><strong>growth_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – how many filters to add each layer (k in paper).</p></li>
<li><p><strong>block_config</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – how many layers in each pooling block.</p></li>
<li><p><strong>bn_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – multiplicative factor for number of bottle neck layers.
(i.e. bn_size * k features in the bottleneck layer)</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to relu.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments. Defaults to batch norm.</p></li>
<li><p><strong>dropout_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout rate after each dense layer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.DenseNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/densenet.py#L253-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DenseNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="densenet121">
<h3><cite>DenseNet121</cite><a class="headerlink" href="#densenet121" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DenseNet121">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DenseNet121</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">12,</span> <span class="pre">24,</span> <span class="pre">16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/densenet.py#L296-L326"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DenseNet121" title="Link to this definition">#</a></dt>
<dd><p>DenseNet121 with optional pretrained support when <cite>spatial_dims</cite> is 2.</p>
</dd></dl>

</section>
<section id="densenet169">
<h3><cite>DenseNet169</cite><a class="headerlink" href="#densenet169" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DenseNet169">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DenseNet169</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">12,</span> <span class="pre">32,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/densenet.py#L329-L359"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DenseNet169" title="Link to this definition">#</a></dt>
<dd><p>DenseNet169 with optional pretrained support when <cite>spatial_dims</cite> is 2.</p>
</dd></dl>

</section>
<section id="densenet201">
<h3><cite>DenseNet201</cite><a class="headerlink" href="#densenet201" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DenseNet201">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DenseNet201</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">12,</span> <span class="pre">48,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/densenet.py#L362-L392"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DenseNet201" title="Link to this definition">#</a></dt>
<dd><p>DenseNet201 with optional pretrained support when <cite>spatial_dims</cite> is 2.</p>
</dd></dl>

</section>
<section id="densenet264">
<h3><cite>DenseNet264</cite><a class="headerlink" href="#densenet264" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DenseNet264">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DenseNet264</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">12,</span> <span class="pre">64,</span> <span class="pre">48)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/densenet.py#L395-L420"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DenseNet264" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="efficientnet">
<h3><cite>EfficientNet</cite><a class="headerlink" href="#efficientnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">EfficientNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks_args_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">224</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_connect_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L230-L475"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNet" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks_args_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">224</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_connect_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L232-L408"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNet.__init__" title="Link to this definition">#</a></dt>
<dd><p>EfficientNet based on <a class="reference external" href="https://arxiv.org/pdf/1905.11946.pdf">Rethinking Model Scaling for Convolutional Neural Networks</a>.
Adapted from <a class="reference external" href="https://github.com/lukemelas/EfficientNet-PyTorch">EfficientNet-PyTorch</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks_args_str</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – block definitions.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output classes.</p></li>
<li><p><strong>width_coefficient</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – width multiplier coefficient (w in paper).</p></li>
<li><p><strong>depth_coefficient</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – depth multiplier coefficient (d in paper).</p></li>
<li><p><strong>dropout_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout rate for dropout layers.</p></li>
<li><p><strong>image_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – input image resolution.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>drop_connect_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropconnect rate for drop connection (individual weights) layers.</p></li>
<li><p><strong>depth_divisor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – depth divisor for channel rounding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L425-L449"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNet.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input should have spatially N dimensions</p></li>
<li><p><strong>``</strong> (<em>Batch</em><em>, </em><em>in_channels</em><em>, </em><em>dim_0</em><em>[</em><em>, </em><em>dim_1</em><em>, </em><em>...</em><em>, </em><em>dim_N</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a torch Tensor of classification prediction in shape <code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">num_classes)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNet.set_swish">
<span class="sig-name descname"><span class="pre">set_swish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory_efficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L410-L423"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNet.set_swish" title="Link to this definition">#</a></dt>
<dd><p>Sets swish function as memory efficient (for training) or standard (for JIT export).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>memory_efficient</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use memory-efficient version of swish.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="blockargs">
<h3><cite>BlockArgs</cite><a class="headerlink" href="#blockargs" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">BlockArgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_repeat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L944-L1015"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BlockArgs" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>BlockArgs object to assist in decoding string notation</dt><dd><p>of arguments for MBConvBlock definition.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.expand_ratio">
<span class="sig-name descname"><span class="pre">expand_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.expand_ratio" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.from_string">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_string</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L959-L997"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BlockArgs.from_string" title="Link to this definition">#</a></dt>
<dd><p>Get a BlockArgs object from a string notation of arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>block_string</strong> (<em>str</em>) – A string notation of arguments.
Examples: “r1_k3_s11_e1_i32_o16_se0.25”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>namedtuple defined at the top of this function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#monai.networks.nets.BlockArgs" title="monai.networks.nets.BlockArgs">BlockArgs</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.id_skip">
<span class="sig-name descname"><span class="pre">id_skip</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.id_skip" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.input_filters">
<span class="sig-name descname"><span class="pre">input_filters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.input_filters" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.kernel_size">
<span class="sig-name descname"><span class="pre">kernel_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.kernel_size" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.num_repeat">
<span class="sig-name descname"><span class="pre">num_repeat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.num_repeat" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.output_filters">
<span class="sig-name descname"><span class="pre">output_filters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.output_filters" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.se_ratio">
<span class="sig-name descname"><span class="pre">se_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.se_ratio" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.stride">
<span class="sig-name descname"><span class="pre">stride</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#monai.networks.nets.BlockArgs.stride" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.BlockArgs.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L999-L1015"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BlockArgs.to_string" title="Link to this definition">#</a></dt>
<dd><p>Return a block string notation for current BlockArgs object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A string notation of BlockArgs object arguments.</dt><dd><p>Example: “r1_k3_s11_e1_i32_o16_se0.25_noskip”.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="efficientnetbn">
<h3><cite>EfficientNetBN</cite><a class="headerlink" href="#efficientnetbn" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNetBN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">EfficientNetBN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L478-L562"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNetBN" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNetBN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L480-L562"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNetBN.__init__" title="Link to this definition">#</a></dt>
<dd><p>Generic wrapper around EfficientNet, used to initialize EfficientNet-B0 to EfficientNet-B7 models
model_name is mandatory argument as there is no EfficientNetBN itself,
it needs the N in [0, 1, 2, 3, 4, 5, 6, 7, 8] to be a model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – name of model to initialize, can be from [efficientnet-b0, …, efficientnet-b8, efficientnet-l2].</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to initialize pretrained ImageNet weights, only available for spatial_dims=2 and batch
norm is used.</p></li>
<li><p><strong>progress</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to show download progress for pretrained weights download.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output classes.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>adv_prop</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use weights trained with adversarial examples.
This argument only works when <cite>pretrained</cite> is <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for pretrained spatial 2D ImageNet</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">image_size</span> <span class="o">=</span> <span class="n">get_efficientnet_image_size</span><span class="p">(</span><span class="s2">&quot;efficientnet-b0&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="n">image_size</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">EfficientNetBN</span><span class="p">(</span><span class="s2">&quot;efficientnet-b0&quot;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

<span class="c1"># create spatial 2D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">EfficientNetBN</span><span class="p">(</span><span class="s2">&quot;efficientnet-b0&quot;</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># create spatial 3D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">EfficientNetBN</span><span class="p">(</span><span class="s2">&quot;efficientnet-b0&quot;</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># create EfficientNetB7 for spatial 2D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">EfficientNetBN</span><span class="p">(</span><span class="s2">&quot;efficientnet-b7&quot;</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="efficientnetbnfeatures">
<h3><cite>EfficientNetBNFeatures</cite><a class="headerlink" href="#efficientnetbnfeatures" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNetBNFeatures">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">EfficientNetBNFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L565-L642"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNetBNFeatures" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNetBNFeatures.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adv_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L567-L620"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNetBNFeatures.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize EfficientNet-B0 to EfficientNet-B7 models as a backbone, the backbone can
be used as an encoder for segmentation and objection models.
Compared with the class <cite>EfficientNetBN</cite>, the only different place is the forward function.</p>
<p>This class refers to <a class="reference external" href="https://github.com/rwightman/pytorch-image-models">PyTorch image models</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.EfficientNetBNFeatures.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/efficientnet.py#L622-L642"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.EfficientNetBNFeatures.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input should have spatially N dimensions</p></li>
<li><p><strong>``</strong> (<em>Batch</em><em>, </em><em>in_channels</em><em>, </em><em>dim_0</em><em>[</em><em>, </em><em>dim_1</em><em>, </em><em>...</em><em>, </em><em>dim_N</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of torch Tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="segresnet">
<h3><cite>SegResNet</cite><a class="headerlink" href="#segresnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SegResNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('RELU',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('GROUP',</span> <span class="pre">{'num_groups':</span> <span class="pre">8})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_conv_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nontrainable</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet.py#L29-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNet" title="Link to this definition">#</a></dt>
<dd><p>SegResNet based on <a class="reference external" href="https://arxiv.org/pdf/1810.11654.pdf">3D MRI brain tumor segmentation using autoencoder regularization</a>.
The module does not include the variational autoencoder (VAE).
The model supports 2D or 3D inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data. Defaults to 3.</p></li>
<li><p><strong>init_filters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for initial convolution layer. Defaults to 8.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for the network. Defaults to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for the network. Defaults to 2.</p></li>
<li><p><strong>dropout_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – probability of an element to be zero-ed. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">RELU</span></code>.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">GROUP</span></code>.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – deprecating option for feature normalization type.</p></li>
<li><p><strong>num_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – deprecating option for group norm. parameters.</p></li>
<li><p><strong>use_conv_final</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if add a final convolution block to output. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>blocks_down</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of down sample blocks in each layer. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,2,2,4]</span></code>.</p></li>
<li><p><strong>blocks_up</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of up sample blocks in each layer. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,1,1]</span></code>.</p></li>
<li><p><strong>upsample_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.UpsampleMode" title="monai.utils.enums.UpsampleMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpsampleMode</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>[<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>]
The mode of upsampling manipulations.
Using the <code class="docutils literal notranslate"><span class="pre">nontrainable</span></code> modes cannot guarantee the model’s reproducibility. Defaults to``nontrainable``.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">deconv</span></code>, uses transposed convolution layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nontrainable</span></code>, uses non-trainable <cite>linear</cite> interpolation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pixelshuffle</span></code>, uses <a class="reference internal" href="#monai.networks.blocks.SubpixelUpsample" title="monai.networks.blocks.SubpixelUpsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.SubpixelUpsample</span></code></a>.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet.py#L179-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="segresnetds">
<h3><cite>SegResNetDS</cite><a class="headerlink" href="#segresnetds" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SegResNetDS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsdepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L235-L428"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS" title="Link to this definition">#</a></dt>
<dd><p>SegResNetDS based on <a class="reference external" href="https://arxiv.org/pdf/1810.11654.pdf">3D MRI brain tumor segmentation using autoencoder regularization</a>.
It is similar to <a class="reference external" href="https://docs.monai.io/en/stable/networks.html#segresnet">https://docs.monai.io/en/stable/networks.html#segresnet</a>, with several
improvements including deep supervision and non-isotropic kernel support.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data. Defaults to 3.</p></li>
<li><p><strong>init_filters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for initial convolution layer. Defaults to 32.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for the network. Defaults to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for the network. Defaults to 2.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">RELU</span></code>.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">BATCH</span></code>.</p></li>
<li><p><strong>blocks_down</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of downsample blocks in each layer. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,2,2,4]</span></code>.</p></li>
<li><p><strong>blocks_up</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of upsample blocks (optional).</p></li>
<li><p><strong>dsdepth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of levels for deep supervision. This will be the length of the list of outputs at each scale level.
At dsdepth==1,only a single output is returned.</p></li>
<li><p><strong>preprocess</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional callable function to apply before the model’s forward pass</p></li>
<li><p><strong>resolution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional input image resolution. When provided, the network will first use non-isotropic kernels to bring
image spacing into an approximately isotropic space.
Otherwise, by default, the kernel size and downsampling is always isotropic.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L427-L428"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS.is_valid_shape">
<span class="sig-name descname"><span class="pre">is_valid_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L384-L389"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS.is_valid_shape" title="Link to this definition">#</a></dt>
<dd><p>Calculate if the input shape is divisible by the minimum factors for the current network configuration</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS.shape_factor">
<span class="sig-name descname"><span class="pre">shape_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L374-L382"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS.shape_factor" title="Link to this definition">#</a></dt>
<dd><p>Calculate the factors (divisors) that the input image shape must be divisible by</p>
</dd></dl>

</dd></dl>

</section>
<section id="segresnetds2">
<h3><cite>SegResNetDS2</cite><a class="headerlink" href="#segresnetds2" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS2">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SegResNetDS2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsdepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L431-L556"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS2" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>SegResNetDS2 adds an additional decorder branch to SegResNetDS and is the image encoder of VISTA3D</dt><dd><p>&lt;<a class="reference external" href="https://arxiv.org/abs/2406.05285">https://arxiv.org/abs/2406.05285</a>&gt;`_.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data. Defaults to 3.</p></li>
<li><p><strong>init_filters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for initial convolution layer. Defaults to 32.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for the network. Defaults to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for the network. Defaults to 2.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">RELU</span></code>.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">BATCH</span></code>.</p></li>
<li><p><strong>blocks_down</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of downsample blocks in each layer. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,2,2,4]</span></code>.</p></li>
<li><p><strong>blocks_up</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of upsample blocks (optional).</p></li>
<li><p><strong>dsdepth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of levels for deep supervision. This will be the length of the list of outputs at each scale level.
At dsdepth==1,only a single output is returned.</p></li>
<li><p><strong>preprocess</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional callable function to apply before the model’s forward pass</p></li>
<li><p><strong>resolution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional input image resolution. When provided, the network will first use non-isotropic kernels to bring
image spacing into an approximately isotropic space.
Otherwise, by default, the kernel size and downsampling is always isotropic.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L486-L541"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS2.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input tensor.</p></li>
<li><p><strong>with_point</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if true, return the point branch output.</p></li>
<li><p><strong>with_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if true, return the label branch output.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]], <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetDS2.set_auto_grad">
<span class="sig-name descname"><span class="pre">set_auto_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auto_freeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_freeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet_ds.py#L543-L556"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetDS2.set_auto_grad" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>auto_freeze</strong> – if true, freeze the image encoder and the auto-branch.</p></li>
<li><p><strong>point_freeze</strong> – if true, freeze the image encoder and the point-branch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="segresnetvae">
<h3><cite>SegResNetVAE</cite><a class="headerlink" href="#segresnetvae" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetVAE">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SegResNetVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_image_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vae_estimate_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vae_default_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vae_nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('RELU',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('GROUP',</span> <span class="pre">{'num_groups':</span> <span class="pre">8})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_conv_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">2,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nontrainable</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet.py#L187-L338"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetVAE" title="Link to this definition">#</a></dt>
<dd><p>SegResNetVAE based on <a class="reference external" href="https://arxiv.org/pdf/1810.11654.pdf">3D MRI brain tumor segmentation using autoencoder regularization</a>.
The module contains the variational autoencoder (VAE).
The model supports 2D or 3D inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_image_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the size of images to input into the network. It is used to
determine the in_features of the fc layer in VAE.</p></li>
<li><p><strong>vae_estimate_std</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to estimate the standard deviations in VAE. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>vae_default_std</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – if not to estimate the std, use the default value. Defaults to 0.3.</p></li>
<li><p><strong>vae_nz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of latent variables in VAE. Defaults to 256.
Where, 128 to represent mean, and 128 to represent std.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data. Defaults to 3.</p></li>
<li><p><strong>init_filters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for initial convolution layer. Defaults to 8.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for the network. Defaults to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for the network. Defaults to 2.</p></li>
<li><p><strong>dropout_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – probability of an element to be zero-ed. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">RELU</span></code>.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">GROUP</span></code>.</p></li>
<li><p><strong>use_conv_final</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if add a final convolution block to output. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>blocks_down</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of down sample blocks in each layer. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,2,2,4]</span></code>.</p></li>
<li><p><strong>blocks_up</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of up sample blocks in each layer. Defaults to <code class="docutils literal notranslate"><span class="pre">[1,1,1]</span></code>.</p></li>
<li><p><strong>upsample_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.UpsampleMode" title="monai.utils.enums.UpsampleMode"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpsampleMode</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>[<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>]
The mode of upsampling manipulations.
Using the <code class="docutils literal notranslate"><span class="pre">nontrainable</span></code> modes cannot guarantee the model’s reproducibility. Defaults to``nontrainable``.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">deconv</span></code>, uses transposed convolution layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nontrainable</span></code>, uses non-trainable <cite>linear</cite> interpolation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pixelshuffle</span></code>, uses <a class="reference internal" href="#monai.networks.blocks.SubpixelUpsample" title="monai.networks.blocks.SubpixelUpsample"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.SubpixelUpsample</span></code></a>.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SegResNetVAE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/segresnet.py#L326-L338"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SegResNetVAE.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="resnet">
<h3><cite>ResNet</cite><a class="headerlink" href="#resnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.ResNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">ResNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_inplanes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv1_t_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv1_t_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_max_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortcut_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widen_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed_forward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/resnet.py#L187-L364"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ResNet" title="Link to this definition">#</a></dt>
<dd><p>ResNet based on: <a class="reference external" href="https://arxiv.org/pdf/1512.03385.pdf">Deep Residual Learning for Image Recognition</a>
and <a class="reference external" href="https://arxiv.org/pdf/1711.09577.pdf">Can Spatiotemporal 3D CNNs Retrace the History of 2D CNNs and ImageNet?</a>.
Adapted from <a class="github reference external" href="https://github.com/kenshohara/3D-ResNets-PyTorch/tree/master/models">kenshohara/3D-ResNets-PyTorch</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ResNetBlock</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ResNetBottleneck</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – which ResNet block to use, either Basic or Bottleneck.
ResNet block class or str.
for Basic: ResNetBlock or ‘basic’
for Bottleneck: ResNetBottleneck or ‘bottleneck’</p></li>
<li><p><strong>layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – how many layers to use.</p></li>
<li><p><strong>block_inplanes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – determine the size of planes at each step. Also tunable with widen_factor.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>n_input_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for first convolutional layer.</p></li>
<li><p><strong>conv1_t_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – size of first convolution layer, determines kernel and padding.</p></li>
<li><p><strong>conv1_t_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – stride of first convolution layer.</p></li>
<li><p><strong>no_max_pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – bool argument to determine if to use maxpool layer.</p></li>
<li><p><strong>shortcut_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – which downsample block to use. Options are ‘A’, ‘B’, default to ‘B’.
- ‘A’: using <cite>self._downsample_basic_block</cite>.
- ‘B’: kernel_size 1 conv + norm.</p></li>
<li><p><strong>widen_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – widen output for each layer.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output (classifications).</p></li>
<li><p><strong>feed_forward</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to add the FC layer for the output, default to <cite>True</cite>.</p></li>
<li><p><strong>bias_downsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use bias term in the downsampling block when <cite>shortcut_type</cite> is ‘B’, default to <cite>True</cite>.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to relu.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments. Defaults to batch norm.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ResNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/resnet.py#L346-L364"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ResNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="resnetfeatures">
<h3><cite>ResNetFeatures</cite><a class="headerlink" href="#resnetfeatures" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.ResNetFeatures">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">ResNetFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/resnet.py#L367-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ResNetFeatures" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ResNetFeatures.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/resnet.py#L369-L403"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ResNetFeatures.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize resnet18 to resnet200 models as a backbone, the backbone can be used as an encoder for
segmentation and objection models.</p>
<p>Compared with the class <cite>ResNet</cite>, the only different place is the forward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – name of model to initialize, can be from [resnet10, …, resnet200].</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to initialize pretrained MedicalNet weights,
only available for spatial_dims=3 and in_channels=1.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for first convolutional layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ResNetFeatures.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/resnet.py#L405-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ResNetFeatures.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input should have spatially N dimensions</p></li>
<li><p><strong>``</strong> (<em>Batch</em><em>, </em><em>in_channels</em><em>, </em><em>dim_0</em><em>[</em><em>, </em><em>dim_1</em><em>, </em><em>...</em><em>, </em><em>dim_N</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of torch Tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="senet">
<h3><cite>SENet</cite><a class="headerlink" href="#senet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SENet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SENet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_3x3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L50-L282"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SENet" title="Link to this definition">#</a></dt>
<dd><p>SENet based on <a class="reference external" href="https://arxiv.org/pdf/1709.01507.pdf">Squeeze-and-Excitation Networks</a>.
Adapted from <a class="reference external" href="https://github.com/Cadene/pretrained-models.pytorch/blob/master/pretrainedmodels/models/senet.py">Cadene Hub 2D version</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – channel number of the input data.</p></li>
<li><p><strong>block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="#monai.networks.blocks.SEBottleneck" title="monai.networks.blocks.squeeze_and_excitation.SEBottleneck"><code class="xref py py-class docutils literal notranslate"><span class="pre">SEBottleneck</span></code></a>, <a class="reference internal" href="#monai.networks.blocks.SEResNetBottleneck" title="monai.networks.blocks.squeeze_and_excitation.SEResNetBottleneck"><code class="xref py py-class docutils literal notranslate"><span class="pre">SEResNetBottleneck</span></code></a>, <a class="reference internal" href="#monai.networks.blocks.SEResNeXtBottleneck" title="monai.networks.blocks.squeeze_and_excitation.SEResNeXtBottleneck"><code class="xref py py-class docutils literal notranslate"><span class="pre">SEResNeXtBottleneck</span></code></a>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – SEBlock class or str.
for SENet154: SEBottleneck or ‘se_bottleneck’
for SE-ResNet models: SEResNetBottleneck or ‘se_resnet_bottleneck’
for SE-ResNeXt models:  SEResNeXtBottleneck or ‘se_resnetxt_bottleneck’</p></li>
<li><p><strong>layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of residual blocks for 4 layers of the network (layer1…layer4).</p></li>
<li><p><strong>groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of groups for the 3x3 convolution in each bottleneck block.
for SENet154: 64
for SE-ResNet models: 1
for SE-ResNeXt models:  32</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – reduction ratio for Squeeze-and-Excitation modules.
for all models: 16</p></li>
<li><p><strong>dropout_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – drop probability for the Dropout layer.
if <cite>None</cite> the Dropout layer is not used.
for SENet154: 0.2
for SE-ResNet models: None
for SE-ResNeXt models: None</p></li>
<li><p><strong>dropout_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – determine the dimensions of dropout. Defaults to 1.
When dropout_dim = 1, randomly zeroes some of the elements for each channel.
When dropout_dim = 2, Randomly zeroes out entire channels (a channel is a 2D feature map).
When dropout_dim = 3, Randomly zeroes out entire channels (a channel is a 3D feature map).</p></li>
<li><p><strong>inplanes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for layer1.
for SENet154: 128
for SE-ResNet models: 64
for SE-ResNeXt models: 64</p></li>
<li><p><strong>downsample_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel size for downsampling convolutions in layer2, layer3 and layer4.
for SENet154: 3
for SE-ResNet models: 1
for SE-ResNeXt models: 1</p></li>
<li><p><strong>input_3x3</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If <cite>True</cite>, use three 3x3 convolutions instead of
a single 7x7 convolution in layer0.
- For SENet154: True
- For SE-ResNet models: False
- For SE-ResNeXt models: False</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of outputs in <cite>last_linear</cite> layer.
for all models: 1000</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SENet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L279-L282"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SENet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="senet154">
<h3><cite>SENet154</cite><a class="headerlink" href="#senet154" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SENet154">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SENet154</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">8,</span> <span class="pre">36,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L336-L351"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SENet154" title="Link to this definition">#</a></dt>
<dd><p>SENet154 based on <cite>Squeeze-and-Excitation Networks</cite> with optional pretrained support when spatial_dims is 2.</p>
</dd></dl>

</section>
<section id="seresnet50">
<h3><cite>SEResNet50</cite><a class="headerlink" href="#seresnet50" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SEResNet50">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SEResNet50</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_3x3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L354-L383"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SEResNet50" title="Link to this definition">#</a></dt>
<dd><p>SEResNet50 based on <cite>Squeeze-and-Excitation Networks</cite> with optional pretrained support when spatial_dims is 2.</p>
</dd></dl>

</section>
<section id="seresnet101">
<h3><cite>SEResNet101</cite><a class="headerlink" href="#seresnet101" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SEResNet101">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SEResNet101</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">23,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_3x3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L386-L415"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SEResNet101" title="Link to this definition">#</a></dt>
<dd><p>SEResNet101 based on <cite>Squeeze-and-Excitation Networks</cite> with optional pretrained support when spatial_dims is 2.</p>
</dd></dl>

</section>
<section id="seresnet152">
<h3><cite>SEResNet152</cite><a class="headerlink" href="#seresnet152" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SEResNet152">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SEResNet152</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">8,</span> <span class="pre">36,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_3x3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L418-L447"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SEResNet152" title="Link to this definition">#</a></dt>
<dd><p>SEResNet152 based on <cite>Squeeze-and-Excitation Networks</cite> with optional pretrained support when spatial_dims is 2.</p>
</dd></dl>

</section>
<section id="seresnext50">
<h3><cite>SEResNext50</cite><a class="headerlink" href="#seresnext50" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SEResNext50">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SEResNext50</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_3x3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L450-L481"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SEResNext50" title="Link to this definition">#</a></dt>
<dd><p>SEResNext50 based on <cite>Squeeze-and-Excitation Networks</cite> with optional pretrained support when spatial_dims is 2.</p>
</dd></dl>

</section>
<section id="seresnext101">
<h3><cite>SEResNext101</cite><a class="headerlink" href="#seresnext101" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SEResNext101">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SEResNext101</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">23,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplanes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_3x3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/senet.py#L484-L515"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SEResNext101" title="Link to this definition">#</a></dt>
<dd><p>SEResNext101 based on <cite>Squeeze-and-Excitation Networks</cite> with optional pretrained support when spatial_dims is 2.</p>
</dd></dl>

</section>
<section id="highresnet">
<h3><cite>HighResNet</cite><a class="headerlink" href="#highresnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.HighResNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">HighResNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">({'kernel_size':</span> <span class="pre">3,</span> <span class="pre">'n_features':</span> <span class="pre">16,</span> <span class="pre">'name':</span> <span class="pre">'conv_0'},</span> <span class="pre">{'kernels':</span> <span class="pre">(3,</span> <span class="pre">3),</span> <span class="pre">'n_features':</span> <span class="pre">16,</span> <span class="pre">'name':</span> <span class="pre">'res_1',</span> <span class="pre">'repeat':</span> <span class="pre">3},</span> <span class="pre">{'kernels':</span> <span class="pre">(3,</span> <span class="pre">3),</span> <span class="pre">'n_features':</span> <span class="pre">32,</span> <span class="pre">'name':</span> <span class="pre">'res_2',</span> <span class="pre">'repeat':</span> <span class="pre">3},</span> <span class="pre">{'kernels':</span> <span class="pre">(3,</span> <span class="pre">3),</span> <span class="pre">'n_features':</span> <span class="pre">64,</span> <span class="pre">'name':</span> <span class="pre">'res_3',</span> <span class="pre">'repeat':</span> <span class="pre">3},</span> <span class="pre">{'kernel_size':</span> <span class="pre">1,</span> <span class="pre">'n_features':</span> <span class="pre">80,</span> <span class="pre">'name':</span> <span class="pre">'conv_1'},</span> <span class="pre">{'kernel_size':</span> <span class="pre">1,</span> <span class="pre">'name':</span> <span class="pre">'conv_2'})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_matching</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pad</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/highresnet.py#L108-L226"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.HighResNet" title="Link to this definition">#</a></dt>
<dd><p>Reimplementation of highres3dnet based on
Li et al., “On the compactness, efficiency, and representation of 3D
convolutional networks: Brain parcellation as a pretext task”, IPMI ‘17</p>
<p>Adapted from:
<a class="github reference external" href="https://github.com/NifTK/NiftyNet/blob/v0.6.0/niftynet/network/highres3dnet.py">NifTK/NiftyNet</a>
<a class="github reference external" href="https://github.com/fepegar/highresnet">fepegar/highresnet</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>norm_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments.
Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;batch&quot;,</span> <span class="pre">{&quot;affine&quot;:</span> <span class="pre">True})</span></code>.</p></li>
<li><p><strong>acti_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments.
Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;relu&quot;,</span> <span class="pre">{&quot;inplace&quot;:</span> <span class="pre">True})</span></code>.</p></li>
<li><p><strong>dropout_prob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – probability of the feature map to be zeroed
(only applies to the penultimate conv layer).</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to False.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>layer_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – specifying key parameters of each layer/block.</p></li>
<li><p><strong>channel_matching</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.ChannelMatching" title="monai.utils.enums.ChannelMatching"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelMatching</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;project&quot;</span></code>}
Specifies handling residual branch and conv branch channel mismatches. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>: with zero padding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;project&quot;</span></code>: with a trainable conv with kernel size one.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.HighResNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/highresnet.py#L225-L226"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.HighResNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.HighResBlock">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">HighResBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_matching</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pad</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/highresnet.py#L38-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.HighResBlock" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.HighResBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acti_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_matching</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pad</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/highresnet.py#L40-L101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.HighResBlock.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – each integer k in <cite>kernels</cite> corresponds to a convolution layer with kernel size k.</p></li>
<li><p><strong>dilation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – spacing between kernel elements.</p></li>
<li><p><strong>norm_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.
Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;batch&quot;,</span> <span class="pre">{&quot;affine&quot;:</span> <span class="pre">True})</span></code>.</p></li>
<li><p><strong>acti_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – {<code class="docutils literal notranslate"><span class="pre">&quot;relu&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;prelu&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;relu6&quot;</span></code>}
Non-linear activation using ReLU or PReLU. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;relu&quot;</span></code>.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to False.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>channel_matching</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.ChannelMatching" title="monai.utils.enums.ChannelMatching"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelMatching</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;project&quot;</span></code>}
Specifies handling residual branch and conv branch channel mismatches. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;pad&quot;</span></code>: with zero padding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;project&quot;</span></code>: with a trainable conv with kernel size one.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">channel_matching=pad</span></code> and <code class="docutils literal notranslate"><span class="pre">in_channels</span> <span class="pre">&gt;</span> <span class="pre">out_channels</span></code>. Incompatible values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.HighResBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/highresnet.py#L103-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.HighResBlock.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="dynunet">
<h3><cite>DynUNet</cite><a class="headerlink" href="#dynunet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DynUNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DynUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('leakyrelu',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.01})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_supervision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_supr_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dynunet.py#L56-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DynUNet" title="Link to this definition">#</a></dt>
<dd><p>This reimplementation of a dynamic UNet (DynUNet) is based on:
<a class="reference external" href="https://arxiv.org/abs/1904.08128">Automated Design of Deep Learning Methods for Biomedical Image Segmentation</a>.
<a class="reference external" href="https://arxiv.org/abs/1809.10486">nnU-Net: Self-adapting Framework for U-Net-Based Medical Image Segmentation</a>.
<a class="reference external" href="https://arxiv.org/pdf/2110.03352.pdf">Optimized U-Net for Brain Tumor Segmentation</a>.</p>
<p>This model is more flexible compared with <code class="docutils literal notranslate"><span class="pre">monai.networks.nets.UNet</span></code> in three
places:</p>
<blockquote>
<div><ul class="simple">
<li><p>Residual connection is supported in conv blocks.</p></li>
<li><p>Anisotropic kernel sizes and strides can be used in each layers.</p></li>
<li><p>Deep supervision heads can be added.</p></li>
</ul>
</div></blockquote>
<p>The model supports 2D or 3D inputs and is consisted with four kinds of blocks:
one input block, <cite>n</cite> downsample blocks, one bottleneck and <cite>n+1</cite> upsample blocks. Where, <cite>n&gt;0</cite>.
The first and last kernel and stride values of the input sequences are used for input block and
bottleneck respectively, and the rest value(s) are used for downsample and upsample blocks.
Therefore, pleasure ensure that the length of input sequences (<code class="docutils literal notranslate"><span class="pre">kernel_size</span></code> and <code class="docutils literal notranslate"><span class="pre">strides</span></code>)
is no less than 3 in order to have at least one downsample and upsample blocks.</p>
<p>To meet the requirements of the structure, the input size for each spatial dimension should be divisible
by the product of all strides in the corresponding dimension. In addition, the minimal spatial size should have
at least one dimension that has twice the size of the product of all strides.
For example, if <cite>strides=((1, 2, 4), 2, 2, 1)</cite>, the spatial size should be divisible by <cite>(4, 8, 16)</cite>,
and the minimal spatial size is <cite>(8, 8, 16)</cite> or <cite>(4, 16, 16)</cite> or <cite>(4, 8, 32)</cite>.</p>
<p>The output size for each spatial dimension equals to the input size of the corresponding dimension divided by the
stride in strides[0].
For example, if <cite>strides=((1, 2, 4), 2, 2, 1)</cite> and the input size is <cite>(64, 32, 32)</cite>, the output size is <cite>(64, 16, 8)</cite>.</p>
<p>For backwards compatibility with old weights, please set <cite>strict=False</cite> when calling <cite>load_state_dict</cite>.</p>
<p>Usage example with medical segmentation decathlon dataset is available at:
<a class="github reference external" href="https://github.com/Project-MONAI/tutorials/tree/master/modules/dynunet_pipeline">Project-MONAI/tutorials</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – convolution kernel size.</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – convolution strides for each blocks.</p></li>
<li><p><strong>upsample_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – convolution kernel size for transposed convolution layers. The values should
equal to strides[1:].</p></li>
<li><p><strong>filters</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of output channels for each blocks. Different from nnU-Net, in this implementation we add
this argument to make the network more flexible. As shown in the third reference, one way to determine
this argument is like:
<code class="docutils literal notranslate"><span class="pre">[64,</span> <span class="pre">96,</span> <span class="pre">128,</span> <span class="pre">192,</span> <span class="pre">256,</span> <span class="pre">384,</span> <span class="pre">512,</span> <span class="pre">768,</span> <span class="pre">1024][:</span> <span class="pre">len(strides)]</span></code>.
The above way is used in the network that wins task 1 in the BraTS21 Challenge.
If not specified, the way which nnUNet used will be employed. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">INSTANCE</span></code>.
<cite>INSTANCE_NVFUSER</cite> is a faster version of the instance norm layer, it can be used when:
1) <cite>spatial_dims=3</cite>, 2) CUDA device is available, 3) <cite>apex</cite> is installed and 4) non-Windows OS is used.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation layer type and arguments. Defaults to <code class="docutils literal notranslate"><span class="pre">leakyrelu</span></code>.</p></li>
<li><p><strong>deep_supervision</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to add deep supervision head before output. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, in training mode, the forward function will output not only the final feature map
(from <cite>output_block</cite>), but also the feature maps that come from the intermediate up sample layers.
In order to unify the return type (the restriction of TorchScript), all intermediate
feature maps are interpolated into the same size as the final feature map and stacked together
(with a new dimension in the first axis)into one single tensor.
For instance, if there are two intermediate feature maps with shapes: (1, 2, 16, 12) and
(1, 2, 8, 6), and the final feature map has the shape (1, 2, 32, 24), then all intermediate feature maps
will be interpolated into (1, 2, 32, 24), and the stacked tensor will has the shape (1, 3, 2, 32, 24).
When calculating the loss, you can use torch.unbind to get all feature maps can compute the loss
one by one with the ground truth, then do a weighted average for all losses to achieve the final loss.</p></li>
<li><p><strong>deep_supr_num</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of feature maps that will output during deep supervision head. The
value should be larger than 0 and less than the number of up sample layers.
Defaults to 1.</p></li>
<li><p><strong>res_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use residual connection based convolution blocks during the network.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>trans_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to set the bias parameter in transposed convolution layers. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.DynUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dynunet.py#L268-L276"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DynUNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.DynUnet">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DynUnet</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dynunet.py#L56-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DynUnet" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.DynUNet" title="monai.networks.nets.dynunet.DynUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynUNet</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.Dynunet">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Dynunet</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dynunet.py#L56-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Dynunet" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.DynUNet" title="monai.networks.nets.dynunet.DynUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynUNet</span></code></a></p>
</dd></dl>

</section>
<section id="unet">
<h3><cite>UNet</cite><a class="headerlink" href="#unet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.UNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">UNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NDA'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unet.py#L27-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.UNet" title="Link to this definition">#</a></dt>
<dd><p>Enhanced version of UNet which has residual units implemented with the ResidualUnit class.
The residual part uses a convolution to change the input dimensions to match the output dimensions
if this is necessary but will use nn.Identity if not.
Refer to: <a class="reference external" href="https://link.springer.com/chapter/10.1007/978-3-030-12029-0_40">https://link.springer.com/chapter/10.1007/978-3-030-12029-0_40</a>.</p>
<p>Each layer of the network has a encode and decode path with a skip connection between them. Data in the encode path
is downsampled using strided convolutions (if <cite>strides</cite> is given values greater than 1) and in the decode path
upsampled using strided transpose convolutions. These down or up sampling operations occur at the beginning of each
block rather than afterwards as is typical in UNet implementations.</p>
<p>To further explain this consider the first example network given below. This network has 3 layers with strides
of 2 for each of the middle layers (the last layer is the bottom connection which does not down/up sample). Input
data to this network is immediately reduced in the spatial dimensions by a factor of 2 by the first convolution of
the residual unit defining the first layer of the encode part. The last layer of the decode part will upsample its
input (data from the previous layer concatenated with data from the skip connection) in the first convolution. this
ensures the final output of the network has the same shape as the input.</p>
<p>Padding values for the convolutions are chosen to ensure output sizes are even divisors/multiples of the input
sizes if the <cite>strides</cite> value for a layer is a factor of the input sizes. A typical case is to use <cite>strides</cite> values
of 2 and inputs that are multiples of powers of 2. An input can thus be downsampled evenly however many times its
dimensions can be divided by 2, so for the example network inputs would have to have dimensions that are multiples
of 4. In the second example network given below the input to the bottom layer will have shape (1, 64, 15, 15) for
an input of shape (1, 1, 240, 240) demonstrating the input being reduced in size spatially by 2**4.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – sequence of channels. Top block first. The length of <cite>channels</cite> should be no less than 2.</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – sequence of convolution strides. The length of <cite>stride</cite> should equal to <cite>len(channels) - 1</cite>.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size, the value(s) should be odd. If sequence,
its length should equal to dimensions. Defaults to 3.</p></li>
<li><p><strong>up_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – upsampling convolution kernel size, the value(s) should be odd. If sequence,
its length should equal to dimensions. Defaults to 3.</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of residual units. Defaults to 0.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to True.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the ordering of activation (A), normalization (N), and dropout (D).
Defaults to “NDA”. See also: <a class="reference internal" href="#monai.networks.blocks.ADN" title="monai.networks.blocks.ADN"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ADN</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">UNet</span>

<span class="c1"># 3 layer network with down/upsampling by a factor of 2 at each layer with 2-convolution residual units</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">UNet</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">num_res_units</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># 5 layer network with simple convolution/normalization/dropout/activation blocks defining the layers</span>
<span class="n">net</span><span class="o">=</span><span class="n">UNet</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Note: The acceptable spatial size of input data depends on the parameters of the network,</dt><dd><p>to set appropriate spatial size, please check the tutorial for more details:
<a class="github reference external" href="https://github.com/Project-MONAI/tutorials/blob/master/modules/UNet_input_size_constrains.ipynb">Project-MONAI/tutorials</a>.
Typically, when using a stride of 2 in down / up sampling, the output dimensions are either half of the
input when downsampling, or twice when upsampling. In this case with N numbers of layers in the network,
the inputs must have spatial dimensions that are all multiples of 2^N.
Usually, applying <cite>resize</cite>, <cite>pad</cite> or <cite>crop</cite> transforms can help adjust the spatial size of input data.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.UNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unet.py#L296-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.UNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.Unet">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Unet</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unet.py#L27-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Unet" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.UNet" title="monai.networks.nets.unet.UNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">UNet</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.unet">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">unet</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unet.py#L0-L300"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.unet" title="Link to this definition">#</a></dt>
<dd><p>alias of &lt;module ‘monai.networks.nets.unet’ from ‘/home/gautham/MONAI/temp/MONAI-1.5.1/monai/networks/nets/unet.py’&gt;</p>
</dd></dl>

</section>
<section id="attentionunet">
<h3><cite>AttentionUnet</cite><a class="headerlink" href="#attentionunet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.AttentionUnet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">AttentionUnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/attentionunet.py#L185-L290"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.AttentionUnet" title="Link to this definition">#</a></dt>
<dd><p>Attention Unet based on
Otkay et al. “Attention U-Net: Learning Where to Look for the Pancreas”
<a class="reference external" href="https://arxiv.org/abs/1804.03999">https://arxiv.org/abs/1804.03999</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input image.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of the input channel.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of the output classes.</p></li>
<li><p><strong>channels</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – sequence of channels. Top block first. The length of <cite>channels</cite> should be no less than 2.</p></li>
<li><p><strong>strides</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – stride to use for convolutions.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size.</p></li>
<li><p><strong>up_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size for transposed convolution layers.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout ratio. Defaults to no dropout.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.AttentionUnet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/attentionunet.py#L288-L290"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.AttentionUnet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="unetr">
<h3><cite>UNETR</cite><a class="headerlink" href="#unetr" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.UNETR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">UNETR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unetr.py#L24-L213"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.UNETR" title="Link to this definition">#</a></dt>
<dd><p>UNETR based on: “Hatamizadeh et al.,
UNETR: Transformers for 3D Medical Image Segmentation &lt;<a class="reference external" href="https://arxiv.org/abs/2103.10504">https://arxiv.org/abs/2103.10504</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.UNETR.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unetr.py#L30-L191"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.UNETR.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of output channels.</p></li>
<li><p><strong>img_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of input image.</p></li>
<li><p><strong>feature_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of network feature size. Defaults to 16.</p></li>
<li><p><strong>hidden_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of hidden layer. Defaults to 768.</p></li>
<li><p><strong>mlp_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of feedforward layer. Defaults to 3072.</p></li>
<li><p><strong>num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of attention heads. Defaults to 12.</p></li>
<li><p><strong>proj_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – patch embedding layer type. Defaults to “conv”.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to “instance”.</p></li>
<li><p><strong>conv_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if convolutional block is used. Defaults to True.</p></li>
<li><p><strong>res_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if residual block is used. Defaults to True.</p></li>
<li><p><strong>dropout_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – fraction of the input units to drop. Defaults to 0.0.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dims. Defaults to 3.</p></li>
<li><p><strong>qkv_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – apply the bias term for the qkv linear layer in self attention block. Defaults to False.</p></li>
<li><p><strong>save_attn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – to make accessible the attention in self attention block. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for single channel input 4-channel output with image size of (96,96,96), feature size of 32 and batch norm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">UNETR</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">96</span><span class="p">),</span> <span class="n">feature_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">norm_name</span><span class="o">=</span><span class="s1">&#39;batch&#39;</span><span class="p">)</span>

 <span class="c1"># for single channel input 4-channel output with image size of (96,96), feature size of 32 and batch norm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">UNETR</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">feature_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">norm_name</span><span class="o">=</span><span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># for 4-channel input 3-channel output with image size of (128,128,128), conv position embedding and instance norm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">UNETR</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">),</span> <span class="n">proj_type</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="n">norm_name</span><span class="o">=</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.UNETR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/unetr.py#L199-L213"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.UNETR.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="vista3d">
<h3><cite>VISTA3D</cite><a class="headerlink" href="#vista3d" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">VISTA3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_head</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L58-L472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>VISTA3D based on:</dt><dd><p><a class="reference external" href="https://arxiv.org/abs/2406.05285">VISTA3D: Versatile Imaging SegmenTation and Annotation model for 3D Computed Tomography</a>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_encoder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – image encoder backbone for feature extraction.</p></li>
<li><p><strong>class_head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – class head used for class index based segmentation</p></li>
<li><p><strong>point_head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – point head used for interactive segmetnation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.connected_components_combine">
<span class="sig-name descname"><span class="pre">connected_components_combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L216-L275"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.connected_components_combine" title="Link to this definition">#</a></dt>
<dd><p>Combine auto results with point click response. The auto results have shape [B, 1, H, W, D] which means B foreground masks
from a single image patch.
Out of those B foreground masks, user may add points to a subset of B1 foreground masks for editing.
mapping_index represents the correspondence between B and B1.
For mapping_index with point clicks, NaN values in logits will be replaced with point_logits. Meanwhile, the added/removed
region in point clicks must be updated by the lcc function.
Notice, if a positive point is within logits/prev_mask, the components containing the positive point will be added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – automatic branch results, [B, 1, H, W, D].</p></li>
<li><p><strong>point_logits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point branch results, [B1, 1, H, W, D].</p></li>
<li><p><strong>point_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point coordinates, [B1, N, 3].</p></li>
<li><p><strong>point_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point labels, [B1, N].</p></li>
<li><p><strong>mapping_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – [B].</p></li>
<li><p><strong>thred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the threshold to convert logits to binary.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.convert_point_label">
<span class="sig-name descname"><span class="pre">convert_point_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(23,</span> <span class="pre">24,</span> <span class="pre">25,</span> <span class="pre">26,</span> <span class="pre">27,</span> <span class="pre">57,</span> <span class="pre">128)</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L119-L146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.convert_point_label" title="Link to this definition">#</a></dt>
<dd><p>Convert point label based on its class prompt. For special classes defined in special index,
the positive/negative point label will be converted from 1/0 to 3/2. The purpose is to separate those
classes with ambiguous classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the point label tensor, [B, N].</p></li>
<li><p><strong>label_set</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the label index matching the indexes in labels. If labels are mapped to global index using RelabelID,
this label_set should be global mapped index. If labels are not mapped to global index, e.g. in zero-shot
evaluation, this label_set should be the original index.</p></li>
<li><p><strong>special_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the special class index that needs to be converted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prompt_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_point_sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L336-L472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.forward" title="Link to this definition">#</a></dt>
<dd><p>The forward function for VISTA3D. We only support single patch in training and inference.
One exception is allowing sliding window batch size &gt; 1 for automatic segmentation only case.
B represents number of objects, N represents number of points for each objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_images</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – [1, 1, H, W, D]</p></li>
<li><p><strong>point_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – [B, N, 3]</p></li>
<li><p><strong>point_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – [B, N], -1 represents padding. 0/1 means negative/positive points for regular class.
2/3 means negative/postive ponits for special supported class like tumor.</p></li>
<li><p><strong>class_vector</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – [B, 1], the global class index.</p></li>
<li><p><strong>prompt_class</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – [B, 1], the global class index. This value is associated with point_coords to identify if
the points are for zero-shot or supported class. When class_vector and point_coords are both
provided, prompt_class is the same as class_vector. For prompt_class[b] &gt; 512, point_coords[b]
will be considered novel class.</p></li>
<li><p><strong>patch_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a list of sequence of the python slice objects representing the patch coordinates during sliding window
inference. This value is passed from sliding_window_inferer.
This is an indicator for training phase or validation phase.
Notice for sliding window batch size &gt; 1 (only supported by automatic segmentation), patch_coords will inlcude
coordinates of multiple patches. If point prompts are included, the batch size can only be one and all the
functions using patch_coords will by default use patch_coords[0].</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – [1, 1, H, W, D], the groundtruth label tensor, only used for point-only evaluation</p></li>
<li><p><strong>label_set</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the label index matching the indexes in labels. If labels are mapped to global index using RelabelID,
this label_set should be global mapped index. If labels are not mapped to global index, e.g. in zero-shot
evaluation, this label_set should be the original index.</p></li>
<li><p><strong>prev_mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – [B, N, H_fullsize, W_fullsize, D_fullsize].
This is the transposed raw output from sliding_window_inferer before any postprocessing.
When user click points to perform auto-results correction, this can be the auto-results.</p></li>
<li><p><strong>radius</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – single float value controling the gaussian blur when combining point and auto results.
The gaussian combine is not used in VISTA3D training but might be useful for finetuning purposes.</p></li>
<li><p><strong>val_point_sampler</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – function used to sample points from labels. This is only used for point-only evaluation.</p></li>
<li><p><strong>transpose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – bool. If true, the output will be transposed to be [1, B, H, W, D]. Required to be true if calling from
sliding window inferer/point inferer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.gaussian_combine">
<span class="sig-name descname"><span class="pre">gaussian_combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L277-L306"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.gaussian_combine" title="Link to this definition">#</a></dt>
<dd><p>Combine point results with auto results using gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – automatic branch results, [B, 1, H, W, D].</p></li>
<li><p><strong>point_logits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point branch results, [B1, 1, H, W, D].</p></li>
<li><p><strong>point_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point coordinates, [B1, N, 3].</p></li>
<li><p><strong>point_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point labels, [B1, N].</p></li>
<li><p><strong>mapping_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – [B].</p></li>
<li><p><strong>radius</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – gaussian ball radius.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.get_foreground_class_count">
<span class="sig-name descname"><span class="pre">get_foreground_class_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_coords</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L110-L117"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.get_foreground_class_count" title="Link to this definition">#</a></dt>
<dd><p>Get number of foreground classes based on class and point prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.sample_points_patch_val">
<span class="sig-name descname"><span class="pre">sample_points_patch_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapped_label_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ppoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_npoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L148-L179"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.sample_points_patch_val" title="Link to this definition">#</a></dt>
<dd><p>Sample points for patch during sliding window validation. Only used for point only validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape [1, 1, H, W, D].</p></li>
<li><p><strong>patch_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code>]) – a sequence of sliding window slice objects.</p></li>
<li><p><strong>label_set</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – local index, must match values in labels.</p></li>
<li><p><strong>use_center</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – sample points from the center.</p></li>
<li><p><strong>mapped_label_set</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – global index, it is used to identify special classes and is the global index
for the sampled points.</p></li>
<li><p><strong>max_ppoint/max_npoint</strong> – positive points and negative points to sample.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.set_auto_grad">
<span class="sig-name descname"><span class="pre">set_auto_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auto_freeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_freeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L308-L334"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.set_auto_grad" title="Link to this definition">#</a></dt>
<dd><p>Freeze auto-branch or point-branch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>auto_freeze</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to freeze the auto branch.</p></li>
<li><p><strong>point_freeze</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to freeze the point branch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.update_point_to_patch">
<span class="sig-name descname"><span class="pre">update_point_to_patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_labels</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L181-L214"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.update_point_to_patch" title="Link to this definition">#</a></dt>
<dd><p>Update point_coords with respect to patch coords.
If point is outside of the patch, remove the coordinates and set label to -1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code>]) – a sequence of the python slice objects representing the patch coordinates during sliding window inference.
This value is passed from sliding_window_inferer.</p></li>
<li><p><strong>point_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point coordinates, [B, N, 3].</p></li>
<li><p><strong>point_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – point labels, [B, N].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VISTA3D.update_slidingwindow_padding">
<span class="sig-name descname"><span class="pre">update_slidingwindow_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pad_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_coords</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vista3d.py#L81-L108"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VISTA3D.update_slidingwindow_padding" title="Link to this definition">#</a></dt>
<dd><p>Image has been padded by sliding window inferer.
The related padding need to be performed outside of slidingwindow inferer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pad_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – padding size passed from sliding window inferer.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – image label ground truth.</p></li>
<li><p><strong>prev_mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – previous segmentation mask.</p></li>
<li><p><strong>point_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – point click coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="swinunetr">
<h3><cite>SwinUNETR</cite><a class="headerlink" href="#swinunetr" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.SwinUNETR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">SwinUNETR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths=(2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads=(3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">24)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size=24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name='instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_path_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_norm=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample='merging'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_v2=False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/swin_unetr.py#L45-L330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SwinUNETR" title="Link to this definition">#</a></dt>
<dd><p>Swin UNETR based on: “Hatamizadeh et al.,
Swin UNETR: Swin Transformers for Semantic Segmentation of Brain Tumors in MRI Images
&lt;<a class="reference external" href="https://arxiv.org/abs/2201.01266">https://arxiv.org/abs/2201.01266</a>&gt;”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SwinUNETR.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths=(2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads=(3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">24)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size=7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio=4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_size=24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name='instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_path_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_norm=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample='merging'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_v2=False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/swin_unetr.py#L52-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SwinUNETR.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of output channels.</p></li>
<li><p><strong>patch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – size of the patch token.</p></li>
<li><p><strong>feature_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of network feature size.</p></li>
<li><p><strong>depths</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of layers in each stage.</p></li>
<li><p><strong>num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of attention heads.</p></li>
<li><p><strong>window_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – local window size.</p></li>
<li><p><strong>qkv_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – add a learnable bias to query, key, value.</p></li>
<li><p><strong>mlp_ratio</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – ratio of mlp hidden dim to embedding dim.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments.</p></li>
<li><p><strong>drop_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout rate.</p></li>
<li><p><strong>attn_drop_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – attention dropout rate.</p></li>
<li><p><strong>dropout_path_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – drop path rate.</p></li>
<li><p><strong>normalize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – normalize output intermediate features in each stage.</p></li>
<li><p><strong>norm_layer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">LayerNorm</span></code>]) – normalization layer.</p></li>
<li><p><strong>patch_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to apply normalization to the patch embedding. Default is False.</p></li>
<li><p><strong>use_checkpoint</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use gradient checkpointing for reduced memory usage.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dims.</p></li>
<li><p><strong>downsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>]) – module used for downsampling, available options are <cite>“mergingv2”</cite>, <cite>“merging”</cite> and a
user-specified <cite>nn.Module</cite> following the API defined in <code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.PatchMerging</span></code>.
The default is currently <cite>“merging”</cite> (the original version defined in v0.9.0).</p></li>
<li><p><strong>use_v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – using swinunetr_v2, which adds a residual convolution block at the beggining of each swin stage.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for 3D single channel input with size (96,96,96), 4-channel output and feature size of 48.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">SwinUNETR</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">feature_size</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="c1"># for 3D 4-channel input with size (128,128,128), 3-channel output and (2,4,2,2) layers in each stage.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">SwinUNETR</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">depths</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># for 2D single channel input with size (96,96), 2-channel output and gradient checkpointing.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">SwinUNETR</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_checkpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.SwinUNETR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/swin_unetr.py#L315-L330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.SwinUNETR.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="basicunet">
<h3><cite>BasicUNet</cite><a class="headerlink" href="#basicunet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">BasicUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('LeakyReLU',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('instance',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unet.py#L178-L279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUNet" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('LeakyReLU',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('instance',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unet.py#L180-L252"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUNet.__init__" title="Link to this definition">#</a></dt>
<dd><p>A UNet implementation with 1D/2D/3D supports.</p>
<p>Based on:</p>
<blockquote>
<div><p>Falk et al. “U-Net – Deep Learning for Cell Counting, Detection, and
Morphometry”. Nature Methods 16, 67–70 (2019), DOI:
<a class="reference external" href="http://dx.doi.org/10.1038/s41592-018-0261-2">http://dx.doi.org/10.1038/s41592-018-0261-2</a></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions. Defaults to 3 for spatial 3D inputs.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels. Defaults to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels. Defaults to 2.</p></li>
<li><p><strong>features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – <p>six integers as numbers of features.
Defaults to <code class="docutils literal notranslate"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></code>,</p>
<ul>
<li><p>the first five values correspond to the five-level encoder feature sizes.</p></li>
<li><p>the last value corresponds to the feature size after the last upsampling.</p></li>
</ul>
</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to LeakyReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to True.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>upsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – upsampling mode, available options are
<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for spatial 2D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNet</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>

<span class="c1"># for spatial 2D, with group norm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNet</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_groups&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}))</span>

<span class="c1"># for spatial 3D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNet</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
</pre></div>
</div>
<p>See Also</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#monai.networks.nets.DynUNet" title="monai.networks.nets.DynUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.DynUNet</span></code></a></p></li>
<li><p><a class="reference internal" href="#monai.networks.nets.UNet" title="monai.networks.nets.UNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.UNet</span></code></a></p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unet.py#L254-L279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUNet.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input should have spatially N dimensions
<code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">in_channels,</span> <span class="pre">dim_0[,</span> <span class="pre">dim_1,</span> <span class="pre">...,</span> <span class="pre">dim_N-1])</span></code>, N is defined by <cite>spatial_dims</cite>.
It is recommended to have <code class="docutils literal notranslate"><span class="pre">dim_n</span> <span class="pre">%</span> <span class="pre">16</span> <span class="pre">==</span> <span class="pre">0</span></code> to ensure all maxpooling inputs have
even edge lengths.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A torch Tensor of “raw” predictions in shape
<code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">out_channels,</span> <span class="pre">dim_0[,</span> <span class="pre">dim_1,</span> <span class="pre">...,</span> <span class="pre">dim_N-1])</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUnet">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">BasicUnet</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unet.py#L178-L279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUnet" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.BasicUNet" title="monai.networks.nets.basic_unet.BasicUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicUNet</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.Basicunet">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Basicunet</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unet.py#L178-L279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Basicunet" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.BasicUNet" title="monai.networks.nets.basic_unet.BasicUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicUNet</span></code></a></p>
</dd></dl>

</section>
<section id="basicunetplusplus">
<h3><cite>BasicUNetPlusPlus</cite><a class="headerlink" href="#basicunetplusplus" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUNetPlusPlus">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">BasicUNetPlusPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_supervision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('LeakyReLU',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('instance',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unetplusplus.py#L26-L171"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUNetPlusPlus" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUNetPlusPlus.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_supervision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('LeakyReLU',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('instance',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unetplusplus.py#L28-L128"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUNetPlusPlus.__init__" title="Link to this definition">#</a></dt>
<dd><p>A UNet++ implementation with 1D/2D/3D supports.</p>
<p>Based on:</p>
<blockquote>
<div><p>Zhou et al. “UNet++: A Nested U-Net Architecture for Medical Image
Segmentation”. 4th Deep Learning in Medical Image Analysis (DLMIA)
Workshop, DOI: <a class="reference external" href="https://doi.org/10.48550/arXiv.1807.10165">https://doi.org/10.48550/arXiv.1807.10165</a></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions. Defaults to 3 for spatial 3D inputs.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels. Defaults to 1.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels. Defaults to 2.</p></li>
<li><p><strong>features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – <p>six integers as numbers of features.
Defaults to <code class="docutils literal notranslate"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></code>,</p>
<ul>
<li><p>the first five values correspond to the five-level encoder feature sizes.</p></li>
<li><p>the last value corresponds to the feature size after the last upsampling.</p></li>
</ul>
</p></li>
<li><p><strong>deep_supervision</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to prune the network at inference time. Defaults to False. If true, returns a list,
whose elements correspond to outputs at different nodes.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to LeakyReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to True.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>upsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – upsampling mode, available options are
<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for spatial 2D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNetPlusPlus</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>

<span class="c1"># for spatial 2D, with deep supervision enabled</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNetPlusPlus</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">deep_supervision</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># for spatial 2D, with group norm</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNetPlusPlus</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_groups&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}))</span>

<span class="c1"># for spatial 3D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">BasicUNetPlusPlus</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
</pre></div>
</div>
<dl class="simple">
<dt>See Also</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#monai.networks.nets.BasicUNet" title="monai.networks.nets.BasicUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.BasicUNet</span></code></a></p></li>
<li><p><a class="reference internal" href="#monai.networks.nets.DynUNet" title="monai.networks.nets.DynUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.DynUNet</span></code></a></p></li>
<li><p><a class="reference internal" href="#monai.networks.nets.UNet" title="monai.networks.nets.UNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.UNet</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUNetPlusPlus.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unetplusplus.py#L130-L171"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUNetPlusPlus.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input should have spatially N dimensions
<code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">in_channels,</span> <span class="pre">dim_0[,</span> <span class="pre">dim_1,</span> <span class="pre">...,</span> <span class="pre">dim_N-1])</span></code>, N is defined by <cite>dimensions</cite>.
It is recommended to have <code class="docutils literal notranslate"><span class="pre">dim_n</span> <span class="pre">%</span> <span class="pre">16</span> <span class="pre">==</span> <span class="pre">0</span></code> to ensure all maxpooling inputs have
even edge lengths.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A torch Tensor of “raw” predictions in shape
<code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">out_channels,</span> <span class="pre">dim_0[,</span> <span class="pre">dim_1,</span> <span class="pre">...,</span> <span class="pre">dim_N-1])</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BasicUnetPlusPlus">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">BasicUnetPlusPlus</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unetplusplus.py#L26-L171"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicUnetPlusPlus" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.BasicUNetPlusPlus" title="monai.networks.nets.basic_unetplusplus.BasicUNetPlusPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicUNetPlusPlus</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.BasicunetPlusPlus">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">BasicunetPlusPlus</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/basic_unetplusplus.py#L26-L171"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.BasicunetPlusPlus" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.networks.nets.BasicUNetPlusPlus" title="monai.networks.nets.basic_unetplusplus.BasicUNetPlusPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicUNetPlusPlus</span></code></a></p>
</dd></dl>

</section>
<section id="flexibleunet">
<h3><cite>FlexibleUNet</cite><a class="headerlink" href="#flexibleunet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.FlexibleUNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">FlexibleUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">128,</span> <span class="pre">64,</span> <span class="pre">32,</span> <span class="pre">16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nontrainable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/flexible_unet.py#L219-L347"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.FlexibleUNet" title="Link to this definition">#</a></dt>
<dd><p>A flexible implementation of UNet-like encoder-decoder architecture.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.FlexibleUNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">128,</span> <span class="pre">64,</span> <span class="pre">32,</span> <span class="pre">16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('batch',</span> <span class="pre">{'eps':</span> <span class="pre">0.001,</span> <span class="pre">'momentum':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('relu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nontrainable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/flexible_unet.py#L224-L328"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.FlexibleUNet.__init__" title="Link to this definition">#</a></dt>
<dd><p>A flexible implement of UNet, in which the backbone/encoder can be replaced with
any efficient or residual network. Currently the input must have a 2 or 3 spatial dimension
and the spatial size of each dimension must be a multiple of 32 if is_pad parameter
is False.
Please notice each output of backbone must be 2x downsample in spatial dimension
of last output. For example, if given a 512x256 2D image and a backbone with 4 outputs.
Spatial size of each encoder output should be 256x128, 128x64, 64x32 and 32x16.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>backbone</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – name of backbones to initialize, only support efficientnet and resnet right now,
can be from [efficientnet-b0, …, efficientnet-b8, efficientnet-l2, resnet10, …, resnet200].</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to initialize pretrained weights. ImageNet weights are available for efficient networks
if spatial_dims=2 and batch norm is used. MedicalNet weights are available for residual networks
if spatial_dims=3 and in_channels=1. Default to False.</p></li>
<li><p><strong>decoder_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – number of output channels for all feature maps in decoder.
<cite>len(decoder_channels)</cite> should equal to <cite>len(encoder_channels) - 1</cite>,default
to (256, 128, 64, 32, 16).</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, default to 2.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – normalization type and arguments, default to (“batch”, {“eps”: 1e-3,
“momentum”: 0.1}).</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments, default to (“relu”, {“inplace”: True}).</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – dropout ratio, default to 0.0.</p></li>
<li><p><strong>decoder_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in decoder’s convolution blocks.</p></li>
<li><p><strong>upsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – upsampling mode, available options are``”deconv”<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">``&quot;pixelshuffle&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>.</p></li>
<li><p><strong>pre_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a conv block applied before upsampling. Only used in the “nontrainable” or
“pixelshuffle” mode, default to <cite>default</cite>.</p></li>
<li><p><strong>interp_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bilinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bicubic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;trilinear&quot;</span></code>}
Only used in the “nontrainable” mode.</p></li>
<li><p><strong>is_pad</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to pad upsampling features to fit features from encoder. Default to True.
If this parameter is set to “True”, the spatial dim of network input can be arbitrary
size, which is not supported by TensorRT. Otherwise, it must be a multiple of 32.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.FlexibleUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/flexible_unet.py#L330-L347"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.FlexibleUNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Do a typical encoder-decoder-header inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input should have spatially N dimensions <code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">in_channels,</span> <span class="pre">dim_0[,</span> <span class="pre">dim_1,</span> <span class="pre">...,</span> <span class="pre">dim_N])</span></code>,
N is defined by <cite>dimensions</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A torch Tensor of “raw” predictions in shape <code class="docutils literal notranslate"><span class="pre">(Batch,</span> <span class="pre">out_channels,</span> <span class="pre">dim_0[,</span> <span class="pre">dim_1,</span> <span class="pre">...,</span> <span class="pre">dim_N])</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="vnet">
<h3><cite>VNet</cite><a class="headerlink" href="#vnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.VNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">VNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('elu',</span> <span class="pre">{'inplace':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vnet.py#L200-L279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VNet" title="Link to this definition">#</a></dt>
<dd><p>V-Net based on <a class="reference external" href="https://arxiv.org/pdf/1606.04797.pdf">Fully Convolutional Neural Networks for Volumetric Medical Image Segmentation</a>.
Adapted from <a class="reference external" href="https://github.com/faustomilletari/VNet">the official Caffe implementation</a>. and <a class="reference external" href="https://github.com/mattmacy/vnet.pytorch/blob/master/vnet.py">another pytorch implementation</a>.
The model supports 2D or 3D inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial dimension of the input data. Defaults to 3.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels for the network. Defaults to 1.
The value should meet the condition that <code class="docutils literal notranslate"><span class="pre">16</span> <span class="pre">%</span> <span class="pre">in_channels</span> <span class="pre">==</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for the network. Defaults to 1.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type in the network. Defaults to <code class="docutils literal notranslate"><span class="pre">(&quot;elu&quot;,</span> <span class="pre">{&quot;inplace&quot;:</span> <span class="pre">True})</span></code>.</p></li>
<li><p><strong>dropout_prob_down</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio for DownTransition blocks. Defaults to 0.5.</p></li>
<li><p><strong>dropout_prob_up</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – dropout ratio for UpTransition blocks. Defaults to (0.5, 0.5).</p></li>
<li><p><strong>dropout_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>determine the dimensions of dropout. Defaults to (0.5, 0.5).</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dropout_dim</span> <span class="pre">=</span> <span class="pre">1</span></code>, randomly zeroes some of the elements for each channel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dropout_dim</span> <span class="pre">=</span> <span class="pre">2</span></code>, Randomly zeroes out entire channels (a channel is a 2D feature map).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dropout_dim</span> <span class="pre">=</span> <span class="pre">3</span></code>, Randomly zeroes out entire channels (a channel is a 3D feature map).</p></li>
</ul>
</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to False.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
</ul>
</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.2: </span><code class="docutils literal notranslate"><span class="pre">dropout_prob</span></code> is deprecated in favor of <code class="docutils literal notranslate"><span class="pre">dropout_prob_down</span></code> and <code class="docutils literal notranslate"><span class="pre">dropout_prob_up</span></code>.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vnet.py#L268-L279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="regunet">
<h3><cite>RegUNet</cite><a class="headerlink" href="#regunet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.RegUNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">RegUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channel_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode_kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L30-L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.RegUNet" title="Link to this definition">#</a></dt>
<dd><p>Class that implements an adapted UNet. This class also serve as the parent class of LocalNet and GlobalNet</p>
<dl class="simple">
<dt>Reference:</dt><dd><p>O. Ronneberger, P. Fischer, and T. Brox,
“U-net: Convolutional networks for biomedical image segmentation,”,
Lecture Notes in Computer Science, 2015, vol. 9351, pp. 234–241.
<a class="reference external" href="https://arxiv.org/abs/1505.04597">https://arxiv.org/abs/1505.04597</a></p>
</dd>
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.RegUNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channel_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode_kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L44-L109"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.RegUNet.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dims</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels</p></li>
<li><p><strong>num_channel_initial</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of initial channels</p></li>
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – input is at level 0, bottom is at level depth.</p></li>
<li><p><strong>out_kernel_initializer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel initializer for the last layer</p></li>
<li><p><strong>out_activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation at the last layer</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels for the output</p></li>
<li><p><strong>extract_levels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – list, which levels from net to extract. The maximum level must equal to <code class="docutils literal notranslate"><span class="pre">depth</span></code></p></li>
<li><p><strong>pooling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – for down-sampling, use non-parameterized pooling if true, otherwise use conv</p></li>
<li><p><strong>concat_skip</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – when up-sampling, concatenate skipped tensor if true, otherwise use addition</p></li>
<li><p><strong>encode_kernel_sizes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – kernel size for down-sampling</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.RegUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L204-L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.RegUNet.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">in_channels</span></code>, insize_1, insize_2, [insize_3])</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor in shape (batch, <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>, insize_1, insize_2, [insize_3]), with the same spatial size as <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="globalnet">
<h3><cite>GlobalNet</cite><a class="headerlink" href="#globalnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.GlobalNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">GlobalNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channel_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode_kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L306-L375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.GlobalNet" title="Link to this definition">#</a></dt>
<dd><p>Build GlobalNet for image registration.</p>
<dl class="simple">
<dt>Reference:</dt><dd><p>Hu, Yipeng, et al.
“Label-driven weakly-supervised learning
for multimodal deformable image registration,”
<a class="reference external" href="https://arxiv.org/abs/1711.01666">https://arxiv.org/abs/1711.01666</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.GlobalNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channel_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode_kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L317-L366"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.GlobalNet.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – output displacement field spatial size</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dims</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels</p></li>
<li><p><strong>num_channel_initial</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of initial channels</p></li>
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – input is at level 0, bottom is at level depth.</p></li>
<li><p><strong>out_kernel_initializer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel initializer for the last layer</p></li>
<li><p><strong>out_activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation at the last layer</p></li>
<li><p><strong>pooling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – for down-sampling, use non-parameterized pooling if true, otherwise use conv</p></li>
<li><p><strong>concat_skip</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – when up-sampling, concatenate skipped tensor if true, otherwise use addition</p></li>
<li><p><strong>encode_kernel_sizes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – kernel size for down-sampling</p></li>
<li><p><strong>save_theta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to save the theta matrix estimation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="localnet">
<h3><cite>LocalNet</cite><a class="headerlink" href="#localnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.LocalNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">LocalNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channel_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_additive_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L402-L477"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.LocalNet" title="Link to this definition">#</a></dt>
<dd><p>Reimplementation of LocalNet, based on:
<a class="reference external" href="https://doi.org/10.1016/j.media.2018.07.002">Weakly-supervised convolutional neural networks for multimodal image registration</a>.
<a class="reference external" href="https://arxiv.org/abs/1711.01666">Label-driven weakly-supervised learning for multimodal deformable image registration</a>.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.LocalNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channel_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kaiming_uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_additive_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regunet.py#L414-L459"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.LocalNet.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dims</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels</p></li>
<li><p><strong>num_channel_initial</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of initial channels</p></li>
<li><p><strong>out_kernel_initializer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – kernel initializer for the last layer</p></li>
<li><p><strong>out_activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation at the last layer</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels for the output</p></li>
<li><p><strong>extract_levels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – list, which levels from net to extract. The maximum level must equal to <code class="docutils literal notranslate"><span class="pre">depth</span></code></p></li>
<li><p><strong>pooling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – for down-sampling, use non-parameterized pooling if true, otherwise use conv3d</p></li>
<li><p><strong>use_additive_sampling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether use additive up-sampling layer for decoding.</p></li>
<li><p><strong>concat_skip</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – when up-sampling, concatenate skipped tensor if true, otherwise use addition</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – mode for interpolation when use_additive_sampling, default is “nearest”.</p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – align_corners for interpolation when use_additive_sampling, default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="autoencoder">
<h3><cite>AutoEncoder</cite><a class="headerlink" href="#autoencoder" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.AutoEncoder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">AutoEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inter_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inter_dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_inter_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/autoencoder.py#L26-L306"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.AutoEncoder" title="Link to this definition">#</a></dt>
<dd><p>Simple definition of an autoencoder and base class for the architecture implementing
<a class="reference internal" href="#monai.networks.nets.VarAutoEncoder" title="monai.networks.nets.VarAutoEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.VarAutoEncoder</span></code></a>. The network is composed of an encode sequence of blocks, followed
by an intermediary sequence of blocks, and finally a decode sequence of blocks. The encode and decode blocks are
default <a class="reference internal" href="#monai.networks.blocks.Convolution" title="monai.networks.blocks.Convolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.Convolution</span></code></a> instances with the encode blocks having the given stride
and the decode blocks having transpose convolutions with the same stride. If <cite>num_res_units</cite> is given residual
blocks are used instead.</p>
<p>By default the intermediary sequence is empty but if <cite>inter_channels</cite> is given to specify the output channels of
blocks then this will be become a sequence of Convolution blocks or of residual blocks if <cite>num_inter_units</cite> is
given. The optional parameter <cite>inter_dilations</cite> can be used to specify the dilation values of the convolutions in
these blocks, this allows a network to use dilated kernels in this  middle section. Since the intermediary section
isn’t meant to change the size of the output the strides for all these kernels is 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – sequence of channels. Top block first. The length of <cite>channels</cite> should be no less than 2.</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – sequence of convolution strides. The length of <cite>stride</cite> should equal to <cite>len(channels) - 1</cite>.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size, the value(s) should be odd. If sequence,
its length should equal to dimensions. Defaults to 3.</p></li>
<li><p><strong>up_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – upsampling convolution kernel size, the value(s) should be odd. If sequence,
its length should equal to dimensions. Defaults to 3.</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of residual units. Defaults to 0.</p></li>
<li><p><strong>inter_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – sequence of channels defining the blocks in the intermediate layer between encode and decode.</p></li>
<li><p><strong>inter_dilations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – defines the dilation value for each block of the intermediate layer. Defaults to 1.</p></li>
<li><p><strong>num_inter_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of residual units for each block of the intermediate layer. Defaults to 0.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to True.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>padding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – controls the amount of implicit zero-paddings on both sides for padding number of points
for each dimension in convolution blocks. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoEncoder</span>

<span class="c1"># 3 layers each down/up sampling their inputs by a factor 2 with no intermediate layer</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">AutoEncoder</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># 1 layer downsampling by 2, followed by a sequence of residual units with 2 convolutions defined by</span>
<span class="c1"># progressively increasing dilations, then final upsample layer</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">AutoEncoder</span><span class="p">(</span>
        <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,),</span>
        <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span>
        <span class="n">inter_channels</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">inter_dilations</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
        <span class="n">num_inter_units</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.AutoEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/autoencoder.py#L302-L306"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.AutoEncoder.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="varautoencoder">
<h3><cite>VarAutoEncoder</cite><a class="headerlink" href="#varautoencoder" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.VarAutoEncoder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">VarAutoEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inter_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inter_dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_inter_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/varautoencoder.py#L28-L155"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VarAutoEncoder" title="Link to this definition">#</a></dt>
<dd><p>Variational Autoencoder based on the paper - <a class="reference external" href="https://arxiv.org/abs/1312.6114">https://arxiv.org/abs/1312.6114</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – shape of input data starting with channel dimension.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>latent_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – size of the latent variable.</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – sequence of channels. Top block first. The length of <cite>channels</cite> should be no less than 2.</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – sequence of convolution strides. The length of <cite>stride</cite> should equal to <cite>len(channels) - 1</cite>.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – convolution kernel size, the value(s) should be odd. If sequence,
its length should equal to dimensions. Defaults to 3.</p></li>
<li><p><strong>up_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – upsampling convolution kernel size, the value(s) should be odd. If sequence,
its length should equal to dimensions. Defaults to 3.</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of residual units. Defaults to 0.</p></li>
<li><p><strong>inter_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – sequence of channels defining the blocks in the intermediate layer between encode and decode.</p></li>
<li><p><strong>inter_dilations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – defines the dilation value for each block of the intermediate layer. Defaults to 1.</p></li>
<li><p><strong>num_inter_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of residual units for each block of the intermediate layer. Defaults to 0.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>whether to have a bias term in convolution blocks. Defaults to True.
According to <a class="reference external" href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html">Performance Tuning Guide</a>,
if a conv layer is directly followed by a batch norm layer, bias should be False.</p>
</p></li>
<li><p><strong>use_sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use the sigmoid function on final output. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">VarAutoEncoder</span>

<span class="c1"># 3 layer network accepting images with dimensions (1, 32, 32) and using a latent vector with 2 values</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">VarAutoEncoder</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">in_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>  <span class="c1"># image spatial shape</span>
    <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">latent_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>Variational autoencoder network with MedNIST Dataset
<a class="github reference external" href="https://github.com/Project-MONAI/tutorials/blob/master/modules/varautoencoder_mednist.ipynb">Project-MONAI/tutorials</a></p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VarAutoEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/varautoencoder.py#L152-L155"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VarAutoEncoder.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="vit">
<h3><cite>ViT</cite><a class="headerlink" href="#vit" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.ViT">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">ViT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'learnable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Tanh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vit.py#L25-L133"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ViT" title="Link to this definition">#</a></dt>
<dd><p>Vision Transformer (ViT), based on: “Dosovitskiy et al.,
An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale &lt;<a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>&gt;”</p>
<p>ViT supports Torchscript but only works for Pytorch after 1.8.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ViT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'learnable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Tanh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vit.py#L33-L119"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ViT.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – dimension of input channels.</p></li>
<li><p><strong>img_size</strong> (<em>Union</em><em>[</em><em>Sequence</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – dimension of input image.</p></li>
<li><p><strong>patch_size</strong> (<em>Union</em><em>[</em><em>Sequence</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – dimension of patch size.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em><em>, </em><em>optional</em>) – dimension of hidden layer. Defaults to 768.</p></li>
<li><p><strong>mlp_dim</strong> (<em>int</em><em>, </em><em>optional</em>) – dimension of feedforward layer. Defaults to 3072.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em><em>, </em><em>optional</em>) – number of transformer blocks. Defaults to 12.</p></li>
<li><p><strong>num_heads</strong> (<em>int</em><em>, </em><em>optional</em>) – number of attention heads. Defaults to 12.</p></li>
<li><p><strong>proj_type</strong> (<em>str</em><em>, </em><em>optional</em>) – patch embedding layer type. Defaults to “conv”.</p></li>
<li><p><strong>pos_embed_type</strong> (<em>str</em><em>, </em><em>optional</em>) – position embedding type. Defaults to “learnable”.</p></li>
<li><p><strong>classification</strong> (<em>bool</em><em>, </em><em>optional</em>) – bool argument to determine if classification is used. Defaults to False.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em><em>, </em><em>optional</em>) – number of classes if classification is used. Defaults to 2.</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – fraction of the input units to drop. Defaults to 0.0.</p></li>
<li><p><strong>spatial_dims</strong> (<em>int</em><em>, </em><em>optional</em>) – number of spatial dimensions. Defaults to 3.</p></li>
<li><p><strong>post_activation</strong> (<em>str</em><em>, </em><em>optional</em>) – add a final acivation function to the classification head
when <cite>classification</cite> is True. Default to “Tanh” for <cite>nn.Tanh()</cite>.
Set to other values to remove this function.</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em><em>, </em><em>optional</em>) – apply bias to the qkv linear layer in self attention block. Defaults to False.</p></li>
<li><p><strong>save_attn</strong> (<em>bool</em><em>, </em><em>optional</em>) – to make accessible the attention in self attention block. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for single channel input with image size of (96,96,96), conv position embedding and segmentation backbone</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">96</span><span class="p">),</span> <span class="n">proj_type</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="n">pos_embed_type</span><span class="o">=</span><span class="s1">&#39;sincos&#39;</span><span class="p">)</span>

<span class="c1"># for 3-channel with image size of (128,128,128), 24 layers and classification backbone</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">),</span> <span class="n">proj_type</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="n">pos_embed_type</span><span class="o">=</span><span class="s1">&#39;sincos&#39;</span><span class="p">,</span> <span class="n">classification</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># for 3-channel with image size of (224,224), 12 layers and classification backbone</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">),</span> <span class="n">proj_type</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="n">pos_embed_type</span><span class="o">=</span><span class="s1">&#39;sincos&#39;</span><span class="p">,</span> <span class="n">classification</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="o">&gt;&gt;&gt;</span>           <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ViT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vit.py#L121-L133"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ViT.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="restormer">
<h3><cite>Restormer</cite><a class="headerlink" href="#restormer" title="Link to this heading">#</a></h3>
<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.nets.restormer">
<span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">restormer</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/restormer.py#L0-L336"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.restormer" title="Link to this definition">#</a></dt>
<dd><p>alias of &lt;module ‘monai.networks.nets.restormer’ from ‘/home/gautham/MONAI/temp/MONAI-1.5.1/monai/networks/nets/restormer.py’&gt;</p>
</dd></dl>

</section>
<section id="vitautoenc">
<h3><cite>ViTAutoEnc</cite><a class="headerlink" href="#vitautoenc" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.ViTAutoEnc">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">ViTAutoEnc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconv_chns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vitautoenc.py#L28-L135"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ViTAutoEnc" title="Link to this definition">#</a></dt>
<dd><p>Vision Transformer (ViT), based on: “Dosovitskiy et al.,
An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale &lt;<a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>&gt;”</p>
<p>Modified to also give same dimension outputs as the input size of the image</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ViTAutoEnc.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconv_chns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vitautoenc.py#L36-L115"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ViTAutoEnc.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of input channels or the number of channels for input.</p></li>
<li><p><strong>img_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of input image.</p></li>
<li><p><strong>patch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of patch size</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels. Defaults to 1.</p></li>
<li><p><strong>deconv_chns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels for the deconvolution layers. Defaults to 16.</p></li>
<li><p><strong>hidden_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of hidden layer. Defaults to 768.</p></li>
<li><p><strong>mlp_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of feedforward layer. Defaults to 3072.</p></li>
<li><p><strong>num_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of transformer blocks. Defaults to 12.</p></li>
<li><p><strong>num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of attention heads. Defaults to 12.</p></li>
<li><p><strong>proj_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – position embedding layer type. Defaults to “conv”.</p></li>
<li><p><strong>dropout_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – fraction of the input units to drop. Defaults to 0.0.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions. Defaults to 3.</p></li>
<li><p><strong>qkv_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – apply bias to the qkv linear layer in self attention block. Defaults to False.</p></li>
<li><p><strong>save_attn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – to make accessible the attention in self attention block. Defaults to False. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for single channel input with image size of (96,96,96), conv position embedding and segmentation backbone</span>
<span class="c1"># It will provide an output of same size as that of the input</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">ViTAutoEnc</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">96</span><span class="p">),</span> <span class="n">proj_type</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">)</span>

<span class="c1"># for 3-channel with image size of (128,128,128), output will be same size as of input</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">ViTAutoEnc</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span> <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">),</span> <span class="n">proj_type</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.ViTAutoEnc.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/vitautoenc.py#L117-L135"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.ViTAutoEnc.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – input tensor must have isotropic spatial dimensions,
such as <code class="docutils literal notranslate"><span class="pre">[batch_size,</span> <span class="pre">channels,</span> <span class="pre">sp_size,</span> <span class="pre">sp_size[,</span> <span class="pre">sp_size]]</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="maskedautoencodervit">
<h3><cite>MaskedAutoEncoderViT</cite><a class="headerlink" href="#maskedautoencodervit" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.MaskedAutoEncoderViT">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">MaskedAutoEncoderViT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masking_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sincos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sincos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/masked_autoencoder_vit.py#L32-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.MaskedAutoEncoderViT" title="Link to this definition">#</a></dt>
<dd><p>Masked Autoencoder (ViT), based on: “Kaiming et al.,
Masked Autoencoders Are Scalable Vision Learners &lt;<a class="reference external" href="https://arxiv.org/abs/2111.06377">https://arxiv.org/abs/2111.06377</a>&gt;”
Only a subset of the patches passes through the encoder. The decoder tries to reconstruct
the masked patches, resulting in improved training speed.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.MaskedAutoEncoderViT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masking_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'conv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sincos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_pos_embed_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sincos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qkv_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/masked_autoencoder_vit.py#L40-L152"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.MaskedAutoEncoderViT.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of input channels or the number of channels for input.</p></li>
<li><p><strong>img_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of input image.</p></li>
<li><p><strong>patch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of patch size</p></li>
<li><p><strong>hidden_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of hidden layer. Defaults to 768.</p></li>
<li><p><strong>mlp_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of feedforward layer. Defaults to 512.</p></li>
<li><p><strong>num_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of transformer blocks. Defaults to 12.</p></li>
<li><p><strong>num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of attention heads. Defaults to 12.</p></li>
<li><p><strong>masking_ratio</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – ratio of patches to be masked. Defaults to 0.75.</p></li>
<li><p><strong>decoder_hidden_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of hidden layer for decoder. Defaults to 384.</p></li>
<li><p><strong>decoder_mlp_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of feedforward layer for decoder. Defaults to 512.</p></li>
<li><p><strong>decoder_num_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of transformer blocks for decoder. Defaults to 4.</p></li>
<li><p><strong>decoder_num_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of attention heads for decoder. Defaults to 12.</p></li>
<li><p><strong>proj_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – position embedding layer type. Defaults to “conv”.</p></li>
<li><p><strong>pos_embed_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – position embedding layer type. Defaults to “sincos”.</p></li>
<li><p><strong>decoder_pos_embed_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – position embedding layer type for decoder. Defaults to “sincos”.</p></li>
<li><p><strong>dropout_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – fraction of the input units to drop. Defaults to 0.0.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions. Defaults to 3.</p></li>
<li><p><strong>qkv_bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – apply bias to the qkv linear layer in self attention block. Defaults to False.</p></li>
<li><p><strong>save_attn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – to make accessible the attention in self attention block. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Examples::</dt><dd><p># for single channel input with image size of (96,96,96), and sin-cos positional encoding
&gt;&gt;&gt; net = MaskedAutoEncoderViT(in_channels=1, img_size=(96,96,96), patch_size=(16,16,16),
pos_embed_type=’sincos’)
# for 3-channel with image size of (128,128,128) and a learnable positional encoding
&gt;&gt;&gt; net = MaskedAutoEncoderViT(in_channels=3, img_size=128, patch_size=16, pos_embed_type=’learnable’)
# for 3-channel with image size of (224,224) and a masking ratio of 0.25
&gt;&gt;&gt; net = MaskedAutoEncoderViT(in_channels=3, img_size=(224,224), patch_size=(16,16), masking_ratio=0.25,
spatial_dims=2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.MaskedAutoEncoderViT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masking_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/masked_autoencoder_vit.py#L191-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.MaskedAutoEncoderViT.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="fullyconnectednet">
<h3><cite>FullyConnectedNet</cite><a class="headerlink" href="#fullyconnectednet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.FullyConnectedNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">FullyConnectedNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/fullyconnectednet.py#L31-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.FullyConnectedNet" title="Link to this definition">#</a></dt>
<dd><p>Simple full-connected layer neural network composed of a sequence of linear layers with PReLU activation and
dropout.  The network accepts input with <cite>in_channels</cite> channels, has output with <cite>out_channels</cite> channels, and
hidden layer output channels given in <cite>hidden_channels</cite>. If <cite>bias</cite> is True then linear units have a bias term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>hidden_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of output channels for each hidden layer.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in linear units. Defaults to True.</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – order of operations in <a class="reference internal" href="#monai.networks.blocks.ADN" title="monai.networks.blocks.ADN"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ADN</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># accepts 4 values and infers 3 values as output, has 3 hidden layers with 10, 20, 10 values as output</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.FullyConnectedNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/fullyconnectednet.py#L53-L82"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.FullyConnectedNet.__init__" title="Link to this definition">#</a></dt>
<dd><p>Defines a network accept input with <cite>in_channels</cite> channels, output of <cite>out_channels</cite> channels, and hidden layers
with channels given in <cite>hidden_channels</cite>. If <cite>bias</cite> is True then linear units have a bias term.</p>
</dd></dl>

</dd></dl>

</section>
<section id="varfullyconnectednet">
<h3><cite>VarFullyConnectedNet</cite><a class="headerlink" href="#varfullyconnectednet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.VarFullyConnectedNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">VarFullyConnectedNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/fullyconnectednet.py#L91-L185"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VarFullyConnectedNet" title="Link to this definition">#</a></dt>
<dd><p>Variational fully-connected network. This is composed of an encode layer, reparameterization layer, and then a
decode layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels.</p></li>
<li><p><strong>latent_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of latent variables to use.</p></li>
<li><p><strong>encode_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of output channels for each hidden layer of the encode half.</p></li>
<li><p><strong>decode_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of output channels for each hidden layer of the decode half.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in linear units. Defaults to True.</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – order of operations in <a class="reference internal" href="#monai.networks.blocks.ADN" title="monai.networks.blocks.ADN"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ADN</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># accepts inputs with 4 values, uses a latent space of 2 variables, and produces outputs of 3 values</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">VarFullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VarFullyConnectedNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/fullyconnectednet.py#L182-L185"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VarFullyConnectedNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="generator">
<h3><cite>Generator</cite><a class="headerlink" href="#generator" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Generator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latent_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/generator.py#L26-L151"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Generator" title="Link to this definition">#</a></dt>
<dd><p>Defines a simple generator network accepting a latent vector and through a sequence of convolution layers
constructs an output tensor of greater size and high dimensionality. The method <cite>_get_layer</cite> is used to
create each of these layers, override this method to define layers beyond the default
<a class="reference internal" href="#monai.networks.blocks.Convolution" title="monai.networks.blocks.Convolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.Convolution</span></code></a> or <a class="reference internal" href="#monai.networks.blocks.ResidualUnit" title="monai.networks.blocks.ResidualUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ResidualUnit</span></code></a> layers.</p>
<p>The layers are constructed using the values in the <cite>channels</cite> and <cite>strides</cite> arguments, the number being defined by
the length of these (which must match). Input is first passed through a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code> layer to
convert the input vector to an image tensor with dimensions <cite>start_shape</cite>. This passes through the convolution
layers and is progressively upsampled if the <cite>strides</cite> values are greater than 1 using transpose convolutions. The
size of the final output is defined by the <cite>start_shape</cite> dimension and the amount of upsampling done through
strides. In the default definition the size of the output’s spatial dimensions will be that of <cite>start_shape</cite>
multiplied by the product of <cite>strides</cite>, thus the example network below upsamples an starting size of (64, 8, 8)
to (1, 64, 64) since its <cite>strides</cite> are (2, 2, 2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latent_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the input latent vector (minus batch dimension)</p></li>
<li><p><strong>start_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the tensor to pass to convolution subnetwork</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the output channels of each convolutional layer</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the stride (upscale factor) of each convolutional layer</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – integer or tuple of integers stating size of convolutional kernels</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – integer stating number of convolutions in residual units, 0 means no residual units</p></li>
<li><p><strong>act</strong> – name or type defining activation layers</p></li>
<li><p><strong>norm</strong> – name or type defining normalization layers</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional float value in range [0, 1] stating dropout probability for layers, None for no dropout</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean stating if convolution layers should have a bias component</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 layers, latent input vector of shape (42, 24), output volume of shape (1, 64, 64)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">((</span><span class="mi">42</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Generator.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/generator.py#L146-L151"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Generator.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="regressor">
<h3><cite>Regressor</cite><a class="headerlink" href="#regressor" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Regressor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regressor.py#L29-L153"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Regressor" title="Link to this definition">#</a></dt>
<dd><p>This defines a network for relating large-sized input tensors to small output tensors, ie. regressing large
values to a prediction. An output of a single dimension can be used as value regression or multi-label
classification prediction, an output of a single value can be used as a discriminator or critic prediction.</p>
<p>The network is constructed as a sequence of layers, either <a class="reference internal" href="#monai.networks.blocks.Convolution" title="monai.networks.blocks.Convolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.Convolution</span></code></a> or
<a class="reference internal" href="#monai.networks.blocks.ResidualUnit" title="monai.networks.blocks.ResidualUnit"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ResidualUnit</span></code></a>, with a final fully-connected layer resizing the output from the
blocks to the final size. Each block is defined with a stride value typically used to downsample the input using
strided convolutions. In this way each block progressively condenses information from the input into a deep
representation the final fully-connected layer relates to a final result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the input tensor (minus batch dimension)</p></li>
<li><p><strong>out_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the final output tensor (minus batch dimension)</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the output channels of each convolutional layer</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the stride (downscale factor) of each convolutional layer</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – integer or tuple of integers stating size of convolutional kernels</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – integer stating number of convolutions in residual units, 0 means no residual units</p></li>
<li><p><strong>act</strong> – name or type defining activation layers</p></li>
<li><p><strong>norm</strong> – name or type defining normalization layers</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional float value in range [0, 1] stating dropout probability for layers, None for no dropout</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean stating if convolution layers should have a bias component</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># infers a 2-value result (eg. a 2D cartesian coordinate) from a 64x64 image</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Regressor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Regressor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/regressor.py#L149-L153"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Regressor.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="classifier">
<h3><cite>Classifier</cite><a class="headerlink" href="#classifier" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Classifier">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/classifier.py#L25-L65"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Classifier" title="Link to this definition">#</a></dt>
<dd><p>Defines a classification network from Regressor by specifying the output shape as a single dimensional tensor
with size equal to the number of classes to predict. The final activation function can also be specified, eg.
softmax or sigmoid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the input tensor (minus batch dimension)</p></li>
<li><p><strong>classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – integer stating the dimension of the final output tensor</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the output channels of each convolutional layer</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the stride (downscale factor) of each convolutional layer</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – integer or tuple of integers stating size of convolutional kernels</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – integer stating number of convolutions in residual units, 0 means no residual units</p></li>
<li><p><strong>act</strong> – name or type defining activation layers</p></li>
<li><p><strong>norm</strong> – name or type defining normalization layers</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional float value in range [0, 1] stating dropout probability for layers, None for no dropout</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean stating if convolution layers should have a bias component</p></li>
<li><p><strong>last_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – name defining the last activation layer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="discriminator">
<h3><cite>Discriminator</cite><a class="headerlink" href="#discriminator" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Discriminator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Discriminator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SIGMOID'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/classifier.py#L68-L99"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Discriminator" title="Link to this definition">#</a></dt>
<dd><p>Defines a discriminator network from Classifier with a single output value and sigmoid activation by default. This
is meant for use with GANs or other applications requiring a generic discriminator network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the input tensor (minus batch dimension)</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the output channels of each convolutional layer</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the stride (downscale factor) of each convolutional layer</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – integer or tuple of integers stating size of convolutional kernels</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – integer stating number of convolutions in residual units, 0 means no residual units</p></li>
<li><p><strong>act</strong> – name or type defining activation layers</p></li>
<li><p><strong>norm</strong> – name or type defining normalization layers</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional float value in range [0, 1] stating dropout probability for layers, None for no dropout</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean stating if convolution layers should have a bias component</p></li>
<li><p><strong>last_act</strong> – name defining the last activation layer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="critic">
<h3><cite>Critic</cite><a class="headerlink" href="#critic" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Critic">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Critic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/classifier.py#L102-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Critic" title="Link to this definition">#</a></dt>
<dd><p>Defines a critic network from Classifier with a single output value and no final activation. The final layer is
<cite>nn.Flatten</cite> instead of <cite>nn.Linear</cite>, the final result is computed as the mean over the first dimension. This is
meant to be used with Wasserstein GANs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the dimension of the input tensor (minus batch dimension)</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the output channels of each convolutional layer</p></li>
<li><p><strong>strides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – tuple of integers stating the stride (downscale factor) of each convolutional layer</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – integer or tuple of integers stating size of convolutional kernels</p></li>
<li><p><strong>num_res_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – integer stating number of convolutions in residual units, 0 means no residual units</p></li>
<li><p><strong>act</strong> – name or type defining activation layers</p></li>
<li><p><strong>norm</strong> – name or type defining normalization layers</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional float value in range [0, 1] stating dropout probability for layers, None for no dropout</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean stating if convolution layers should have a bias component</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Critic.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/classifier.py#L137-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Critic.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="transchex">
<h3><cite>Transchex</cite><a class="headerlink" href="#transchex" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Transchex">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Transchex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_language_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_vision_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mixed_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_probs_dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_checkpointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_norm_eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_position_embeddings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_embedding_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absolute'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4.10.2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30522</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size_feed_forward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_cross_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_or_repo_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert-base-uncased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pytorch_model.bin'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/transchex.py#L240-L376"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Transchex" title="Link to this definition">#</a></dt>
<dd><p>TransChex based on: “Hatamizadeh et al.,TransCheX: Self-Supervised Pretraining of Vision-Language
Transformers for Chest X-ray Analysis”</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Transchex.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_language_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_vision_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mixed_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_probs_dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_checkpointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_norm_eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_position_embeddings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_token_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_embedding_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absolute'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformers_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4.10.2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30522</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size_feed_forward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_cross_attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_or_repo_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert-base-uncased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pytorch_model.bin'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/transchex.py#L246-L362"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Transchex.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of input channels.</p></li>
<li><p><strong>img_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – dimension of input image.</p></li>
<li><p><strong>patch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – dimension of patch size.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of classes if classification is used.</p></li>
<li><p><strong>num_language_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of language transformer layers.</p></li>
<li><p><strong>num_vision_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of vision transformer layers.</p></li>
<li><p><strong>num_mixed_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of mixed transformer layers.</p></li>
<li><p><strong>drop_out</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – fraction of the input units to drop.</p></li>
<li><p><strong>path_or_repo_id</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>]) – This can be either:
- a string, the <em>model id</em> of a model repo on huggingface.co.
- a path to a <em>directory</em> potentially containing the file.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the file to locate in <cite>path_or_repo</cite>.</p></li>
</ul>
</dd>
</dl>
<p>The other parameters are part of the <cite>bert_config</cite> to <cite>MultiModal.from_pretrained</cite>.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># for 3-channel with image size of (224,224), patch size of (32,32), 3 classes, 2 language layers,</span>
<span class="c1"># 2 vision layers, 2 mixed modality layers and dropout of 0.2 in the classification head</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Transchex</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">img_size</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">),</span>
                     <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">num_language_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">num_vision_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">num_mixed_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                     <span class="n">drop_out</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Transchex.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_type_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vision_feats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/transchex.py#L364-L376"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Transchex.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="netadapter">
<h3><cite>NetAdapter</cite><a class="headerlink" href="#netadapter" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.NetAdapter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">NetAdapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('avg',</span> <span class="pre">{'kernel_size':</span> <span class="pre">7,</span> <span class="pre">'stride':</span> <span class="pre">1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/netadapter.py#L26-L123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.NetAdapter" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to replace the last layer of model by convolutional layer or FC layer.</p>
<p>See also: <a class="reference internal" href="#monai.networks.nets.TorchVisionFCModel" title="monai.networks.nets.TorchVisionFCModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.TorchVisionFCModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – a PyTorch model, which can be both 2D and 3D models. typically, it can be a pretrained model
in Torchvision, like: <code class="docutils literal notranslate"><span class="pre">resnet18</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet34</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet50</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet101</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet152</span></code>, etc.
more details: <a class="reference external" href="https://pytorch.org/vision/stable/models.html">https://pytorch.org/vision/stable/models.html</a>.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of classes for the last classification layer. Default to 1.</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of supported spatial dimensions in the specified model, depends on the model implementation.
default to 2 as most Torchvision models are for 2D image processing.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of the input channels of last layer. if None, get it from <cite>in_features</cite> of last layer.</p></li>
<li><p><strong>use_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use convolutional layer to replace the last layer, default to False.</p></li>
<li><p><strong>pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – parameters for the pooling layer, it should be a tuple, the first item is name of the pooling layer,
the second item is dictionary of the initialization args. if None, will not replace the <cite>layers[-2]</cite>.
default to <cite>(“avg”, {“kernel_size”: 7, “stride”: 1})</cite>.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – the bias value when replacing the last layer. if False, the layer will not learn an additive bias,
default to True.</p></li>
<li><p><strong>fc_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the corresponding layer attribute of the last fully connected layer. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;fc&quot;</span></code>.</p></li>
<li><p><strong>node_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the corresponding feature extractor node name of <cite>model</cite>.
Defaults to “”, the extractor is not in use.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.NetAdapter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/netadapter.py#L108-L123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.NetAdapter.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="torchvisionfcmodel">
<h3><cite>TorchVisionFCModel</cite><a class="headerlink" href="#torchvisionfcmodel" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.TorchVisionFCModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">TorchVisionFCModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'resnet18'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('avg',</span> <span class="pre">{'kernel_size':</span> <span class="pre">7,</span> <span class="pre">'stride':</span> <span class="pre">1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/torchvision_fc.py#L24-L131"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TorchVisionFCModel" title="Link to this definition">#</a></dt>
<dd><p>Customize the fully connected layer of (pretrained) TorchVision model or replace it by convolutional layer.</p>
<p>This class supports two primary use cases:</p>
<blockquote>
<div><ul>
<li><p>use <code class="docutils literal notranslate"><span class="pre">pool=None</span></code> to indicate no modification in the pooling layers. It should be used with <code class="docutils literal notranslate"><span class="pre">fc_name</span></code>
to locate the target FC layer to modify:
In this case, the class will load a torchvision classification model,
replace the last fully connected (FC) layer with a new FC layer with <code class="docutils literal notranslate"><span class="pre">num_classes</span></code> outputs,
example input arguments: <code class="docutils literal notranslate"><span class="pre">use_conv=False,</span> <span class="pre">pool=None,</span> <span class="pre">fc_name=&quot;heads.head&quot;</span></code>.
The <code class="docutils literal notranslate"><span class="pre">heads.head</span></code> specifies the target FC of the input model, could be found by <code class="docutils literal notranslate"><span class="pre">model.named_modules()</span></code>,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">vit_b_16</span>
<span class="nb">print</span><span class="p">([</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">vit_b_16</span><span class="p">()</span><span class="o">.</span><span class="n">named_modules</span><span class="p">()])</span>
</pre></div>
</div>
</li>
<li><p>use <code class="docutils literal notranslate"><span class="pre">pool=&quot;&quot;</span></code> or set it to a tuple of pooling parameters to indicate modifications of both
the pooling and the FC layer. It should be used with <code class="docutils literal notranslate"><span class="pre">node_name</span></code> to locate the model feature outputs:
In this case, the class will load a torchvision model, remove the existing pooling and FC layers, and</p>
<ul class="simple">
<li><p>append an additional convolution layer:
<code class="docutils literal notranslate"><span class="pre">use_conv=True,</span> <span class="pre">pool=&quot;&quot;,</span> <span class="pre">node_name=&quot;permute&quot;</span></code></p></li>
<li><p>append an additional pooling and FC layers:
<code class="docutils literal notranslate"><span class="pre">use_conv=False,</span> <span class="pre">pool=(&quot;avg&quot;,</span> <span class="pre">{&quot;kernel_size&quot;:</span> <span class="pre">7,</span> <span class="pre">&quot;stride&quot;:</span> <span class="pre">1}),</span> <span class="pre">node_name=&quot;permute&quot;</span></code></p></li>
<li><p>append an additional pooling and convolution layers:
<code class="docutils literal notranslate"><span class="pre">use_conv=True,</span> <span class="pre">pool=(&quot;avg&quot;,</span> <span class="pre">{&quot;kernel_size&quot;:</span> <span class="pre">7,</span> <span class="pre">&quot;stride&quot;:</span> <span class="pre">1}),</span> <span class="pre">node_name=&quot;permute&quot;</span></code></p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">permute</span></code> in the example is the target feature extraction node of the input
<cite>model_name</cite>, could be found by using the torchvision feature extraction utilities, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models.feature_extraction</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_graph_node_names</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">swin_t</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_graph_node_names</span><span class="p">(</span><span class="n">swin_t</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – name of any torchvision model with fully connected layer at the end.
<code class="docutils literal notranslate"><span class="pre">resnet18</span></code> (default), <code class="docutils literal notranslate"><span class="pre">resnet34</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet50</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet101</span></code>, <code class="docutils literal notranslate"><span class="pre">resnet152</span></code>,
<code class="docutils literal notranslate"><span class="pre">resnext50_32x4d</span></code>, <code class="docutils literal notranslate"><span class="pre">resnext101_32x8d</span></code>, <code class="docutils literal notranslate"><span class="pre">wide_resnet50_2</span></code>, <code class="docutils literal notranslate"><span class="pre">wide_resnet101_2</span></code>, <code class="docutils literal notranslate"><span class="pre">inception_v3</span></code>.
model details: <a class="reference external" href="https://pytorch.org/vision/stable/models.html">https://pytorch.org/vision/stable/models.html</a>.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of classes for the last classification layer. Default to 1.</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of supported spatial dimensions in the specified model, depends on the model implementation.
default to 2 as most Torchvision models are for 2D image processing.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – number of the input channels of last layer. if None, get it from <cite>in_features</cite> of last layer.</p></li>
<li><p><strong>use_conv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use convolutional layer to replace the last layer, default to False.</p></li>
<li><p><strong>pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – parameters for the pooling layer, when it’s a tuple, the first item is name of the pooling layer,
the second item is dictionary of the initialization args. If None, will not replace the <cite>layers[-2]</cite>.
default to <cite>(“avg”, {“kernel_size”: 7, “stride”: 1})</cite>. <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> indicates not adding a pooling layer.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – the bias value when replacing the last layer. if False, the layer will not learn an additive bias,
default to True.</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use the imagenet pretrained weights. Default to False.</p></li>
<li><p><strong>fc_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the corresponding layer attribute of the last fully connected layer. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;fc&quot;</span></code>.</p></li>
<li><p><strong>node_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the corresponding feature extractor node name of <cite>model</cite>. Defaults to “”, not in use.</p></li>
<li><p><strong>weights</strong> – additional weights enum for the torchvision model.</p></li>
<li><p><strong>kwargs</strong> – additional parameters for the torchvision model.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.models.inception</span><span class="w"> </span><span class="kn">import</span> <span class="n">Inception_V3_Weights</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">TorchVisionFCModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">TorchVisionFCModel</span><span class="p">(</span>
    <span class="s2">&quot;inception_v3&quot;</span><span class="p">,</span>
    <span class="n">num_classes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">weights</span><span class="o">=</span><span class="n">Inception_V3_Weights</span><span class="o">.</span><span class="n">IMAGENET1K_V1</span><span class="p">,</span>
    <span class="n">use_conv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># model = TorchVisionFCModel(&quot;vit_b_16&quot;, num_classes=4, pool=None, in_channels=768, fc_name=&quot;heads&quot;)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">299</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([2, 4])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="milmodel">
<h3><cite>MILModel</cite><a class="headerlink" href="#milmodel" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.MILModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">MILModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mil_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'att'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone_num_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/milmodel.py#L24-L237"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.MILModel" title="Link to this definition">#</a></dt>
<dd><p>Multiple Instance Learning (MIL) model, with a backbone classification model.
Currently, it only works for 2D images, a typical use case is for classification of the
digital pathology whole slide images. The expected shape of input data is <cite>[B, N, C, H, W]</cite>,
where <cite>B</cite> is the batch_size of PyTorch Dataloader and <cite>N</cite> is the number of instances
extracted from every original image in the batch. A tutorial example is available at:
<a class="github reference external" href="https://github.com/Project-MONAI/tutorials/tree/master/pathology/multiple_instance_learning">Project-MONAI/tutorials</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output classes.</p></li>
<li><p><strong>mil_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>MIL algorithm, available values (Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;att&quot;</span></code>):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code> - average features from all instances, equivalent to pure CNN (non MIL).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> - retain only the instance with the max probability for loss calculation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;att&quot;</span></code> - attention based MIL <a class="reference external" href="https://arxiv.org/abs/1802.04712">https://arxiv.org/abs/1802.04712</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;att_trans&quot;</span></code> - transformer MIL <a class="reference external" href="https://arxiv.org/abs/2111.01556">https://arxiv.org/abs/2111.01556</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;att_trans_pyramid&quot;</span></code> - transformer pyramid MIL <a class="reference external" href="https://arxiv.org/abs/2111.01556">https://arxiv.org/abs/2111.01556</a>.</p></li>
</ul>
</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – init backbone with pretrained weights, defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>backbone</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Backbone classifier CNN (either <code class="docutils literal notranslate"><span class="pre">None</span></code>, a <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> that returns features,
or a string name of a torchvision model).
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>, in which case ResNet50 is used.</p></li>
<li><p><strong>backbone_num_features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Number of output features of the backbone CNN
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> (necessary only when using a custom backbone)</p></li>
<li><p><strong>trans_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of the blocks in <cite>TransformEncoder</cite> layer.</p></li>
<li><p><strong>trans_dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout rate in <cite>TransformEncoder</cite> layer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.MILModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/milmodel.py#L227-L237"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.MILModel.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="dints">
<h3><cite>DiNTS</cite><a class="headerlink" href="#dints" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DiNTS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DiNTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dints_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('INSTANCE',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L317-L515"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DiNTS" title="Link to this definition">#</a></dt>
<dd><p>Reimplementation of DiNTS based on
“DiNTS: Differentiable Neural Network Topology Search for 3D Medical Image Segmentation
&lt;<a class="reference external" href="https://arxiv.org/abs/2103.15954">https://arxiv.org/abs/2103.15954</a>&gt;”.</p>
<p>The model contains a pre-defined multi-resolution stem block (defined in this class) and a
DiNTS space (defined in <a class="reference internal" href="#monai.networks.nets.TopologyInstance" title="monai.networks.nets.TopologyInstance"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.TopologyInstance</span></code></a> and
<a class="reference internal" href="#monai.networks.nets.TopologySearch" title="monai.networks.nets.TopologySearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.TopologySearch</span></code></a>).</p>
<p>The stem block is for: 1) input downsample and 2) output upsample to original size.
The model downsamples the input image by 2 (if <code class="docutils literal notranslate"><span class="pre">use_downsample=True</span></code>).
The downsampled image is downsampled by [1, 2, 4, 8] times (<code class="docutils literal notranslate"><span class="pre">num_depths=4</span></code>) and used as input to the
DiNTS search space (<code class="docutils literal notranslate"><span class="pre">TopologySearch</span></code>) or the DiNTS instance (<code class="docutils literal notranslate"><span class="pre">TopologyInstance</span></code>).</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TopologyInstance</span></code> is the final searched model. The initialization requires the searched architecture codes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TopologySearch</span></code> is a multi-path topology and cell operation search space.
The architecture codes will be initialized as one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TopologyConstruction</span></code> is the parent class which constructs the instance and search space.</p></li>
</ul>
</div></blockquote>
<p>To meet the requirements of the structure, the input size for each spatial dimension should be:
divisible by 2 ** (num_depths + 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dints_space</strong> – DiNTS search space. The value should be instance of <cite>TopologyInstance</cite> or <cite>TopologySearch</cite>.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input image channels.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output segmentation classes.</p></li>
<li><p><strong>act_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation name, default to ‘RELU’.</p></li>
<li><p><strong>norm_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – normalization used in convolution blocks. Default to <cite>InstanceNorm</cite>.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – spatial 2D or 3D inputs.</p></li>
<li><p><strong>use_downsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use downsample in the stem.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the search space will be in resolution [1, 1/2, 1/4, 1/8],
if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the search space will be in resolution [1/2, 1/4, 1/8, 1/16].</p></li>
<li><p><strong>node_a</strong> – node activation numpy matrix. Its shape is <cite>(num_depths, num_blocks + 1)</cite>.
+1 for multi-resolution inputs.
In model searching stage, <code class="docutils literal notranslate"><span class="pre">node_a</span></code> can be None. In deployment stage, <code class="docutils literal notranslate"><span class="pre">node_a</span></code> cannot be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.DiNTS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L485-L515"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DiNTS.forward" title="Link to this definition">#</a></dt>
<dd><p>Prediction based on dynamic arch_code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="topologyconstruction-for-dints">
<h3><cite>TopologyConstruction for DiNTS</cite><a class="headerlink" href="#topologyconstruction-for-dints" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.TopologyConstruction">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">TopologyConstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch_code=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_mul=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'monai.networks.nets.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks=6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name='RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name=('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device='cpu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L518-L632"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologyConstruction" title="Link to this definition">#</a></dt>
<dd><p>The base class for <cite>TopologyInstance</cite> and <cite>TopologySearch</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arch_code</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p><cite>[arch_code_a, arch_code_c]</cite>, numpy arrays. The architecture codes defining the model.
For example, for a <code class="docutils literal notranslate"><span class="pre">num_depths=4,</span> <span class="pre">num_blocks=12</span></code> search space:</p>
<ul>
<li><p><cite>arch_code_a</cite> is a 12x10 (10 paths) binary matrix representing if a path is activated.</p></li>
<li><p><cite>arch_code_c</cite> is a 12x10x5 (5 operations) binary matrix representing if a cell operation is used.</p></li>
<li><p><cite>arch_code</cite> in <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> is used for creating the network and remove unused network blocks. If None,</p></li>
</ul>
<p>all paths and cells operations will be used, and must be in the searching stage (is_search=True).</p>
</p></li>
<li><p><strong>channel_mul</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – adjust intermediate channel number, default is 1.</p></li>
<li><p><strong>cell</strong> – operation of each node.</p></li>
<li><p><strong>num_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of blocks (depth in the horizontal direction) of the DiNTS search space.</p></li>
<li><p><strong>num_depths</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of image resolutions of the DiNTS search space: 1, 1/2, 1/4 … in each dimension.</p></li>
<li><p><strong>use_downsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use downsample in the stem. If False, the search space will be in resolution [1, 1/2, 1/4, 1/8],
if True, the search space will be in resolution [1/2, 1/4, 1/8, 1/16].</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <cite>‘cpu’</cite>, <cite>‘cuda’</cite>, or device ID.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Predefined variables:</dt><dd><p><cite>filter_nums</cite>: default to 32. Double the number of channels after downsample.
topology related variables:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>arch_code2in</cite>: path activation to its incoming node index (resolution). For depth = 4,
arch_code2in = [0, 1, 0, 1, 2, 1, 2, 3, 2, 3]. The first path outputs from node 0 (top resolution),
the second path outputs from node 1 (second resolution in the search space),
the third path outputs from node 0, etc.</p></li>
<li><p><cite>arch_code2ops</cite>: path activation to operations of upsample 1, keep 0, downsample -1. For depth = 4,
arch_code2ops = [0, 1, -1, 0, 1, -1, 0, 1, -1, 0]. The first path does not change
resolution, the second path perform upsample, the third perform downsample, etc.</p></li>
<li><p><cite>arch_code2out</cite>: path activation to its output node index.
For depth = 4, arch_code2out = [0, 0, 1, 1, 1, 2, 2, 2, 3, 3],
the first and second paths connects to node 0 (top resolution), the 3,4,5 paths connects to node 1, etc.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologyConstruction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L630-L632"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologyConstruction.forward" title="Link to this definition">#</a></dt>
<dd><p>This function to be implemented by the architecture instances or search spaces.</p>
</dd></dl>

</dd></dl>

</section>
<section id="topologyinstance-for-dints">
<h3><cite>TopologyInstance for DiNTS</cite><a class="headerlink" href="#topologyinstance-for-dints" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.TopologyInstance">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">TopologyInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch_code=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_mul=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'monai.networks.nets.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks=6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name='RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name=('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device='cpu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L635-L688"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologyInstance" title="Link to this definition">#</a></dt>
<dd><p>Instance of the final searched architecture. Only used in re-training/inference stage.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologyInstance.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch_code=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_mul=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'monai.networks.nets.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks=6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name='RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name=('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device='cpu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L640-L670"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologyInstance.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize DiNTS topology search space of neural architectures.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologyInstance.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L672-L688"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologyInstance.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – input tensor.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="topologysearch-for-dints">
<h3><cite>TopologySearch for DiNTS</cite><a class="headerlink" href="#topologysearch-for-dints" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">TopologySearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_mul=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'monai.networks.nets.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_code=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks=6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name='RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name=('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device='cpu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L691-L1045"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch" title="Link to this definition">#</a></dt>
<dd><p>DiNTS topology search space of neural architectures.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets.dints</span><span class="w"> </span><span class="kn">import</span> <span class="n">TopologySearch</span>

<span class="n">topology_search_space</span> <span class="o">=</span> <span class="n">TopologySearch</span><span class="p">(</span>
    <span class="n">channel_mul</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_blocks</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_depths</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_downsample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">topology_search_space</span><span class="o">.</span><span class="n">get_ram_cost_usage</span><span class="p">(</span><span class="n">in_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">multi_res_images</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">topology_search_space</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">prediction</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># torch.Size([2, 16, 80, 80, 80])</span>
<span class="c1"># torch.Size([2, 32, 40, 40, 40])</span>
<span class="c1"># torch.Size([2, 64, 20, 20, 20])</span>
<span class="c1"># torch.Size([2, 128, 10, 10, 10])</span>
</pre></div>
</div>
<p>Class method overview:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_prob_a()</span></code>: convert learnable architecture weights to path activation probabilities.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_ram_cost_usage()</span></code>: get estimated ram cost.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_topology_entropy()</span></code>: get topology entropy loss in searching stage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decode()</span></code>: get final binarized architecture code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gen_mtx()</span></code>: generate variables needed for topology search.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Predefined variables:</dt><dd><ul class="simple">
<li><p><cite>tidx</cite>: index used to convert path activation matrix T = (depth,depth) in transfer_mtx to
path activation arch_code (1,3*depth-2), for depth = 4, tidx = [0, 1, 4, 5, 6, 9, 10, 11, 14, 15],
A tidx (10 binary values) represents the path activation.</p></li>
<li><p><cite>transfer_mtx</cite>: feasible path activation matrix (denoted as T) given a node activation pattern.
It is used to convert path activation pattern (1, paths) to node activation (1, nodes)</p></li>
<li><p><cite>node_act_list</cite>: all node activation [2^num_depths-1, depth]. For depth = 4, there are 15 node activation
patterns, each of length 4. For example, [1,1,0,0] means nodes 0, 1 are activated (with input paths).</p></li>
<li><p><cite>all_connect</cite>: All possible path activations. For depth = 4,
all_connection has 1024 vectors of length 10 (10 paths).
The return value will exclude path activation of all 0.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_mul=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell=&lt;class</span> <span class="pre">'monai.networks.nets.dints.Cell'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_code=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks=6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_depths=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name='RELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_name=('INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_downsample=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device='cpu'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L740-L800"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize DiNTS topology search space of neural architectures.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L947-L1021"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.decode" title="Link to this definition">#</a></dt>
<dd><p>Decode network log_alpha_a/log_alpha_c using dijkstra shortest path algorithm.</p>
<p><cite>[node_a, arch_code_a, arch_code_c, arch_code_a_max]</cite> is decoded when using <code class="docutils literal notranslate"><span class="pre">self.decode()</span></code>.</p>
<p>For example, for a <code class="docutils literal notranslate"><span class="pre">num_depths=4</span></code>, <code class="docutils literal notranslate"><span class="pre">num_blocks=12</span></code> search space:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node_a</span></code> is a 4x13 binary matrix representing if a feature node is activated
(13 because of multi-resolution inputs).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arch_code_a</span></code> is a 12x10 (10 paths) binary matrix representing if a path is activated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arch_code_c</span></code> is a 12x10x5 (5 operations) binary matrix representing if a cell operation is used.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>arch_code with maximum probability</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L1023-L1045"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.forward" title="Link to this definition">#</a></dt>
<dd><p>Prediction based on dynamic arch_code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – a list of <cite>num_depths</cite> input tensors as a multi-resolution input.
tensor is of shape <cite>BCHW[D]</cite> where <cite>C</cite> must match <cite>self.filter_nums</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.gen_mtx">
<span class="sig-name descname"><span class="pre">gen_mtx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L802-L839"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.gen_mtx" title="Link to this definition">#</a></dt>
<dd><p>Generate elements needed in decoding and topology.</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><cite>transfer_mtx</cite>: feasible path activation matrix (denoted as T) given a node activation pattern.</dt><dd><p>It is used to convert path activation pattern (1, paths) to node activation (1, nodes)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>node_act_list</cite>: all node activation [2^num_depths-1, depth]. For depth = 4, there are 15 node activation</dt><dd><p>patterns, each of length 4. For example, [1,1,0,0] means nodes 0, 1 are activated (with input paths).</p>
</dd>
</dl>
</li>
<li><p><cite>all_connect</cite>: All possible path activations. For depth = 4,
all_connection has 1024 vectors of length 10 (10 paths).
The return value will exclude path activation of all 0.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.get_prob_a">
<span class="sig-name descname"><span class="pre">get_prob_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L844-L874"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.get_prob_a" title="Link to this definition">#</a></dt>
<dd><p>Get final path and child model probabilities from architecture weights <cite>log_alpha_a</cite>.
This is used in forward pass, getting training loss, and final decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>child</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – return child probability (used in decoding)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the path activation probability of size:</dt><dd><p><cite>[number of blocks, number of paths in each block]</cite>.
For 12 blocks, 4 depths search space, the size is [12,10]</p>
</dd>
<dt>probs_a: The probability of all child models (size 1023x10). Each child model is a path activation pattern</dt><dd><p>(1D vector of length 10 for 10 paths). In total 1023 child models (2^10 -1)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>arch_code_prob_a</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.get_ram_cost_usage">
<span class="sig-name descname"><span class="pre">get_ram_cost_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L876-L907"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.get_ram_cost_usage" title="Link to this definition">#</a></dt>
<dd><p>Get estimated output tensor size to approximate RAM consumption.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_size</strong> – input image shape (4D/5D, <code class="docutils literal notranslate"><span class="pre">[BCHW[D]]</span></code>) at the highest resolution level.</p></li>
<li><p><strong>full</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – full ram cost usage with all probability of 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.TopologySearch.get_topology_entropy">
<span class="sig-name descname"><span class="pre">get_topology_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/dints.py#L909-L945"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.TopologySearch.get_topology_entropy" title="Link to this definition">#</a></dt>
<dd><p>Get topology entropy loss at searching stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probs</strong> – path activation probabilities</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="complexunet">
<h3><cite>ComplexUnet</cite><a class="headerlink" href="#complexunet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.complex_unet.</span></span><span class="sig-name descname"><span class="pre">ComplexUnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('LeakyReLU',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('instance',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_net</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/complex_unet.py#L29-L115"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet" title="Link to this definition">#</a></dt>
<dd><p>This variant of U-Net handles complex-value input/output. It can be
used as a model to learn sensitivity maps in multi-coil MRI data. It is
built based on <a class="reference internal" href="#monai.networks.nets.BasicUNet" title="monai.networks.nets.BasicUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.BasicUNet</span></code></a> by default but the user
can input their convolutional model as well.
ComplexUnet also applies default normalization to the input which makes it more stable to train.</p>
<p>The data being a (complex) 2-channel tensor is a requirement for using this model.</p>
<p>Modified and adopted from: <a class="github reference external" href="https://github.com/facebookresearch/fastMRI">facebookresearch/fastMRI</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – six integers as numbers of features. denotes number of channels in each layer.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to LeakyReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in convolution blocks. Defaults to True.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – dropout ratio. Defaults to 0.0.</p></li>
<li><p><strong>upsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – upsampling mode, available options are
<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>.</p></li>
<li><p><strong>pad_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – an integer denoting the number which each padded dimension will be divisible to.
For example, 16 means each dimension will be divisible by 16 after padding</p></li>
<li><p><strong>conv_net</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the learning model used inside the ComplexUnet. The default
is <code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.basic_unet</span></code>. The only requirement on the model is to
have 2 as input and output number of channels.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/complex_unet.py#L93-L115"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>output of shape (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="coilsensitivitymodel">
<h3><cite>CoilSensitivityModel</cite><a class="headerlink" href="#coilsensitivitymodel" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.coil_sensitivity_model.</span></span><span class="sig-name descname"><span class="pre">CoilSensitivityModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128,</span> <span class="pre">256,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('LeakyReLU',</span> <span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'negative_slope':</span> <span class="pre">0.1})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('instance',</span> <span class="pre">{'affine':</span> <span class="pre">True})</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deconv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coil_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_net</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/coil_sensitivity_model.py#L29-L142"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel" title="Link to this definition">#</a></dt>
<dd><p>This class uses a convolutional model to learn coil sensitivity maps for multi-coil MRI reconstruction.
The convolutional model is <code class="xref py py-class docutils literal notranslate"><span class="pre">monai.apps.reconstruction.networks.nets.complex_unet</span></code> by default
but can be specified by the user as well. Learning is done on the center of the under-sampled
kspace (that region is fully sampled).</p>
<p>The data being a (complex) 2-channel tensor is a requirement for using this model.</p>
<p>Modified and adopted from: <a class="github reference external" href="https://github.com/facebookresearch/fastMRI">facebookresearch/fastMRI</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>features</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – six integers as numbers of features. denotes number of channels in each layer.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – activation type and arguments. Defaults to LeakyReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to have a bias term in convolution blocks. Defaults to True.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]) – dropout ratio. Defaults to 0.0.</p></li>
<li><p><strong>upsample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – upsampling mode, available options are
<code class="docutils literal notranslate"><span class="pre">&quot;deconv&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pixelshuffle&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nontrainable&quot;</span></code>.</p></li>
<li><p><strong>coil_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – coil dimension in the data</p></li>
<li><p><strong>conv_net</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the learning model used to estimate the coil sensitivity maps. default
is <code class="xref py py-class docutils literal notranslate"><span class="pre">monai.apps.reconstruction.networks.nets.complex_unet</span></code>. The only
requirement on the model is to have 2 as input and output number of channels.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masked_kspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/coil_sensitivity_model.py#L115-L142"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>masked_kspace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the under-sampled kspace (which is the input measurement). Its shape
is (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data.</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the under-sampling mask with shape (1,1,1,W,1) for 2D data or (1,1,1,1,D,1) for 3D data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>predicted coil sensitivity maps with shape (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel.get_fully_sampled_region">
<span class="sig-name descname"><span class="pre">get_fully_sampled_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/coil_sensitivity_model.py#L88-L113"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel.get_fully_sampled_region" title="Link to this definition">#</a></dt>
<dd><p>Extracts the size of the fully-sampled part of the kspace. Note that when a kspace
is under-sampled, a part of its center is fully sampled. This part is called the Auto
Calibration Region (ACR). ACR is used for sensitivity map computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the under-sampling mask of shape (…, S, 1) where S denotes the sampling dimension</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tuple containing</dt><dd><ol class="arabic simple">
<li><p>left index of the region</p></li>
<li><p>right index of the region</p></li>
</ol>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Suppose the mask is of shape (1,1,20,1). If this function returns 8,12 as left and right</dt><dd><p>indices, then it means that the fully-sampled center region has size 4 starting from 8 to 12.</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="e2e-varnet">
<h3><cite>e2e-VarNet</cite><a class="headerlink" href="#e2e-varnet" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.varnet.VariationalNetworkModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.varnet.</span></span><span class="sig-name descname"><span class="pre">VariationalNetworkModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coil_sensitivity_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cascades</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/varnet.py#L25-L79"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.varnet.VariationalNetworkModel" title="Link to this definition">#</a></dt>
<dd><p>The end-to-end variational network (or simply e2e-VarNet) based on Sriram et. al., “End-to-end variational
networks for accelerated MRI reconstruction”.
It comprises several cascades each consisting of refinement and data consistency steps. The network takes in
the under-sampled kspace and estimates the ground-truth reconstruction.</p>
<p>Modified and adopted from: <a class="github reference external" href="https://github.com/facebookresearch/fastMRI">facebookresearch/fastMRI</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coil_sensitivity_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – A convolutional model for learning coil sensitivity maps. An example is
<a class="reference internal" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel" title="monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel</span></code></a>.</p></li>
<li><p><strong>refinement_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – A convolutional network used in the refinement step of e2e-VarNet. An example
is <a class="reference internal" href="#monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet" title="monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet</span></code></a>.</p></li>
<li><p><strong>num_cascades</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of cascades. Each cascade is a
<a class="reference internal" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock" title="monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock</span></code></a> which consists of
refinement and data consistency steps.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.varnet.VariationalNetworkModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masked_kspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/varnet.py#L57-L79"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.varnet.VariationalNetworkModel.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>masked_kspace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – The under-sampled kspace. It’s a 2D kspace (B,C,H,W,2)
with the last dimension being 2 (for real/imaginary parts) and C denoting the
coil dimension. 3D data will have the shape (B,C,H,W,D,2).</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – The under-sampling mask with shape (1,1,1,W,1) for 2D data or (1,1,1,1,D,1) for 3D data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The reconstructed image which is the root sum of squares (rss) of the absolute value</dt><dd><p>of the inverse fourier of the predicted kspace (note that rss combines coil images into one image).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="daf3d">
<h3><cite>DAF3D</cite><a class="headerlink" href="#daf3d" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.DAF3D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">DAF3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visual_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/daf3d.py#L466-L586"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DAF3D" title="Link to this definition">#</a></dt>
<dd><p>DAF3D network based on ‘Deep Attentive Features for Prostate Segmentation in 3D Transrectal Ultrasound’
&lt;<a class="reference external" href="https://arxiv.org/pdf/1907.01743.pdf">https://arxiv.org/pdf/1907.01743.pdf</a>&gt;.
The network consists of a 3D Feature Pyramid Network which is applied on the feature maps of a 3D ResNet,
followed by a custom Attention Module and an ASPP module.
During training the supervised signal consists of the outputs of the FPN (four Single Layer Features, SLFs),
the outputs of the attention module (four Attentive Features) and the final prediction.
They are individually compared to the ground truth, the final loss consists of a weighted sum of all
individual losses (see DAF3D tutorial for details).
There is an additional possiblity to return all supervised signals as well as the Attentive Maps in validation
mode to visualize inner functionality of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> – number of input channels.</p></li>
<li><p><strong>out_channels</strong> – number of output channels.</p></li>
<li><p><strong>visual_output</strong> – whether to return all SLFs, Attentive Maps, Refined SLFs in validation mode
can be used to visualize inner functionality of the network</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.DAF3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/daf3d.py#L549-L586"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.DAF3D.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="quicknat">
<h3><cite>Quicknat</cite><a class="headerlink" href="#quicknat" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.Quicknat">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">Quicknat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INSTANCE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NA'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/quicknat.py#L280-L441"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Quicknat" title="Link to this definition">#</a></dt>
<dd><p>Model for “Quick segmentation of NeuroAnaTomy (QuickNAT) based on a deep fully convolutional neural network.
Refer to: “QuickNAT: A Fully Convolutional Network for Quick and Accurate Segmentation of Neuroanatomy by
Abhijit Guha Roya, Sailesh Conjetib, Nassir Navabb, Christian Wachingera”</p>
<p>QuickNAT has an encoder/decoder like 2D F-CNN architecture with 4 encoders and 4 decoders separated by a bottleneck layer.
The final layer is a classifier block with softmax.
The architecture includes skip connections between all encoder and decoder blocks of the same spatial resolution,
similar to the U-Net architecture.
All Encoder and Decoder consist of three convolutional layers all with a Batch Normalization and ReLU.
The first two convolutional layers are followed by a concatenation layer that concatenates
the input feature map with outputs of the current and previous convolutional blocks.
The kernel size of the first two convolutional layers is 5*5, the third convolutional layer has a kernel size of 1*1.</p>
<p>Data in the encode path is downsampled using max pooling layers instead of upsamling like UNet and in the decode path
upsampled using max un-pooling layers instead of transpose convolutions.
The pooling is done at the beginning of the block and the unpool afterwards.
The indices of the max pooling in the Encoder are forwarded through the layer to be available to the corresponding Decoder.</p>
<p>The bottleneck block consists of a 5 * 5 convolutional layer and a batch normalization layer
to separate the encoder and decoder part of the network,
restricting information flow between the encoder and decoder.</p>
<p>The output feature map from the last decoder block is passed to the classifier block,
which is a convolutional layer with 1 * 1 kernel size that maps the input to an N channel feature map,
where N is the number of segmentation classes.</p>
<p>To further explain this consider the first example network given below. This network has 3 layers with strides
of 2 for each of the middle layers (the last layer is the bottom connection which does not down/up sample). Input
data to this network is immediately reduced in the spatial dimensions by a factor of 2 by the first convolution of
the residual unit defining the first layer of the encode part. The last layer of the decode part will upsample its
input (data from the previous layer concatenated with data from the skip connection) in the first convolution. this
ensures the final output of the network has the same shape as the input.</p>
<p>The original QuickNAT implementation included a <cite>enable_test_dropout()</cite> mechanism for uncertainty estimation during
testing. As the dropout layers are the only stochastic components of this network calling the train() method instead
of eval() in testing or inference has the same effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of classes to segmentate (output channels).</p></li>
<li><p><strong>num_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of input channels.</p></li>
<li><p><strong>num_filters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels for each convolutional layer in a Dense Block.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – size of the kernel of each convolutional layer in a Dense Block.</p></li>
<li><p><strong>kernel_c</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – convolution kernel size of classifier block kernel.</p></li>
<li><p><strong>stride_convolution</strong> – convolution stride. Defaults to 1.</p></li>
<li><p><strong>pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel size of the pooling layer,</p></li>
<li><p><strong>stride_pool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – stride for the pooling layer.</p></li>
<li><p><strong>se_block</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Squeeze and Excite block type to be included, defaults to None. Valid options : NONE, CSE, SSE, CSSE,</p></li>
<li><p><strong>droup_out</strong> – dropout ratio. Defaults to no dropout.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type and arguments. Defaults to PReLU.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – feature normalization type and arguments. Defaults to instance norm.</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the ordering of activation (A), normalization (N), and dropout (D).
Defaults to “NA”. See also: <a class="reference internal" href="#monai.networks.blocks.ADN" title="monai.networks.blocks.ADN"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.ADN</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuickNAT</span>

<span class="c1"># network with max pooling by a factor of 2 at each layer with no se_block.</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">QuickNAT</span><span class="p">(</span>
    <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">num_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">num_filters</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">se_block</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Quicknat.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/quicknat.py#L439-L441"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Quicknat.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.Quicknat.get_selayer">
<span class="sig-name descname"><span class="pre">get_selayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_block_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/quicknat.py#L409-L430"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.Quicknat.get_selayer" title="Link to this definition">#</a></dt>
<dd><p>Returns the SEBlock defined in the initialization of the QuickNAT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_filters</strong> – encoding half of the layer</p></li>
<li><p><strong>se_block_type</strong> – defaults to None. Valid options are None, CSE, SSE, CSSE</p></li>
</ul>
</dd>
</dl>
<p>Returns: Appropriate SEBlock. SSE and CSSE not implemented in Monai yet.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="monai.networks.nets.Quicknat.is_cuda">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_cuda</span></span><a class="headerlink" href="#monai.networks.nets.Quicknat.is_cuda" title="Link to this definition">#</a></dt>
<dd><p>Check if model parameters are allocated on the GPU.</p>
</dd></dl>

</dd></dl>

</section>
<section id="voxelmorph">
<h3><cite>VoxelMorph</cite><a class="headerlink" href="#voxelmorph" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.VoxelMorphUNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">VoxelMorphUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unet_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_conv_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_conv_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LEAKYRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LEAKYRELU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_maxpool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adn_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NDA'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/voxelmorph.py#L28-L334"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VoxelMorphUNet" title="Link to this definition">#</a></dt>
<dd><p>The backbone network used in VoxelMorph. See <a class="reference internal" href="#monai.networks.nets.VoxelMorph" title="monai.networks.nets.VoxelMorph"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.VoxelMorph</span></code></a> for more details.</p>
<p>A concatenated pair of images (moving and fixed) is first passed through a UNet. The output of the UNet is then
passed through a series of convolution blocks to produce the final prediction of the displacement field (DDF) or the
stationary velocity field (DVF).</p>
<p>In the original implementation, downsample is achieved through maxpooling, here one has the option to use either
maxpooling or strided convolution for downsampling. The default is to use maxpooling as it is consistent with the
original implementation. Note that for upsampling, the authors of VoxelMorph used nearest neighbor interpolation
instead of transposed convolution. In this implementation, only nearest neighbor interpolation is supported in order
to be consistent with the original implementation.</p>
<p>An instance of this class can be used as a backbone network for constructing a VoxelMorph network. See the
documentation of <a class="reference internal" href="#monai.networks.nets.VoxelMorph" title="monai.networks.nets.VoxelMorph"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.VoxelMorph</span></code></a> for more details and an example on how to construct a
VoxelMorph network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>in_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels in the input volume after concatenation of moving and fixed images.</p></li>
<li><p><strong>unet_out_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of channels in the output of the UNet.</p></li>
<li><p><strong>channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of channels in each layer of the UNet. See the following example for more details.</p></li>
<li><p><strong>final_conv_channels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – number of channels in each layer of the final convolution block.</p></li>
<li><p><strong>final_conv_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – activation type for the final convolution block. Defaults to LeakyReLU.
Since VoxelMorph was originally implemented in tensorflow where the default negative slope for
LeakyReLU was 0.2, we use the same default value here.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – kernel size for all convolution layers in the UNet. Defaults to 3.</p></li>
<li><p><strong>up_kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – kernel size for all convolution layers in the upsampling path of the UNet. Defaults to 3.</p></li>
<li><p><strong>act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – activation type for all convolution layers in the UNet. Defaults to LeakyReLU with negative slope 0.2.</p></li>
<li><p><strong>norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – feature normalization type and arguments for all convolution layers in the UNet. Defaults to None.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – dropout ratio for all convolution layers in the UNet. Defaults to 0.0 (no dropout).</p></li>
<li><p><strong>bias</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use bias in all convolution layers in the UNet. Defaults to True.</p></li>
<li><p><strong>use_maxpool</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use maxpooling in the downsampling path of the UNet. Defaults to True.
Using maxpooling is the consistent with the original implementation of VoxelMorph.
But one can optionally use strided convolution instead (i.e. set <cite>use_maxpool</cite> to False).</p></li>
<li><p><strong>adn_ordering</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – ordering of activation, dropout, and normalization. Defaults to “NDA”.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VoxelMorphUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concatenated_pairs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/voxelmorph.py#L332-L334"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VoxelMorphUNet.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.nets.VoxelMorph">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.nets.</span></span><span class="sig-name descname"><span class="pre">VoxelMorph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">half_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/voxelmorph.py#L340-L473"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VoxelMorph" title="Link to this definition">#</a></dt>
<dd><p>A re-implementation of VoxelMorph framework for medical image registration as described in
<a class="reference external" href="https://arxiv.org/pdf/1809.05231.pdf">https://arxiv.org/pdf/1809.05231.pdf</a>. For more details, please refer to VoxelMorph: A Learning Framework for
Deformable Medical Image Registration, Guha Balakrishnan, Amy Zhao, Mert R. Sabuncu, John Guttag, Adrian V. Dalca
IEEE TMI: Transactions on Medical Imaging. 2019. eprint arXiv:1809.05231.</p>
<p>This class is intended to be a general framework, based on which a deformable image registration
network can be built. Given a user-specified backbone network (e.g., UNet in the original VoxelMorph paper), this
class serves as a wrapper that concatenates the input pair of moving and fixed images, passes through the backbone
network, integrate the predicted stationary velocity field (DVF) from the backbone network to obtain the
displacement field (DDF), and, finally, warp the moving image using the DDF.</p>
<p>To construct a VoxelMorph network, one need to first construct a backbone network
(e.g., a <a class="reference internal" href="#monai.networks.nets.VoxelMorphUNet" title="monai.networks.nets.VoxelMorphUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.VoxelMorphUNet</span></code></a>) and pass it to the constructor of
<a class="reference internal" href="#monai.networks.nets.VoxelMorph" title="monai.networks.nets.VoxelMorph"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.nets.VoxelMorph</span></code></a>. The backbone network should be able to take a pair of moving and fixed
images as input and produce a DVF (or DDF, details to be discussed later) as output.</p>
<p>When <cite>forward</cite> is called, the input moving and fixed images are first concatenated along the channel dimension and
passed through the specified backbone network to produce the prediction of the displacement field (DDF) in the
non-diffeomorphic variant (i.e. when <cite>integration_steps</cite> is set to 0) or the stationary velocity field (DVF) in the
diffeomorphic variant (i.e. when <cite>integration_steps</cite> is set to a positive integer). The DVF is then integrated using
a scaling-and-squaring approach via a <a class="reference internal" href="#monai.networks.blocks.DVF2DDF" title="monai.networks.blocks.warp.DVF2DDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.warp.DVF2DDF</span></code></a> module to produce the DDF.
Finally, the DDF is used to warp the moving image to the fixed image using a
<a class="reference internal" href="#monai.networks.blocks.Warp" title="monai.networks.blocks.warp.Warp"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.blocks.warp.Warp</span></code></a> module. Optionally, the integration from DVF to DDF can be
performed on reduced resolution by specifying <cite>half_res</cite> to be True, in which case the output DVF from the backbone
network is first linearly interpolated to half resolution before integration. The output DDF is then linearly
interpolated again back to full resolution before being used to warp the moving image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backbone</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="#monai.networks.nets.VoxelMorphUNet" title="monai.networks.nets.voxelmorph.VoxelMorphUNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">VoxelMorphUNet</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a backbone network.</p></li>
<li><p><strong>integration_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of integration steps used for obtaining DDF from DVF via scaling-and-squaring.
Defaults to 7. If set to 0, the network will be non-diffeomorphic.</p></li>
<li><p><strong>half_res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to perform integration on half resolution. Defaults to False.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, defaults to 3.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">VoxelMorphUNet</span><span class="p">,</span> <span class="n">VoxelMorph</span>

<span class="c1"># The following example construct an instance of VoxelMorph that matches the original VoxelMorph paper</span>
<span class="c1"># https://arxiv.org/pdf/1809.05231.pdf</span>

<span class="c1"># First, a backbone network is constructed. In this case, we use a VoxelMorphUNet as the backbone network.</span>
<span class="n">backbone</span> <span class="o">=</span> <span class="n">VoxelMorphUNet</span><span class="p">(</span>
    <span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">in_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">unet_out_channels</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>  <span class="c1"># this indicates the down block at the top takes 16 channels as</span>
                                        <span class="c1"># input, the corresponding up block at the top produces 32</span>
                                        <span class="c1"># channels as output, the second down block takes 32 channels as</span>
                                        <span class="c1"># input, and the corresponding up block at the same level</span>
                                        <span class="c1"># produces 32 channels as output, etc.</span>
    <span class="n">final_conv_channels</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Then, a full VoxelMorph network is constructed using the specified backbone network.</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">VoxelMorph</span><span class="p">(</span>
    <span class="n">backbone</span><span class="o">=</span><span class="n">backbone</span><span class="p">,</span>
    <span class="n">integration_steps</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">half_res</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># A forward pass through the network would look something like this</span>
<span class="n">moving</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">fixed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">warped</span><span class="p">,</span> <span class="n">ddf</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">moving</span><span class="p">,</span> <span class="n">fixed</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.nets.VoxelMorph.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/nets/voxelmorph.py#L443-L473"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.nets.VoxelMorph.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="id24">
<h2>Utilities<a class="headerlink" href="#id24" title="Link to this heading">#</a></h2>
<p id="module-monai.networks.utils">Utilities and types for defining networks, these depend on PyTorch.</p>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.utils.CastTempType">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">CastTempType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporary_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submodule</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L1228-L1246"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.CastTempType" title="Link to this definition">#</a></dt>
<dd><p>Cast the input tensor to a temporary type before applying the submodule, and then cast it back to the initial type.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.utils.CastTempType.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L1239-L1246"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.CastTempType.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.convert_to_onnx">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_onnx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opset_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ort_provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_constant_folding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_size_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17179869184</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L661-L785"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.convert_to_onnx" title="Link to this definition">#</a></dt>
<dd><p>Utility to convert a model into ONNX model and optionally verify with ONNX or onnxruntime.
See also: <a class="reference external" href="https://pytorch.org/docs/stable/onnx.html">https://pytorch.org/docs/stable/onnx.html</a> for how to convert a PyTorch model to ONNX.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – source PyTorch model to save.</p></li>
<li><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – input sample data used by pytorch.onnx.export. It is also used in ONNX model verification.</p></li>
<li><p><strong>input_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional input names of the ONNX model.</p></li>
<li><p><strong>output_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional output names of the ONNX model.</p></li>
<li><p><strong>opset_version</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – version of the (ai.onnx) opset to target. Must be &gt;= 7 and not exceed</p></li>
<li><p><strong>PyTorch</strong> (<em>the latest opset version supported by</em>) – <a class="github reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md">onnx/onnx</a> and
<a class="github reference external" href="https://github.com/pytorch/pytorch/blob/master/torch/onnx/_constants.py">pytorch/pytorch</a></p></li>
<li><p><strong>details</strong> (<em>for more</em>) – <a class="github reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md">onnx/onnx</a> and
<a class="github reference external" href="https://github.com/pytorch/pytorch/blob/master/torch/onnx/_constants.py">pytorch/pytorch</a></p></li>
<li><p><strong>dynamic_axes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – specifies axes of tensors as dynamic (i.e. known only at run-time). If set to None,
the exported model will have the shapes of all input and output tensors set to match given
ones, for more details: <a class="reference external" href="https://pytorch.org/docs/stable/onnx.html#torch.onnx.export">https://pytorch.org/docs/stable/onnx.html#torch.onnx.export</a>.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional filename to save the ONNX model, if None, don’t save the ONNX model.</p></li>
<li><p><strong>verify</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to verify the ONNX model with ONNX or onnxruntime.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – target PyTorch device to verify the model, if None, use CUDA if available.</p></li>
<li><p><strong>use_ort</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use onnxruntime to verify the model.</p></li>
<li><p><strong>ort_provider&quot;</strong> – onnxruntime provider to use, default is [“CPUExecutionProvider”].</p></li>
<li><p><strong>rtol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the relative tolerance when comparing the outputs of PyTorch model and TorchScript model.</p></li>
<li><p><strong>atol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the absolute tolerance when comparing the outputs of PyTorch model and TorchScript model.</p></li>
<li><p><strong>use_trace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use <cite>torch.jit.trace</cite> to export the torchscript model.</p></li>
<li><p><strong>do_constant_folding</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – passed to onnx.export(). If True, extra polygraphy folding pass is done.</p></li>
<li><p><strong>constant_size_threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – passed to polygrapy conatant forling, default = 16M</p></li>
<li><p><strong>kwargs</strong> – if use_trace=True: additional arguments to pass to torch.onnx.export()
else: other arguments except <cite>obj</cite> for <cite>torch.jit.script()</cite> to convert model, for more details:
<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.jit.script.html">https://pytorch.org/docs/master/generated/torch.jit.script.html</a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.convert_to_torchscript">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_torchscript</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_or_obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L788-L855"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.convert_to_torchscript" title="Link to this definition">#</a></dt>
<dd><p>Utility to convert a model into TorchScript model and save to file,
with optional input / output data verification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – source PyTorch model to save.</p></li>
<li><p><strong>filename_or_obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if not None, specify a file-like object (has to implement write and flush)
or a string containing a file path name to save the TorchScript model.</p></li>
<li><p><strong>extra_files</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – map from filename to contents which will be stored as part of the save model file.
for more details: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.jit.save.html">https://pytorch.org/docs/stable/generated/torch.jit.save.html</a>.</p></li>
<li><p><strong>verify</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to verify the input and output of TorchScript model.
if <cite>filename_or_obj</cite> is not None, load the saved TorchScript model and verify.</p></li>
<li><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – input test data to verify model, should be a sequence of data, every item maps to a argument
of <cite>model()</cite> function.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – target device to verify the model, if None, use CUDA if available.</p></li>
<li><p><strong>rtol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the relative tolerance when comparing the outputs of PyTorch model and TorchScript model.</p></li>
<li><p><strong>atol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the absolute tolerance when comparing the outputs of PyTorch model and TorchScript model.</p></li>
<li><p><strong>use_trace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use <cite>torch.jit.trace</cite> to export the TorchScript model.</p></li>
<li><p><strong>kwargs</strong> – other arguments except <cite>obj</cite> for <cite>torch.jit.script()</cite> or <cite>torch.jit.trace()</cite> (if use_trace is True)
to convert model, for more details: <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.jit.script.html">https://pytorch.org/docs/master/generated/torch.jit.script.html</a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.convert_to_trt">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_trt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_or_obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_onnx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onnx_input_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('input_0',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onnx_output_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('output_0',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L932-L1068"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.convert_to_trt" title="Link to this definition">#</a></dt>
<dd><p>Utility to export a model into a TensorRT engine-based TorchScript model with optional input / output data verification.</p>
<p>There are two ways to export a model:
1, Torch-TensorRT way: PyTorch module —&gt; TorchScript module —&gt; TensorRT engine-based TorchScript.
2, ONNX-TensorRT way: PyTorch module —&gt; TorchScript module —&gt; ONNX model —&gt; TensorRT engine —&gt;
TensorRT engine-based TorchScript.</p>
<p>When exporting through the first way, some models suffer from the slowdown problem, since Torch-TensorRT
may only convert a little part of the PyTorch model to the TensorRT engine. However when exporting through
the second way, some Python data structures like <cite>dict</cite> are not supported. And some TorchScript models are
not supported by the ONNX if exported through <cite>torch.jit.script</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – a source PyTorch model to convert.</p></li>
<li><p><strong>precision</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the weight precision of the converted TensorRT engine based TorchScript models. Should be ‘fp32’ or ‘fp16’.</p></li>
<li><p><strong>input_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the input shape that is used to convert the model. Should be a list like [N, C, H, W] or
[N, C, H, W, D].</p></li>
<li><p><strong>dynamic_batchsize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a sequence with three elements to define the batch size range of the input for the model to be
converted. Should be a sequence like [MIN_BATCH, OPT_BATCH, MAX_BATCH]. After converted, the batchsize of model
input should between <cite>MIN_BATCH</cite> and <cite>MAX_BATCH</cite> and the <cite>OPT_BATCH</cite> is the best performance batchsize that the
TensorRT tries to fit. The <cite>OPT_BATCH</cite> should be the most frequently used input batchsize in the application,
default to None.</p></li>
<li><p><strong>use_trace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether using <cite>torch.jit.trace</cite> to convert the PyTorch model to a TorchScript model and then convert to
a TensorRT engine based TorchScript model or an ONNX model (if <cite>use_onnx</cite> is True), default to False.</p></li>
<li><p><strong>filename_or_obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if not None, specify a file-like object (has to implement write and flush) or a string containing a
file path name to load the TensorRT engine based TorchScript model for verifying.</p></li>
<li><p><strong>verify</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to verify the input and output of the TensorRT engine based TorchScript model.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the target GPU index to convert and verify the model. If None, use #0 GPU.</p></li>
<li><p><strong>use_onnx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – whether to use the ONNX-TensorRT way to export the TensorRT engine-based TorchScript model.</p></li>
<li><p><strong>onnx_input_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional input names of the ONNX model. This arg is only useful when <cite>use_onnx</cite> is True. Should be
a sequence like <cite>(‘input_0’, ‘input_1’, …, ‘input_N’)</cite> where N equals to the number of the model inputs. If not
given, will use <cite>(‘input_0’,)</cite>, which supposes the model only has one input.</p></li>
<li><p><strong>onnx_output_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – optional output names of the ONNX model. This arg is only useful when <cite>use_onnx</cite> is True. Should be
a sequence like <cite>(‘output_0’, ‘output_1’, …, ‘output_N’)</cite> where N equals to the number of the model outputs. If
not given, will use <cite>(‘output_0’,)</cite>, which supposes the model only has one output.</p></li>
<li><p><strong>rtol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the relative tolerance when comparing the outputs between the PyTorch model and TensorRT model.</p></li>
<li><p><strong>atol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the absolute tolerance when comparing the outputs between the PyTorch model and TensorRT model.</p></li>
<li><p><strong>kwargs</strong> – other arguments except <cite>module</cite>, <cite>inputs</cite>, <cite>enabled_precisions</cite> and <cite>device</cite> for <cite>torch_tensorrt.compile()</cite>
to compile model, for more details: <a class="reference external" href="https://pytorch.org/TensorRT/py_api/torch_tensorrt.html#torch-tensorrt-py">https://pytorch.org/TensorRT/py_api/torch_tensorrt.html#torch-tensorrt-py</a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.copy_model_state">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">copy_model_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L542-L624"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.copy_model_state" title="Link to this definition">#</a></dt>
<dd><p>Compute a module state_dict, of which the keys are the same as <cite>dst</cite>. The values of <cite>dst</cite> are overwritten
by the ones from <cite>src</cite> whenever their keys match. The method provides additional <cite>dst_prefix</cite> for
the <cite>dst</cite> key when matching them. <cite>mapping</cite> can be a <cite>{“src_key”: “dst_key”}</cite> dict, indicating
<cite>dst[dst_prefix + dst_key] = src[src_key]</cite>.
This function is mainly to return a model state dict
for loading the <cite>src</cite> model state into the <cite>dst</cite> model, <cite>src</cite> and <cite>dst</cite> can have different dict keys, but
their corresponding values normally have the same shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>]) – a pytorch module or state dict to be updated.</p></li>
<li><p><strong>src</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>]) – a pytorch module or state dict used to get the values used for the update.</p></li>
<li><p><strong>dst_prefix</strong> – <cite>dst</cite> key prefix, so that <cite>dst[dst_prefix + src_key]</cite>
will be assigned to the value of <cite>src[src_key]</cite>.</p></li>
<li><p><strong>mapping</strong> – a <cite>{“src_key”: “dst_key”}</cite> dict, indicating that <cite>dst[dst_prefix + dst_key]</cite>
to be assigned to the value of <cite>src[src_key]</cite>.</p></li>
<li><p><strong>exclude_vars</strong> – a regular expression to match the <cite>dst</cite> variable names,
so that their values are not overwritten by <cite>src</cite>.</p></li>
<li><p><strong>inplace</strong> – whether to set the <cite>dst</cite> module with the updated <cite>state_dict</cite> via <cite>load_state_dict</cite>.
This option is only available when <cite>dst</cite> is a <cite>torch.nn.Module</cite>.</p></li>
<li><p><strong>filter_func</strong> – a filter function used to filter the weights to be loaded.
See ‘filter_swinunetr’ in “monai.networks.nets.swin_unetr.py”.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.nets</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicUNet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy_model_state</span>

<span class="n">model_a</span> <span class="o">=</span> <span class="n">BasicUNet</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">model_b</span> <span class="o">=</span> <span class="n">BasicUNet</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model_a_b</span><span class="p">,</span> <span class="n">changed</span><span class="p">,</span> <span class="n">unchanged</span> <span class="o">=</span> <span class="n">copy_model_state</span><span class="p">(</span>
    <span class="n">model_a</span><span class="p">,</span> <span class="n">model_b</span><span class="p">,</span> <span class="n">exclude_vars</span><span class="o">=</span><span class="s2">&quot;conv_0.conv_0&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># dst model updated: 76 of 82 variables.</span>
<span class="n">model_a</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model_a_b</span><span class="p">)</span>
<span class="c1"># &lt;All keys matched successfully&gt;</span>
</pre></div>
</div>
<p>Returns: an OrderedDict of the updated <cite>dst</cite> state, the changed, and unchanged keys.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.eval_mode">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">eval_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">nets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#monai.networks.utils.eval_mode" title="Link to this definition">#</a></dt>
<dd><p>Set network(s) to eval mode and then return to original state at the end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – Input network(s)</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>  <span class="c1"># True</span>
<span class="k">with</span> <span class="n">eval_mode</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>  <span class="c1"># False</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">())</span>  <span class="c1"># will correctly raise an exception as gradients are calculated</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.get_profile_shapes">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">get_profile_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_batchsize</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L76-L93"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.get_profile_shapes" title="Link to this definition">#</a></dt>
<dd><p>Given a sample input shape, calculate min/opt/max shapes according to dynamic_batchsize.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.get_state_dict">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">get_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L528-L539"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.get_state_dict" title="Link to this definition">#</a></dt>
<dd><p>Get the state dict of input object if has <cite>state_dict</cite>, otherwise, return object directly.
For data parallel model, automatically convert it to regular model first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>]) – input object to check and get the state_dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.has_nvfuser_instance_norm">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">has_nvfuser_instance_norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L96-L113"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.has_nvfuser_instance_norm" title="Link to this definition">#</a></dt>
<dd><p>whether the current environment has InstanceNorm3dNVFuser
<a class="github reference external" href="https://github.com/NVIDIA/apex/blob/23.05-devel/apex/normalization/instance_norm.py#L15-L16">NVIDIA/apex</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.icnr_init">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">icnr_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init=&lt;function</span> <span class="pre">kaiming_normal_&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L350-L367"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.icnr_init" title="Link to this definition">#</a></dt>
<dd><p>ICNR initialization for 2D/3D kernels adapted from Aitken et al.,2017 , “Checkerboard artifact free
sub-pixel convolution”.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.look_up_named_module">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">look_up_named_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_all_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L116-L144"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.look_up_named_module" title="Link to this definition">#</a></dt>
<dd><p>get the named module in <cite>mod</cite> by the attribute name,
for example <code class="docutils literal notranslate"><span class="pre">look_up_named_module(net,</span> <span class="pre">&quot;features.3.1.attn&quot;)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the module attribute.</p></li>
<li><p><strong>mod</strong> – a pytorch module to be searched (in <code class="docutils literal notranslate"><span class="pre">mod.named_modules()</span></code>).</p></li>
<li><p><strong>print_all_options</strong> – whether to print all named modules when <cite>name</cite> is not found in <cite>mod</cite>. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding pytorch module’s subcomponent such as <code class="docutils literal notranslate"><span class="pre">net.features[3][1].attn</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.normal_init">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">normal_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std=0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal_func=&lt;function</span> <span class="pre">normal_&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L329-L347"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.normal_init" title="Link to this definition">#</a></dt>
<dd><p>Initialize the weight and bias tensors of <cite>m’ and its submodules to values from a normal distribution with a
stddev of `std’. Weight tensors of convolution and linear modules are initialized with a mean of 0, batch
norm modules with a mean of 1. The callable `normal_func’, used to assign values, should have the same arguments
as its default normal_(). This can be used with `nn.Module.apply</cite> to visit submodules of a network.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.normalize_transform">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">normalize_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L243-L286"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.normalize_transform" title="Link to this definition">#</a></dt>
<dd><p>Compute an affine matrix according to the input shape.
The transform normalizes the homogeneous image coordinates to the
range of <cite>[-1, 1]</cite>.  Currently the following source coordinates are supported:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>align_corners=False</cite>, <cite>zero_centered=False</cite>, normalizing from <code class="docutils literal notranslate"><span class="pre">[-0.5,</span> <span class="pre">d-0.5]</span></code>.</p></li>
<li><p><cite>align_corners=True</cite>, <cite>zero_centered=False</cite>, normalizing from <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">d-1]</span></code>.</p></li>
<li><p><cite>align_corners=False</cite>, <cite>zero_centered=True</cite>, normalizing from <code class="docutils literal notranslate"><span class="pre">[-(d-1)/2,</span> <span class="pre">(d-1)/2]</span></code>.</p></li>
<li><p><cite>align_corners=True</cite>, <cite>zero_centered=True</cite>, normalizing from <code class="docutils literal notranslate"><span class="pre">[-d/2,</span> <span class="pre">d/2]</span></code>.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> – input spatial shape, a sequence of integers.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – device on which the returned affine will be allocated.</p></li>
<li><p><strong>dtype</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – data type of the returned affine</p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, consider -1 and 1 to refer to the centers of the
corner pixels rather than the image corners.
See also: <a class="reference external" href="https://pytorch.org/docs/stable/nn.functional.html#torch.nn.functional.grid_sample">https://pytorch.org/docs/stable/nn.functional.html#torch.nn.functional.grid_sample</a></p></li>
<li><p><strong>zero_centered</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the coordinates are normalized from a zero-centered range, default to <cite>False</cite>.
Setting this flag and <cite>align_corners</cite> will jointly specify the normalization source range.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.one_hot">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L170-L220"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.one_hot" title="Link to this definition">#</a></dt>
<dd><p>For every value v in <cite>labels</cite>, the value in the output will be either 1 or 0. Each vector along the <cite>dim</cite>-th
dimension has the “one-hot” format, i.e., it has a total length of <cite>num_classes</cite>,
with a one and <cite>num_class-1</cite> zeros.
Note that this will include the background label, thus a binary mask should be treated as having two classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input tensor of integers to be converted into the ‘one-hot’ format. Internally <cite>labels</cite> will be
converted into integers <cite>labels.long()</cite>.</p></li>
<li><p><strong>num_classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of output channels, the corresponding length of <cite>labels[dim]</cite> will be converted to
<cite>num_classes</cite> from <cite>1</cite>.</p></li>
<li><p><strong>dtype</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>) – the data type of the output one_hot label.</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the dimension to be converted to <cite>num_classes</cite> channels from <cite>1</cite> channel, should be non-negative number.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<p>For a tensor <cite>labels</cite> of dimensions [B]1[spatial_dims], return a tensor of dimensions <cite>[B]N[spatial_dims]</cite>
when <cite>num_classes=N</cite> number of classes and <cite>dim=1</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">one_hot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">one_hot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([2, 2, 2, 2])</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">one_hot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([2, 2, 2, 2, 2])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.pixelshuffle">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">pixelshuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L370-L412"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.pixelshuffle" title="Link to this definition">#</a></dt>
<dd><p>Apply pixel shuffle to the tensor <cite>x</cite> with spatial dimensions <cite>spatial_dims</cite> and scaling factor <cite>scale_factor</cite>.</p>
<p>See: Shi et al., 2016, “Real-Time Single Image and Video Super-Resolution
Using a nEfficient Sub-Pixel Convolutional Neural Network.”</p>
<p>See: Aitken et al., 2017, “Checkerboard artifact free sub-pixel convolution”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Input tensor with shape BCHW[D]</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, typically 2 or 3 for 2D or 3D</p></li>
<li><p><strong>scale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – factor to rescale the spatial dimensions by, must be &gt;=1</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reshuffled version of <cite>x</cite>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When input channels of <cite>x</cite> are not divisible by (scale_factor ** spatial_dims)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.pixelunshuffle">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">pixelunshuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L415-L454"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.pixelunshuffle" title="Link to this definition">#</a></dt>
<dd><p>Apply pixel unshuffle to the tensor <cite>x</cite> with spatial dimensions <cite>spatial_dims</cite> and scaling factor <cite>scale_factor</cite>.
Inverse operation of pixelshuffle.</p>
<p>See: Shi et al., 2016, “Real-Time Single Image and Video Super-Resolution
Using an Efficient Sub-Pixel Convolutional Neural Network.”</p>
<p>See: Aitken et al., 2017, “Checkerboard artifact free sub-pixel convolution”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Input tensor with shape BCHW[D]</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, typically 2 or 3 for 2D or 3D</p></li>
<li><p><strong>scale_factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – factor to reduce the spatial dimensions by, must be &gt;=1</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Unshuffled version of <cite>x</cite> with shape (B, C*(r**d), H/r, W/r) for 2D
or (B, C*(r**d), D/r, H/r, W/r) for 3D, where r is the scale_factor
and d is spatial_dims.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When spatial dimensions are not divisible by scale_factor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.predict_segmentation">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">predict_segmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutually_exclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L223-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.predict_segmentation" title="Link to this definition">#</a></dt>
<dd><p>Given the logits from a network, computing the segmentation by thresholding all values above 0
if multi-labels task, computing the <cite>argmax</cite> along the channel axis if multi-classes task,
logits has shape <cite>BCHW[D]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – raw data of model output.</p></li>
<li><p><strong>mutually_exclusive</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, <cite>logits</cite> will be converted into a binary matrix using
a combination of argmax, which is suitable for multi-classes task. Defaults to False.</p></li>
<li><p><strong>threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – thresholding the prediction values if multi-labels task.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.replace_modules">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">replace_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L1123-L1157"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.replace_modules" title="Link to this definition">#</a></dt>
<dd><p>Replace sub-module(s) in a parent module.</p>
<p>The name of the module to be replace can be nested e.g.,
<cite>features.denseblock1.denselayer1.layers.relu1</cite>. If this is the case (there are “.”
in the module name), then this function will recursively call itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – module that contains the module to be replaced</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – name of module to be replaced. Can include “.”.</p></li>
<li><p><strong>new_module</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – <cite>torch.nn.Module</cite> to be placed at position <cite>name</cite> inside <cite>parent</cite>. This will
be deep copied if <cite>strict_match == False</cite> multiple instances are independent.</p></li>
<li><p><strong>strict_match</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if <cite>True</cite>, module name must <cite>== name</cite>. If false then
<cite>name in named_modules()</cite> will be used. <cite>True</cite> can be used to change just
one module, whereas <cite>False</cite> can be used to replace all modules with similar
name (e.g., <cite>relu</cite>).</p></li>
<li><p><strong>match_device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if <cite>True</cite>, the device of the new module will match the model. Requires all
of <cite>parent</cite> to be on the same device.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of tuples of replaced modules. Element 0 is module name, element 1 is the replaced module.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AttributeError</strong> – if <cite>strict_match</cite> is <cite>True</cite> and <cite>name</cite> is not a named module in <cite>parent</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.replace_modules_temp">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">replace_modules_temp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#monai.networks.utils.replace_modules_temp" title="Link to this definition">#</a></dt>
<dd><p>Temporarily replace sub-module(s) in a parent module (context manager).</p>
<p>See <a class="reference internal" href="#monai.networks.utils.replace_modules" title="monai.networks.utils.replace_modules"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.networks.utils.replace_modules</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.save_state">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L627-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.save_state" title="Link to this definition">#</a></dt>
<dd><p>Save the state dict of input source data with PyTorch <cite>save</cite>.
It can save <cite>nn.Module</cite>, <cite>state_dict</cite>, a dictionary of <cite>nn.Module</cite> or <cite>state_dict</cite>.
And automatically convert the data parallel module to regular module.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">save_state</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="n">save_state</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">path</span><span class="p">)</span>
<span class="n">save_state</span><span class="p">({</span><span class="s2">&quot;net&quot;</span><span class="p">:</span> <span class="n">net</span><span class="p">,</span> <span class="s2">&quot;opt&quot;</span><span class="p">:</span> <span class="n">opt</span><span class="p">},</span> <span class="n">path</span><span class="p">)</span>
<span class="n">net_dp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">DataParallel</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="n">save_state</span><span class="p">(</span><span class="n">net_dp</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Refer to: <a class="reference external" href="https://pytorch.org/ignite/v0.4.8/generated/ignite.handlers.DiskSaver.html">https://pytorch.org/ignite/v0.4.8/generated/ignite.handlers.DiskSaver.html</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – input data to save, can be <cite>nn.Module</cite>, <cite>state_dict</cite>, a dictionary of <cite>nn.Module</cite> or <cite>state_dict</cite>.</p></li>
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>]) – target file path to save the input object.</p></li>
<li><p><strong>kwargs</strong> – other args for the <cite>save_obj</cite> except for the <cite>obj</cite> and <cite>path</cite>.
default <cite>func</cite> is <cite>torch.save()</cite>, details of the args:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.save.html">https://pytorch.org/docs/stable/generated/torch.save.html</a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.set_named_module">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">set_named_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_layer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L147-L167"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.set_named_module" title="Link to this definition">#</a></dt>
<dd><p>look up <cite>name</cite> in <cite>mod</cite> and replace the layer with <cite>new_layer</cite>, return the updated <cite>mod</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mod</strong> – a pytorch module to be updated.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a string representing the target module attribute.</p></li>
<li><p><strong>new_layer</strong> – a new module replacing the corresponding layer at <code class="docutils literal notranslate"><span class="pre">mod.name</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an updated <code class="docutils literal notranslate"><span class="pre">mod</span></code></p>
</dd>
</dl>
<p>See also: <a class="reference internal" href="#monai.networks.utils.look_up_named_module" title="monai.networks.utils.look_up_named_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">monai.networks.utils.look_up_named_module()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.to_norm_affine">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">to_norm_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">affine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/utils.py#L289-L326"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.utils.to_norm_affine" title="Link to this definition">#</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">affine</span></code> defined for coordinates in the pixel space, compute the corresponding affine
for the normalized coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>affine</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Nxdxd batched square matrix</p></li>
<li><p><strong>src_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – source image spatial shape</p></li>
<li><p><strong>dst_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – target image spatial shape</p></li>
<li><p><strong>align_corners</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, consider -1 and 1 to refer to the centers of the
corner pixels rather than the image corners.
See also: <a class="reference external" href="https://pytorch.org/docs/stable/nn.functional.html#torch.nn.functional.grid_sample">https://pytorch.org/docs/stable/nn.functional.html#torch.nn.functional.grid_sample</a></p></li>
<li><p><strong>zero_centered</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the coordinates are normalized from a zero-centered range, default to <cite>False</cite>.
See also: <a class="reference internal" href="#monai.networks.utils.normalize_transform" title="monai.networks.utils.normalize_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">monai.networks.utils.normalize_transform()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">affine</span></code> is not a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">affine</span></code> is not Nxdxd.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">src_size</span></code> or <code class="docutils literal notranslate"><span class="pre">dst_size</span></code> dimensions differ from <code class="docutils literal notranslate"><span class="pre">affine</span></code>.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.networks.utils.train_mode">
<span class="sig-prename descclassname"><span class="pre">monai.networks.utils.</span></span><span class="sig-name descname"><span class="pre">train_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">nets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#monai.networks.utils.train_mode" title="Link to this definition">#</a></dt>
<dd><p>Set network(s) to train mode and then return to original state at the end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – Input network(s)</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>  <span class="c1"># False</span>
<span class="k">with</span> <span class="n">train_mode</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>  <span class="c1"># True</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">())</span>  <span class="c1"># No exception</span>
</pre></div>
</div>
</dd></dl>

<p id="module-monai.apps.reconstruction.networks.nets.utils">This script contains utility functions for developing new networks/blocks in PyTorch.</p>
<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.complex_normalize">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">complex_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L129-L166"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.complex_normalize" title="Link to this definition">#</a></dt>
<dd><p>Performs layer mean-std normalization for complex data. Normalization is done for each batch member
along each part (part refers to real and imaginary parts), separately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C,H,W) for 2D data or (B,C,H,W,D) for 3D data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tuple containing</dt><dd><ol class="arabic simple">
<li><p>normalized output of shape (B,C,H,W) for 2D data or (B,C,H,W,D) for 3D data</p></li>
<li><p>mean</p></li>
<li><p>std</p></li>
</ol>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.divisible_pad_t">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">divisible_pad_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L169-L228"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.divisible_pad_t" title="Link to this definition">#</a></dt>
<dd><p>Pad input to feed into the network (torch script compatible)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C,H,W) for 2D data or (B,C,H,W,D) for 3D data</p></li>
<li><p><strong>k</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – padding factor. each padded dimension will be divisible by k.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tuple containing</dt><dd><ol class="arabic simple">
<li><p>padded input</p></li>
<li><p>pad sizes (in order to reverse padding if needed)</p></li>
</ol>
</dd>
</dl>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># 2D data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">70</span><span class="p">])</span>
<span class="n">x_pad</span><span class="p">,</span><span class="n">padding_sizes</span> <span class="o">=</span> <span class="n">divisible_pad_t</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># the following line should print (3, 2, 64, 80)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_pad</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># 3D data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">])</span>
<span class="n">x_pad</span><span class="p">,</span><span class="n">padding_sizes</span> <span class="o">=</span> <span class="n">divisible_pad_t</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># the following line should print (3, 2, 64, 80, 80)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_pad</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.floor_ceil">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">floor_ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L256-L268"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.floor_ceil" title="Link to this definition">#</a></dt>
<dd><p>Returns floor and ceil of the input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – input number</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>floor(n)</p></li>
<li><p>ceil(n)</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.inverse_divisible_pad_t">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">inverse_divisible_pad_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_sizes</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L231-L253"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.inverse_divisible_pad_t" title="Link to this definition">#</a></dt>
<dd><p>De-pad network output to match its original shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C,H,W) for 2D data or (B,C,H,W,D) for 3D data</p></li>
<li><p><strong>pad_sizes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – padding values</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>de-padded input</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.reshape_batch_channel_to_channel_dim">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">reshape_batch_channel_to_channel_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L104-L126"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.reshape_batch_channel_to_channel_dim" title="Link to this definition">#</a></dt>
<dd><p>Detaches batch and channel dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B*C,1,H,W,2) for 2D data or (B*C,1,H,W,D,2) for 3D data</p></li>
<li><p><strong>batch_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – batch size</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>output of shape (B,C,…)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.reshape_channel_complex_to_last_dim">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">reshape_channel_complex_to_last_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L52-L76"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.reshape_channel_complex_to_last_dim" title="Link to this definition">#</a></dt>
<dd><p>Swaps the complex dimension with the channel dimension so that the network output has 2 as its last dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C*2,H,W) for 2D data or (B,C*2,H,W,D) for 3D data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>output of shape (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.reshape_channel_to_batch_dim">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">reshape_channel_to_batch_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L79-L101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.reshape_channel_to_batch_dim" title="Link to this definition">#</a></dt>
<dd><p>Combines batch and channel dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>output of shape (B*C,1,…)</p></li>
<li><p>batch size</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.reshape_complex_to_channel_dim">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">reshape_complex_to_channel_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L26-L49"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.reshape_complex_to_channel_dim" title="Link to this definition">#</a></dt>
<dd><p>Swaps the complex dimension with the channel dimension so that the network treats real/imaginary
parts as two separate channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input of shape (B,C,H,W,2) for 2D data or (B,C,H,W,D,2) for 3D data</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>output of shape (B,C*2,H,W) for 2D data or (B,C*2,H,W,D) for 3D data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.sensitivity_map_expand">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">sensitivity_map_expand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sens_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L291-L308"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.sensitivity_map_expand" title="Link to this definition">#</a></dt>
<dd><p>Expands an image to its corresponding coil images based on the given sens_maps. Let’s say there
are C coils. This function multiples image img with each coil sensitivity map in sens_maps and stacks
the resulting C coil images along the channel dimension which is reserved for coils.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – 2D image (B,1,H,W,2) with the last dimension being 2 (for real/imaginary parts). 3D data will have
the shape (B,1,H,W,D,2).</p></li>
<li><p><strong>sens_maps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Sensitivity maps for combining coil images. The shape is (B,C,H,W,2) for 2D data
or (B,C,H,W,D,2) for 3D data (C denotes the coil dimension).</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – is 2 for 2D data and is 3 for 3D data</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Expansion of x to (B,C,H,W,2) for 2D data and (B,C,H,W,D,2) for 3D data. The output is transferred</dt><dd><p>to the frequency domain to yield coil measurements.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="monai.apps.reconstruction.networks.nets.utils.sensitivity_map_reduce">
<span class="sig-prename descclassname"><span class="pre">monai.apps.reconstruction.networks.nets.utils.</span></span><span class="sig-name descname"><span class="pre">sensitivity_map_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sens_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/apps/reconstruction/networks/nets/utils.py#L271-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.apps.reconstruction.networks.nets.utils.sensitivity_map_reduce" title="Link to this definition">#</a></dt>
<dd><p>Reduces coil measurements to a corresponding image based on the given sens_maps. Let’s say there
are C coil measurements inside kspace, then this function multiplies the conjugate of each coil sensitivity map with the
corresponding coil image. The result of this process will be C images. Summing those images together gives the
resulting “reduced image.”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kspace</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – 2D kspace (B,C,H,W,2) with the last dimension being 2 (for real/imaginary parts) and C denoting the
coil dimension. 3D data will have the shape (B,C,H,W,D,2).</p></li>
<li><p><strong>sens_maps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – sensitivity maps of the same shape as input x.</p></li>
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – is 2 for 2D data and is 3 for 3D data</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>reduction of x to (B,1,H,W,2) for 2D data or (B,1,H,W,D,2) for 3D data.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-monai.networks.schedulers">
<span id="noise-schedulers"></span><h2>Noise Schedulers<a class="headerlink" href="#module-monai.networks.schedulers" title="Link to this heading">#</a></h2>
<section id="scheduler">
<h3><cite>Scheduler</cite><a class="headerlink" href="#scheduler" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.schedulers.Scheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.schedulers.</span></span><span class="sig-name descname"><span class="pre">Scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_train_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear_beta'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">schedule_args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/scheduler.py#L115-L207"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.Scheduler" title="Link to this definition">#</a></dt>
<dd><p>Base class for other schedulers based on a noise schedule function.</p>
<p>This class is meant as the base for other schedulers which implement their own way of sampling or stepping. Here
the class defines beta, alpha, and alpha_cumprod values from a noise schedule function named with <cite>schedule</cite>,
which is the name of a component in NoiseSchedules. These components must all be callables which return either
the beta schedule alone or a triple containing (betas, alphas, alphas_cumprod) values. New schedule functions
can be provided by using the NoiseSchedules.add_def, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.schedulers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoiseSchedules</span><span class="p">,</span> <span class="n">DDPMScheduler</span>

<span class="nd">@NoiseSchedules</span><span class="o">.</span><span class="n">add_def</span><span class="p">(</span><span class="s2">&quot;my_beta_schedule&quot;</span><span class="p">,</span> <span class="s2">&quot;Some description of your function&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_beta_function</span><span class="p">(</span><span class="n">num_train_timesteps</span><span class="p">,</span> <span class="n">beta_start</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">beta_end</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">beta_start</span><span class="p">,</span> <span class="n">beta_end</span><span class="p">,</span> <span class="n">num_train_timesteps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">scheduler</span> <span class="o">=</span> <span class="n">DDPMScheduler</span><span class="p">(</span><span class="n">num_train_timesteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s2">&quot;my_beta_schedule&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>All such functions should have an initial positional integer argument <cite>num_train_timesteps</cite> stating the number of
timesteps the schedule is for, otherwise any other arguments can be given which will be passed by keyword through
the constructor’s <cite>schedule_args</cite> value. To see what noise functions are available, print the object NoiseSchedules
to get a listing of stored objects with their docstring descriptions.</p>
<p>Note: in previous versions of the schedulers the argument <cite>schedule_beta</cite> was used to state the beta schedule
type, this now replaced with <cite>schedule</cite> and most names used with the previous argument now have “_beta” appended
to them, eg. ‘schedule_beta=”linear”’ -&gt; ‘schedule=”linear_beta”’. The <cite>beta_start</cite> and <cite>beta_end</cite> arguments are
still used for some schedules but these are provided as keyword arguments now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_train_timesteps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used to train the model.</p></li>
<li><p><strong>schedule</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of NoiseSchedules,
a named function returning the beta tensor or (betas, alphas, alphas_cumprod) triple</p></li>
<li><p><strong>schedule_args</strong> – arguments to pass to the schedule function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.Scheduler.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/scheduler.py#L172-L194"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.Scheduler.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Add noise to the original samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – original samples</p></li>
<li><p><strong>noise</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – noise to add to samples</p></li>
<li><p><strong>timesteps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – timesteps tensor indicating the timestep to be computed for each sample.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sample with added noise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>noisy_samples</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="noiseschedules">
<h3><cite>NoiseSchedules</cite><a class="headerlink" href="#noiseschedules" title="Link to this heading">#</a></h3>
<dl class="py attribute">
<dt class="sig sig-object py" id="monai.networks.schedulers.NoiseSchedules">
<span class="sig-prename descclassname"><span class="pre">monai.networks.schedulers.</span></span><span class="sig-name descname"><span class="pre">NoiseSchedules</span></span><a class="headerlink" href="#monai.networks.schedulers.NoiseSchedules" title="Link to this definition">#</a></dt>
<dd><p>alias of &lt;monai.utils.component_store.ComponentStore object&gt;</p>
</dd></dl>

</section>
<section id="ddpmscheduler">
<h3><cite>DDPMScheduler</cite><a class="headerlink" href="#ddpmscheduler" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDPMScheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.schedulers.</span></span><span class="sig-name descname"><span class="pre">DDPMScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_train_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear_beta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">fixed_small</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_sample_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_sample_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">schedule_args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddpm.py#L68-L254"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDPMScheduler" title="Link to this definition">#</a></dt>
<dd><p>Denoising diffusion probabilistic models (DDPMs) explores the connections between denoising score matching and
Langevin dynamics sampling. Based on: Ho et al., “Denoising Diffusion Probabilistic Models”
<a class="reference external" href="https://arxiv.org/abs/2006.11239">https://arxiv.org/abs/2006.11239</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_train_timesteps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used to train the model.</p></li>
<li><p><strong>schedule</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of NoiseSchedules, name of noise schedule function in component store</p></li>
<li><p><strong>variance_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of DDPMVarianceType</p></li>
<li><p><strong>clip_sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – option to clip predicted sample between -1 and 1 for numerical stability.</p></li>
<li><p><strong>prediction_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of DDPMPredictionType</p></li>
<li><p><strong>clip_sample_min</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – minimum clipping value when clip_sample equals True</p></li>
<li><p><strong>clip_sample_max</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – maximum clipping value when clip_sample equals True</p></li>
<li><p><strong>schedule_args</strong> – arguments to pass to the schedule function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDPMScheduler.set_timesteps">
<span class="sig-name descname"><span class="pre">set_timesteps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_inference_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddpm.py#L109-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDPMScheduler.set_timesteps" title="Link to this definition">#</a></dt>
<dd><p>Sets the discrete timesteps used for the diffusion chain. Supporting function to be run before inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_inference_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used when generating samples with a pre-trained model.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – target device to put the data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDPMScheduler.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddpm.py#L189-L254"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDPMScheduler.step" title="Link to this definition">#</a></dt>
<dd><p>Predict the sample at the previous timestep by reversing the SDE. Core function to propagate the diffusion
process from the learned model outputs (most often the predicted noise).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – direct output from learned diffusion model.</p></li>
<li><p><strong>timestep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current discrete timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – current instance of sample being created by diffusion process.</p></li>
<li><p><strong>generator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted previous sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred_prev_sample</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="ddimscheduler">
<h3><cite>DDIMScheduler</cite><a class="headerlink" href="#ddimscheduler" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDIMScheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.schedulers.</span></span><span class="sig-name descname"><span class="pre">DDIMScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_train_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear_beta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_alpha_to_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_sample_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_sample_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">schedule_args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddim.py#L43-L294"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDIMScheduler" title="Link to this definition">#</a></dt>
<dd><p>Denoising diffusion implicit models is a scheduler that extends the denoising procedure introduced in denoising
diffusion probabilistic models (DDPMs) with non-Markovian guidance. Based on: Song et al. “Denoising Diffusion
Implicit Models” <a class="reference external" href="https://arxiv.org/abs/2010.02502">https://arxiv.org/abs/2010.02502</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_train_timesteps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used to train the model.</p></li>
<li><p><strong>schedule</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of NoiseSchedules, name of noise schedule function in component store</p></li>
<li><p><strong>clip_sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – option to clip predicted sample between -1 and 1 for numerical stability.</p></li>
<li><p><strong>set_alpha_to_one</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – each diffusion step uses the value of alphas product at that step and at the previous one.
For the final step there is no previous alpha. When this option is <cite>True</cite> the previous alpha product is
fixed to <cite>1</cite>, otherwise it uses the value of alpha at step 0.</p></li>
<li><p><strong>steps_offset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – an offset added to the inference steps. You can use a combination of <cite>steps_offset=1</cite> and
<cite>set_alpha_to_one=False</cite>, to make the last step use step 0 for the previous alpha product, as done in
stable diffusion.</p></li>
<li><p><strong>prediction_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of DDPMPredictionType</p></li>
<li><p><strong>clip_sample_min</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – minimum clipping value when clip_sample equals True</p></li>
<li><p><strong>clip_sample_max</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – maximum clipping value when clip_sample equals True</p></li>
<li><p><strong>schedule_args</strong> – arguments to pass to the schedule function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDIMScheduler.reversed_step">
<span class="sig-name descname"><span class="pre">reversed_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddim.py#L230-L294"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDIMScheduler.reversed_step" title="Link to this definition">#</a></dt>
<dd><p>Predict the sample at the next timestep by reversing the SDE. Core function to propagate the diffusion
process from the learned model outputs (most often the predicted noise).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – direct output from learned diffusion model.</p></li>
<li><p><strong>timestep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current discrete timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – current instance of sample being created by diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted previous sample
pred_original_sample: Predicted original sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred_prev_sample</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDIMScheduler.set_timesteps">
<span class="sig-name descname"><span class="pre">set_timesteps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_inference_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddim.py#L104-L132"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDIMScheduler.set_timesteps" title="Link to this definition">#</a></dt>
<dd><p>Sets the discrete timesteps used for the diffusion chain. Supporting function to be run before inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_inference_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used when generating samples with a pre-trained model.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – target device to put the data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.DDIMScheduler.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/ddim.py#L144-L228"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.DDIMScheduler.step" title="Link to this definition">#</a></dt>
<dd><p>Predict the sample at the previous timestep by reversing the SDE. Core function to propagate the diffusion
process from the learned model outputs (most often the predicted noise).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – direct output from learned diffusion model.</p></li>
<li><p><strong>timestep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current discrete timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – current instance of sample being created by diffusion process.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – weight of noise for added noise in diffusion step.</p></li>
<li><p><strong>generator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted previous sample
pred_original_sample: Predicted original sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred_prev_sample</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pndmscheduler">
<h3><cite>PNDMScheduler</cite><a class="headerlink" href="#pndmscheduler" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.schedulers.PNDMScheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.schedulers.</span></span><span class="sig-name descname"><span class="pre">PNDMScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_train_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear_beta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_prk_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_alpha_to_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">schedule_args</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/pndm.py#L56-L316"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.PNDMScheduler" title="Link to this definition">#</a></dt>
<dd><p>Pseudo numerical methods for diffusion models (PNDM) proposes using more advanced ODE integration techniques,
namely Runge-Kutta method and a linear multi-step method. Based on: Liu et al.,
“Pseudo Numerical Methods for Diffusion Models on Manifolds”  <a class="reference external" href="https://arxiv.org/abs/2202.09778">https://arxiv.org/abs/2202.09778</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_train_timesteps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used to train the model.</p></li>
<li><p><strong>schedule</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of NoiseSchedules, name of noise schedule function in component store</p></li>
<li><p><strong>skip_prk_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – allows the scheduler to skip the Runge-Kutta steps that are defined in the original paper as being required
before plms step.</p></li>
<li><p><strong>set_alpha_to_one</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – each diffusion step uses the value of alphas product at that step and at the previous one. For the final
step there is no previous alpha. When this option is <cite>True</cite> the previous alpha product is fixed to <cite>1</cite>,
otherwise it uses the value of alpha at step 0.</p></li>
<li><p><strong>prediction_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – member of DDPMPredictionType</p></li>
<li><p><strong>steps_offset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – an offset added to the inference steps. You can use a combination of <cite>offset=1</cite> and
<cite>set_alpha_to_one=False</cite>, to make the last step use step 0 for the previous alpha product, as done in
stable diffusion.</p></li>
<li><p><strong>schedule_args</strong> – arguments to pass to the schedule function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.PNDMScheduler.set_timesteps">
<span class="sig-name descname"><span class="pre">set_timesteps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_inference_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/pndm.py#L119-L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.PNDMScheduler.set_timesteps" title="Link to this definition">#</a></dt>
<dd><p>Sets the discrete timesteps used for the diffusion chain. Supporting function to be run before inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_inference_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used when generating samples with a pre-trained model.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – target device to put the data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.PNDMScheduler.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/pndm.py#L165-L183"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.PNDMScheduler.step" title="Link to this definition">#</a></dt>
<dd><p>Predict the sample at the previous timestep by reversing the SDE. Core function to propagate the diffusion
process from the learned model outputs (most often the predicted noise).
This function calls <cite>step_prk()</cite> or <cite>step_plms()</cite> depending on the internal variable <cite>counter</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – direct output from learned diffusion model.</p></li>
<li><p><strong>timestep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current discrete timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – current instance of sample being created by diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted previous sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred_prev_sample</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.PNDMScheduler.step_plms">
<span class="sig-name descname"><span class="pre">step_plms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/pndm.py#L227-L277"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.PNDMScheduler.step_plms" title="Link to this definition">#</a></dt>
<dd><p>Step function propagating the sample with the linear multi-step method. This has one forward pass with multiple
times to approximate the solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – direct output from learned diffusion model.</p></li>
<li><p><strong>timestep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current discrete timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – current instance of sample being created by diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted previous sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred_prev_sample</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.PNDMScheduler.step_prk">
<span class="sig-name descname"><span class="pre">step_prk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/pndm.py#L185-L225"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.PNDMScheduler.step_prk" title="Link to this definition">#</a></dt>
<dd><p>Step function propagating the sample with the Runge-Kutta method. RK takes 4 forward passes to approximate the
solution to the differential equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – direct output from learned diffusion model.</p></li>
<li><p><strong>timestep</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – current discrete timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – current instance of sample being created by diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted previous sample</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred_prev_sample</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="rflowscheduler">
<h3><cite>RFlowScheduler</cite><a class="headerlink" href="#rflowscheduler" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.networks.schedulers.RFlowScheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.networks.schedulers.</span></span><span class="sig-name descname"><span class="pre">RFlowScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_train_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_discrete_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_timestep_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_img_size_numel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/rectified_flow.py#L80-L322"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.RFlowScheduler" title="Link to this definition">#</a></dt>
<dd><p>A rectified flow scheduler for guiding the diffusion process in a generative model.</p>
<p>Supports uniform and logit-normal sampling methods, timestep transformation for
different resolutions, and noise addition during diffusion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_train_timesteps</strong> (<em>int</em>) – Total number of training timesteps.</p></li>
<li><p><strong>use_discrete_timesteps</strong> (<em>bool</em>) – Whether to use discrete timesteps.</p></li>
<li><p><strong>sample_method</strong> (<em>str</em>) – Training time step sampling method (‘uniform’ or ‘logit-normal’).</p></li>
<li><p><strong>loc</strong> (<em>float</em>) – Location parameter for logit-normal distribution, used only if sample_method=’logit-normal’.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scale parameter for logit-normal distribution, used only if sample_method=’logit-normal’.</p></li>
<li><p><strong>use_timestep_transform</strong> (<em>bool</em>) – Whether to apply timestep transformation.
If true, there will be more inference timesteps at early(noisy) stages for larger image volumes.</p></li>
<li><p><strong>transform_scale</strong> (<em>float</em>) – Scaling factor for timestep transformation, used only if use_timestep_transform=True.</p></li>
<li><p><strong>steps_offset</strong> (<em>int</em>) – Offset added to computed timesteps, used only if use_timestep_transform=True.</p></li>
<li><p><strong>base_img_size_numel</strong> (<em>int</em>) – Reference image volume size for scaling, used only if use_timestep_transform=True.</p></li>
<li><p><strong>spatial_dim</strong> (<em>int</em>) – 2 or 3, incidcating 2D or 3D images, used only if use_timestep_transform=True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a scheduler</span>
<span class="n">noise_scheduler</span> <span class="o">=</span> <span class="n">RFlowScheduler</span><span class="p">(</span>
    <span class="n">num_train_timesteps</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">use_discrete_timesteps</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sample_method</span> <span class="o">=</span> <span class="s1">&#39;logit-normal&#39;</span><span class="p">,</span>
    <span class="n">use_timestep_transform</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">base_img_size_numel</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">32</span><span class="p">,</span>
    <span class="n">spatial_dim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">)</span>

<span class="c1"># during training</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">timesteps</span> <span class="o">=</span> <span class="n">noise_scheduler</span><span class="o">.</span><span class="n">sample_timesteps</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">noisy_inputs</span> <span class="o">=</span> <span class="n">noise_scheduler</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">original_samples</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="n">timesteps</span><span class="p">)</span>
<span class="n">predicted_velocity</span> <span class="o">=</span> <span class="n">diffusion_unet</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">noisy_inputs</span><span class="p">,</span>
    <span class="n">timesteps</span><span class="o">=</span><span class="n">timesteps</span>
<span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">loss_l1</span><span class="p">(</span><span class="n">predicted_velocity</span><span class="p">,</span> <span class="p">(</span><span class="n">inputs</span> <span class="o">-</span> <span class="n">noise</span><span class="p">))</span>

<span class="c1"># during inference</span>
<span class="n">noisy_inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="n">input_img_size_numel</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">noisy_inputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>
<span class="n">noise_scheduler</span><span class="o">.</span><span class="n">set_timesteps</span><span class="p">(</span>
    <span class="n">num_inference_steps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">input_img_size_numel</span><span class="o">=</span><span class="n">input_img_size_numel</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">all_next_timesteps</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
    <span class="p">(</span><span class="n">noise_scheduler</span><span class="o">.</span><span class="n">timesteps</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">noise_scheduler</span><span class="o">.</span><span class="n">timesteps</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">next_t</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
    <span class="nb">zip</span><span class="p">(</span><span class="n">noise_scheduler</span><span class="o">.</span><span class="n">timesteps</span><span class="p">,</span> <span class="n">all_next_timesteps</span><span class="p">),</span>
    <span class="n">total</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">noise_scheduler</span><span class="o">.</span><span class="n">timesteps</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_next_timesteps</span><span class="p">)),</span>
<span class="p">):</span>
    <span class="n">predicted_velocity</span> <span class="o">=</span> <span class="n">diffusion_unet</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">noisy_inputs</span><span class="p">,</span>
        <span class="n">timesteps</span><span class="o">=</span><span class="n">timesteps</span>
    <span class="p">)</span>
    <span class="n">noisy_inputs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">noise_scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">predicted_velocity</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">noisy_inputs</span><span class="p">,</span> <span class="n">next_t</span><span class="p">)</span>
<span class="n">final_output</span> <span class="o">=</span> <span class="n">noisy_inputs</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.RFlowScheduler.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/rectified_flow.py#L182-L207"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.RFlowScheduler.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Add noise to the original samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – original samples</p></li>
<li><p><strong>noise</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – noise to add to samples</p></li>
<li><p><strong>timesteps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – timesteps tensor with shape of (N,), indicating the timestep to be computed for each sample.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sample with added noise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>noisy_samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.RFlowScheduler.sample_timesteps">
<span class="sig-name descname"><span class="pre">sample_timesteps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_start</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/rectified_flow.py#L255-L283"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.RFlowScheduler.sample_timesteps" title="Link to this definition">#</a></dt>
<dd><p>Randomly samples training timesteps using the chosen sampling method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_start</strong> (<em>torch.Tensor</em>) – The input tensor for sampling.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled timesteps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.RFlowScheduler.set_timesteps">
<span class="sig-name descname"><span class="pre">set_timesteps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_inference_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_img_size_numel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/rectified_flow.py#L209-L253"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.RFlowScheduler.set_timesteps" title="Link to this definition">#</a></dt>
<dd><p>Sets the discrete timesteps used for the diffusion chain. Supporting function to be run before inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_inference_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of diffusion steps used when generating samples with a pre-trained model.</p></li>
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – target device to put the data.</p></li>
<li><p><strong>input_img_size_numel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – int, H*W*D of the image, used with self.use_timestep_transform is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.networks.schedulers.RFlowScheduler.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/networks/schedulers/rectified_flow.py#L285-L322"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.networks.schedulers.RFlowScheduler.step" title="Link to this definition">#</a></dt>
<dd><p>Predicts the next sample in the diffusion process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_output</strong> (<em>torch.Tensor</em>) – Output from the trained diffusion model.</p></li>
<li><p><strong>timestep</strong> (<em>int</em>) – Current timestep in the diffusion chain.</p></li>
<li><p><strong>sample</strong> (<em>torch.Tensor</em>) – Current sample in the process.</p></li>
<li><p><strong>next_timestep</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>None</em><em>]</em>) – Optional next timestep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted sample at the next step and additional info.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="losses.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Loss functions</p>
      </div>
    </a>
    <a class="right-next"
       href="metrics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Metrics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.blocks">Blocks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adn"><cite>ADN</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ADN"><code class="docutils literal notranslate"><span class="pre">ADN</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convolution"><cite>Convolution</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Convolution"><code class="docutils literal notranslate"><span class="pre">Convolution</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crf"><cite>CRF</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.CRF"><code class="docutils literal notranslate"><span class="pre">CRF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.CRF.__init__"><code class="docutils literal notranslate"><span class="pre">CRF.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.CRF.forward"><code class="docutils literal notranslate"><span class="pre">CRF.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residualunit"><cite>ResidualUnit</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResidualUnit"><code class="docutils literal notranslate"><span class="pre">ResidualUnit</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResidualUnit.forward"><code class="docutils literal notranslate"><span class="pre">ResidualUnit.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swish"><cite>Swish</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Swish"><code class="docutils literal notranslate"><span class="pre">Swish</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Swish.forward"><code class="docutils literal notranslate"><span class="pre">Swish.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memoryefficientswish"><cite>MemoryEfficientSwish</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MemoryEfficientSwish"><code class="docutils literal notranslate"><span class="pre">MemoryEfficientSwish</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MemoryEfficientSwish.forward"><code class="docutils literal notranslate"><span class="pre">MemoryEfficientSwish.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fpn"><cite>FPN</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ExtraFPNBlock"><code class="docutils literal notranslate"><span class="pre">ExtraFPNBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ExtraFPNBlock.forward"><code class="docutils literal notranslate"><span class="pre">ExtraFPNBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FeaturePyramidNetwork"><code class="docutils literal notranslate"><span class="pre">FeaturePyramidNetwork</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FeaturePyramidNetwork.forward"><code class="docutils literal notranslate"><span class="pre">FeaturePyramidNetwork.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FeaturePyramidNetwork.get_result_from_inner_blocks"><code class="docutils literal notranslate"><span class="pre">FeaturePyramidNetwork.get_result_from_inner_blocks()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FeaturePyramidNetwork.get_result_from_layer_blocks"><code class="docutils literal notranslate"><span class="pre">FeaturePyramidNetwork.get_result_from_layer_blocks()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LastLevelMaxPool"><code class="docutils literal notranslate"><span class="pre">LastLevelMaxPool</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LastLevelMaxPool.forward"><code class="docutils literal notranslate"><span class="pre">LastLevelMaxPool.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LastLevelP6P7"><code class="docutils literal notranslate"><span class="pre">LastLevelP6P7</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LastLevelP6P7.forward"><code class="docutils literal notranslate"><span class="pre">LastLevelP6P7.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.BackboneWithFPN"><code class="docutils literal notranslate"><span class="pre">BackboneWithFPN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.BackboneWithFPN.forward"><code class="docutils literal notranslate"><span class="pre">BackboneWithFPN.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mish"><cite>Mish</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Mish"><code class="docutils literal notranslate"><span class="pre">Mish</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Mish.forward"><code class="docutils literal notranslate"><span class="pre">Mish.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geglu"><cite>GEGLU</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.GEGLU"><code class="docutils literal notranslate"><span class="pre">GEGLU</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.GEGLU.forward"><code class="docutils literal notranslate"><span class="pre">GEGLU.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gcn-module"><cite>GCN Module</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.GCN"><code class="docutils literal notranslate"><span class="pre">GCN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.GCN.__init__"><code class="docutils literal notranslate"><span class="pre">GCN.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.GCN.forward"><code class="docutils literal notranslate"><span class="pre">GCN.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#refinement-module"><cite>Refinement Module</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Refine"><code class="docutils literal notranslate"><span class="pre">Refine</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Refine.__init__"><code class="docutils literal notranslate"><span class="pre">Refine.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Refine.forward"><code class="docutils literal notranslate"><span class="pre">Refine.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fcn-module"><cite>FCN Module</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FCN"><code class="docutils literal notranslate"><span class="pre">FCN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FCN.forward"><code class="docutils literal notranslate"><span class="pre">FCN.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-channel-fcn-module"><cite>Multi-Channel FCN Module</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MCFCN"><code class="docutils literal notranslate"><span class="pre">MCFCN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MCFCN.forward"><code class="docutils literal notranslate"><span class="pre">MCFCN.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-unet-block"><cite>Dynamic-Unet Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetResBlock"><code class="docutils literal notranslate"><span class="pre">UnetResBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetResBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetResBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetBasicBlock"><code class="docutils literal notranslate"><span class="pre">UnetBasicBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetBasicBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetBasicBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetUpBlock"><code class="docutils literal notranslate"><span class="pre">UnetUpBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetUpBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetUpBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetOutBlock"><code class="docutils literal notranslate"><span class="pre">UnetOutBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetOutBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetOutBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#denseblock"><cite>DenseBlock</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.DenseBlock"><code class="docutils literal notranslate"><span class="pre">DenseBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.DenseBlock.forward"><code class="docutils literal notranslate"><span class="pre">DenseBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segresnet-block"><cite>SegResnet Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResBlock"><code class="docutils literal notranslate"><span class="pre">ResBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResBlock.__init__"><code class="docutils literal notranslate"><span class="pre">ResBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sablock-block"><cite>SABlock Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SABlock"><code class="docutils literal notranslate"><span class="pre">SABlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SABlock.__init__"><code class="docutils literal notranslate"><span class="pre">SABlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SABlock.forward"><code class="docutils literal notranslate"><span class="pre">SABlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cablock-block"><cite>CABlock Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.CABlock"><code class="docutils literal notranslate"><span class="pre">CABlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.CABlock.forward"><code class="docutils literal notranslate"><span class="pre">CABlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feedforward-block"><cite>FeedForward Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FeedForward"><code class="docutils literal notranslate"><span class="pre">FeedForward</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FeedForward.forward"><code class="docutils literal notranslate"><span class="pre">FeedForward.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#squeeze-and-excitation"><cite>Squeeze-and-Excitation</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ChannelSELayer"><code class="docutils literal notranslate"><span class="pre">ChannelSELayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ChannelSELayer.__init__"><code class="docutils literal notranslate"><span class="pre">ChannelSELayer.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ChannelSELayer.forward"><code class="docutils literal notranslate"><span class="pre">ChannelSELayer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformer-block"><cite>Transformer Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.TransformerBlock"><code class="docutils literal notranslate"><span class="pre">TransformerBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.TransformerBlock.__init__"><code class="docutils literal notranslate"><span class="pre">TransformerBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.TransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">TransformerBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unetr-block"><cite>UNETR Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrBasicBlock"><code class="docutils literal notranslate"><span class="pre">UnetrBasicBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrBasicBlock.__init__"><code class="docutils literal notranslate"><span class="pre">UnetrBasicBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrBasicBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetrBasicBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrUpBlock"><code class="docutils literal notranslate"><span class="pre">UnetrUpBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrUpBlock.__init__"><code class="docutils literal notranslate"><span class="pre">UnetrUpBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrUpBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetrUpBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrPrUpBlock"><code class="docutils literal notranslate"><span class="pre">UnetrPrUpBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrPrUpBlock.__init__"><code class="docutils literal notranslate"><span class="pre">UnetrPrUpBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UnetrPrUpBlock.forward"><code class="docutils literal notranslate"><span class="pre">UnetrPrUpBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-squeeze-and-excitation"><cite>Residual Squeeze-and-Excitation</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResidualSELayer"><code class="docutils literal notranslate"><span class="pre">ResidualSELayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ResidualSELayer.__init__"><code class="docutils literal notranslate"><span class="pre">ResidualSELayer.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#squeeze-and-excitation-block"><cite>Squeeze-and-Excitation Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SEBlock"><code class="docutils literal notranslate"><span class="pre">SEBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SEBlock.__init__"><code class="docutils literal notranslate"><span class="pre">SEBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SEBlock.forward"><code class="docutils literal notranslate"><span class="pre">SEBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#squeeze-and-excitation-bottleneck"><cite>Squeeze-and-Excitation Bottleneck</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SEBottleneck"><code class="docutils literal notranslate"><span class="pre">SEBottleneck</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#squeeze-and-excitation-resnet-bottleneck"><cite>Squeeze-and-Excitation Resnet Bottleneck</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SEResNetBottleneck"><code class="docutils literal notranslate"><span class="pre">SEResNetBottleneck</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#squeeze-and-excitation-resnext-bottleneck"><cite>Squeeze-and-Excitation ResNeXt Bottleneck</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SEResNeXtBottleneck"><code class="docutils literal notranslate"><span class="pre">SEResNeXtBottleneck</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-aspp"><cite>Simple ASPP</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SimpleASPP"><code class="docutils literal notranslate"><span class="pre">SimpleASPP</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SimpleASPP.__init__"><code class="docutils literal notranslate"><span class="pre">SimpleASPP.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SimpleASPP.forward"><code class="docutils literal notranslate"><span class="pre">SimpleASPP.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maxavgpooling"><cite>MaxAvgPooling</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MaxAvgPool"><code class="docutils literal notranslate"><span class="pre">MaxAvgPool</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MaxAvgPool.__init__"><code class="docutils literal notranslate"><span class="pre">MaxAvgPool.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MaxAvgPool.forward"><code class="docutils literal notranslate"><span class="pre">MaxAvgPool.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upsampling"><cite>Upsampling</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UpSample"><code class="docutils literal notranslate"><span class="pre">UpSample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.UpSample.__init__"><code class="docutils literal notranslate"><span class="pre">UpSample.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Upsample"><code class="docutils literal notranslate"><span class="pre">Upsample</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelUpsample"><code class="docutils literal notranslate"><span class="pre">SubpixelUpsample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelUpsample.__init__"><code class="docutils literal notranslate"><span class="pre">SubpixelUpsample.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelUpsample.forward"><code class="docutils literal notranslate"><span class="pre">SubpixelUpsample.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Subpixelupsample"><code class="docutils literal notranslate"><span class="pre">Subpixelupsample</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelUpSample"><code class="docutils literal notranslate"><span class="pre">SubpixelUpSample</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downsampling"><cite>Downsampling</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.DownSample"><code class="docutils literal notranslate"><span class="pre">DownSample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.DownSample.__init__"><code class="docutils literal notranslate"><span class="pre">DownSample.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Downsample"><code class="docutils literal notranslate"><span class="pre">Downsample</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelDownsample"><code class="docutils literal notranslate"><span class="pre">SubpixelDownsample</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelDownsample.__init__"><code class="docutils literal notranslate"><span class="pre">SubpixelDownsample.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelDownsample.forward"><code class="docutils literal notranslate"><span class="pre">SubpixelDownsample.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Subpixeldownsample"><code class="docutils literal notranslate"><span class="pre">Subpixeldownsample</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.SubpixelDownSample"><code class="docutils literal notranslate"><span class="pre">SubpixelDownSample</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#registration-residual-conv-block"><cite>Registration Residual Conv Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationResidualConvBlock"><code class="docutils literal notranslate"><span class="pre">RegistrationResidualConvBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationResidualConvBlock.__init__"><code class="docutils literal notranslate"><span class="pre">RegistrationResidualConvBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationResidualConvBlock.forward"><code class="docutils literal notranslate"><span class="pre">RegistrationResidualConvBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#registration-down-sample-block"><cite>Registration Down Sample Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationDownSampleBlock"><code class="docutils literal notranslate"><span class="pre">RegistrationDownSampleBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationDownSampleBlock.__init__"><code class="docutils literal notranslate"><span class="pre">RegistrationDownSampleBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationDownSampleBlock.forward"><code class="docutils literal notranslate"><span class="pre">RegistrationDownSampleBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#registration-extraction-block"><cite>Registration Extraction Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationExtractionBlock"><code class="docutils literal notranslate"><span class="pre">RegistrationExtractionBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationExtractionBlock.__init__"><code class="docutils literal notranslate"><span class="pre">RegistrationExtractionBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.RegistrationExtractionBlock.forward"><code class="docutils literal notranslate"><span class="pre">RegistrationExtractionBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localnet-downsample-block"><cite>LocalNet DownSample Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetDownSampleBlock"><code class="docutils literal notranslate"><span class="pre">LocalNetDownSampleBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetDownSampleBlock.__init__"><code class="docutils literal notranslate"><span class="pre">LocalNetDownSampleBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetDownSampleBlock.forward"><code class="docutils literal notranslate"><span class="pre">LocalNetDownSampleBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localnet-upsample-block"><cite>LocalNet UpSample Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetUpSampleBlock"><code class="docutils literal notranslate"><span class="pre">LocalNetUpSampleBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetUpSampleBlock.__init__"><code class="docutils literal notranslate"><span class="pre">LocalNetUpSampleBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetUpSampleBlock.forward"><code class="docutils literal notranslate"><span class="pre">LocalNetUpSampleBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localnet-feature-extractor-block"><cite>LocalNet Feature Extractor Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetFeatureExtractorBlock"><code class="docutils literal notranslate"><span class="pre">LocalNetFeatureExtractorBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetFeatureExtractorBlock.__init__"><code class="docutils literal notranslate"><span class="pre">LocalNetFeatureExtractorBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.LocalNetFeatureExtractorBlock.forward"><code class="docutils literal notranslate"><span class="pre">LocalNetFeatureExtractorBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp-block"><cite>MLP Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MLPBlock"><code class="docutils literal notranslate"><span class="pre">MLPBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MLPBlock.__init__"><code class="docutils literal notranslate"><span class="pre">MLPBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.MLPBlock.forward"><code class="docutils literal notranslate"><span class="pre">MLPBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#patch-embedding-block"><cite>Patch Embedding Block</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.PatchEmbeddingBlock"><code class="docutils literal notranslate"><span class="pre">PatchEmbeddingBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.PatchEmbeddingBlock.__init__"><code class="docutils literal notranslate"><span class="pre">PatchEmbeddingBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.PatchEmbeddingBlock.forward"><code class="docutils literal notranslate"><span class="pre">PatchEmbeddingBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factorizedincreaseblock"><cite>FactorizedIncreaseBlock</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FactorizedIncreaseBlock"><code class="docutils literal notranslate"><span class="pre">FactorizedIncreaseBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FactorizedIncreaseBlock.__init__"><code class="docutils literal notranslate"><span class="pre">FactorizedIncreaseBlock.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#factorizedreduceblock"><cite>FactorizedReduceBlock</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FactorizedReduceBlock"><code class="docutils literal notranslate"><span class="pre">FactorizedReduceBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FactorizedReduceBlock.__init__"><code class="docutils literal notranslate"><span class="pre">FactorizedReduceBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.FactorizedReduceBlock.forward"><code class="docutils literal notranslate"><span class="pre">FactorizedReduceBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p3dacticonvnormblock"><cite>P3DActiConvNormBlock</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.P3DActiConvNormBlock"><code class="docutils literal notranslate"><span class="pre">P3DActiConvNormBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.P3DActiConvNormBlock.__init__"><code class="docutils literal notranslate"><span class="pre">P3DActiConvNormBlock.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acticonvnormblock"><cite>ActiConvNormBlock</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ActiConvNormBlock"><code class="docutils literal notranslate"><span class="pre">ActiConvNormBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.ActiConvNormBlock.__init__"><code class="docutils literal notranslate"><span class="pre">ActiConvNormBlock.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp"><cite>Warp</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Warp"><code class="docutils literal notranslate"><span class="pre">Warp</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Warp.__init__"><code class="docutils literal notranslate"><span class="pre">Warp.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.Warp.forward"><code class="docutils literal notranslate"><span class="pre">Warp.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dvf2ddf"><cite>DVF2DDF</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.DVF2DDF"><code class="docutils literal notranslate"><span class="pre">DVF2DDF</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.DVF2DDF.forward"><code class="docutils literal notranslate"><span class="pre">DVF2DDF.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varnetblock"><cite>VarNetBlock</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock"><code class="docutils literal notranslate"><span class="pre">VarNetBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock.forward"><code class="docutils literal notranslate"><span class="pre">VarNetBlock.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.blocks.varnetblock.VarNetBlock.soft_dc"><code class="docutils literal notranslate"><span class="pre">VarNetBlock.soft_dc()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.blocks.fft_utils_t">N-Dim Fourier Transform</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.fft_utils_t.fftn_centered_t"><code class="docutils literal notranslate"><span class="pre">fftn_centered_t()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.fft_utils_t.ifftn_centered_t"><code class="docutils literal notranslate"><span class="pre">ifftn_centered_t()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.fft_utils_t.roll"><code class="docutils literal notranslate"><span class="pre">roll()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.fft_utils_t.roll_1d"><code class="docutils literal notranslate"><span class="pre">roll_1d()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.fft_utils_t.fftshift"><code class="docutils literal notranslate"><span class="pre">fftshift()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.blocks.fft_utils_t.ifftshift"><code class="docutils literal notranslate"><span class="pre">ifftshift()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layers">Layers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.factories"><cite>Factories</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LayerFactory"><code class="docutils literal notranslate"><span class="pre">LayerFactory</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LayerFactory.add_factory_callable"><code class="docutils literal notranslate"><span class="pre">LayerFactory.add_factory_callable()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LayerFactory.add_factory_class"><code class="docutils literal notranslate"><span class="pre">LayerFactory.add_factory_class()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LayerFactory.factory_function"><code class="docutils literal notranslate"><span class="pre">LayerFactory.factory_function()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LayerFactory.get_constructor"><code class="docutils literal notranslate"><span class="pre">LayerFactory.get_constructor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-args"><cite>split_args</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.split_args"><code class="docutils literal notranslate"><span class="pre">split_args()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.Dropout"><cite>Dropout</cite></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.Act"><cite>Act</cite></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.Norm"><cite>Norm</cite></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.Conv"><cite>Conv</cite></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.Pad"><cite>Pad</cite></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.Pool"><cite>Pool</cite></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#channelpad"><cite>ChannelPad</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ChannelPad"><code class="docutils literal notranslate"><span class="pre">ChannelPad</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ChannelPad.__init__"><code class="docutils literal notranslate"><span class="pre">ChannelPad.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ChannelPad.forward"><code class="docutils literal notranslate"><span class="pre">ChannelPad.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skipconnection"><cite>SkipConnection</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.SkipConnection"><code class="docutils literal notranslate"><span class="pre">SkipConnection</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.SkipConnection.__init__"><code class="docutils literal notranslate"><span class="pre">SkipConnection.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.SkipConnection.forward"><code class="docutils literal notranslate"><span class="pre">SkipConnection.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flatten"><cite>Flatten</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.Flatten"><code class="docutils literal notranslate"><span class="pre">Flatten</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.Flatten.forward"><code class="docutils literal notranslate"><span class="pre">Flatten.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape"><cite>Reshape</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.Reshape"><code class="docutils literal notranslate"><span class="pre">Reshape</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.Reshape.__init__"><code class="docutils literal notranslate"><span class="pre">Reshape.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.Reshape.forward"><code class="docutils literal notranslate"><span class="pre">Reshape.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#separable-filtering"><cite>separable_filtering</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.separable_filtering"><code class="docutils literal notranslate"><span class="pre">separable_filtering()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-filter"><cite>apply_filter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.apply_filter"><code class="docutils literal notranslate"><span class="pre">apply_filter()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussianfilter"><cite>GaussianFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.GaussianFilter"><code class="docutils literal notranslate"><span class="pre">GaussianFilter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.GaussianFilter.__init__"><code class="docutils literal notranslate"><span class="pre">GaussianFilter.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.GaussianFilter.forward"><code class="docutils literal notranslate"><span class="pre">GaussianFilter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#medianfilter"><cite>MedianFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.MedianFilter"><code class="docutils literal notranslate"><span class="pre">MedianFilter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.MedianFilter.forward"><code class="docutils literal notranslate"><span class="pre">MedianFilter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#median-filter"><cite>median_filter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.median_filter"><code class="docutils literal notranslate"><span class="pre">median_filter</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bilateralfilter"><cite>BilateralFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.BilateralFilter"><code class="docutils literal notranslate"><span class="pre">BilateralFilter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.BilateralFilter.backward"><code class="docutils literal notranslate"><span class="pre">BilateralFilter.backward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.BilateralFilter.forward"><code class="docutils literal notranslate"><span class="pre">BilateralFilter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trainablebilateralfilter"><cite>TrainableBilateralFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.TrainableBilateralFilter"><code class="docutils literal notranslate"><span class="pre">TrainableBilateralFilter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.TrainableBilateralFilter.forward"><code class="docutils literal notranslate"><span class="pre">TrainableBilateralFilter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trainablejointbilateralfilter"><cite>TrainableJointBilateralFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.TrainableJointBilateralFilter"><code class="docutils literal notranslate"><span class="pre">TrainableJointBilateralFilter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.TrainableJointBilateralFilter.forward"><code class="docutils literal notranslate"><span class="pre">TrainableJointBilateralFilter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phlfilter"><cite>PHLFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.PHLFilter"><code class="docutils literal notranslate"><span class="pre">PHLFilter</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussianmixturemodel"><cite>GaussianMixtureModel</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.GaussianMixtureModel"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureModel</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#savitzkygolayfilter"><cite>SavitzkyGolayFilter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.SavitzkyGolayFilter"><code class="docutils literal notranslate"><span class="pre">SavitzkyGolayFilter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.SavitzkyGolayFilter.forward"><code class="docutils literal notranslate"><span class="pre">SavitzkyGolayFilter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hilberttransform"><cite>HilbertTransform</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.HilbertTransform"><code class="docutils literal notranslate"><span class="pre">HilbertTransform</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.HilbertTransform.forward"><code class="docutils literal notranslate"><span class="pre">HilbertTransform.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#affine-transform"><cite>Affine Transform</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.AffineTransform"><code class="docutils literal notranslate"><span class="pre">AffineTransform</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.AffineTransform.__init__"><code class="docutils literal notranslate"><span class="pre">AffineTransform.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.AffineTransform.forward"><code class="docutils literal notranslate"><span class="pre">AffineTransform.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-pull"><cite>grid_pull</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.grid_pull"><code class="docutils literal notranslate"><span class="pre">grid_pull()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-push"><cite>grid_push</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.grid_push"><code class="docutils literal notranslate"><span class="pre">grid_push()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-count"><cite>grid_count</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.grid_count"><code class="docutils literal notranslate"><span class="pre">grid_count()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-grad"><cite>grid_grad</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.grid_grad"><code class="docutils literal notranslate"><span class="pre">grid_grad()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lltm"><cite>LLTM</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LLTM"><code class="docutils literal notranslate"><span class="pre">LLTM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.LLTM.forward"><code class="docutils literal notranslate"><span class="pre">LLTM.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conjugategradient"><cite>ConjugateGradient</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ConjugateGradient"><code class="docutils literal notranslate"><span class="pre">ConjugateGradient</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ConjugateGradient.__init__"><code class="docutils literal notranslate"><span class="pre">ConjugateGradient.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ConjugateGradient.forward"><code class="docutils literal notranslate"><span class="pre">ConjugateGradient.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.ConjugateGradient.update"><code class="docutils literal notranslate"><span class="pre">ConjugateGradient.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.layers.convutils"><cite>Utilities</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.convutils.calculate_out_shape"><code class="docutils literal notranslate"><span class="pre">calculate_out_shape()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.convutils.gaussian_1d"><code class="docutils literal notranslate"><span class="pre">gaussian_1d()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.convutils.polyval"><code class="docutils literal notranslate"><span class="pre">polyval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.convutils.same_padding"><code class="docutils literal notranslate"><span class="pre">same_padding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.utils.get_act_layer"><code class="docutils literal notranslate"><span class="pre">get_act_layer()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.utils.get_dropout_layer"><code class="docutils literal notranslate"><span class="pre">get_dropout_layer()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.utils.get_norm_layer"><code class="docutils literal notranslate"><span class="pre">get_norm_layer()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.layers.utils.get_pool_layer"><code class="docutils literal notranslate"><span class="pre">get_pool_layer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nets">Nets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ahnet"><cite>AHNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.AHNet"><code class="docutils literal notranslate"><span class="pre">AHNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.AHNet.forward"><code class="docutils literal notranslate"><span class="pre">AHNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densenet"><cite>DenseNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DenseNet"><code class="docutils literal notranslate"><span class="pre">DenseNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DenseNet.forward"><code class="docutils literal notranslate"><span class="pre">DenseNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densenet121"><cite>DenseNet121</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DenseNet121"><code class="docutils literal notranslate"><span class="pre">DenseNet121</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densenet169"><cite>DenseNet169</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DenseNet169"><code class="docutils literal notranslate"><span class="pre">DenseNet169</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densenet201"><cite>DenseNet201</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DenseNet201"><code class="docutils literal notranslate"><span class="pre">DenseNet201</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densenet264"><cite>DenseNet264</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DenseNet264"><code class="docutils literal notranslate"><span class="pre">DenseNet264</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#efficientnet"><cite>EfficientNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNet"><code class="docutils literal notranslate"><span class="pre">EfficientNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNet.__init__"><code class="docutils literal notranslate"><span class="pre">EfficientNet.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNet.forward"><code class="docutils literal notranslate"><span class="pre">EfficientNet.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNet.set_swish"><code class="docutils literal notranslate"><span class="pre">EfficientNet.set_swish()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blockargs"><cite>BlockArgs</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs"><code class="docutils literal notranslate"><span class="pre">BlockArgs</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.expand_ratio"><code class="docutils literal notranslate"><span class="pre">BlockArgs.expand_ratio</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.from_string"><code class="docutils literal notranslate"><span class="pre">BlockArgs.from_string()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.id_skip"><code class="docutils literal notranslate"><span class="pre">BlockArgs.id_skip</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.input_filters"><code class="docutils literal notranslate"><span class="pre">BlockArgs.input_filters</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.kernel_size"><code class="docutils literal notranslate"><span class="pre">BlockArgs.kernel_size</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.num_repeat"><code class="docutils literal notranslate"><span class="pre">BlockArgs.num_repeat</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.output_filters"><code class="docutils literal notranslate"><span class="pre">BlockArgs.output_filters</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.se_ratio"><code class="docutils literal notranslate"><span class="pre">BlockArgs.se_ratio</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.stride"><code class="docutils literal notranslate"><span class="pre">BlockArgs.stride</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BlockArgs.to_string"><code class="docutils literal notranslate"><span class="pre">BlockArgs.to_string()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#efficientnetbn"><cite>EfficientNetBN</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNetBN"><code class="docutils literal notranslate"><span class="pre">EfficientNetBN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNetBN.__init__"><code class="docutils literal notranslate"><span class="pre">EfficientNetBN.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#efficientnetbnfeatures"><cite>EfficientNetBNFeatures</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNetBNFeatures"><code class="docutils literal notranslate"><span class="pre">EfficientNetBNFeatures</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNetBNFeatures.__init__"><code class="docutils literal notranslate"><span class="pre">EfficientNetBNFeatures.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.EfficientNetBNFeatures.forward"><code class="docutils literal notranslate"><span class="pre">EfficientNetBNFeatures.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segresnet"><cite>SegResNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNet"><code class="docutils literal notranslate"><span class="pre">SegResNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNet.forward"><code class="docutils literal notranslate"><span class="pre">SegResNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segresnetds"><cite>SegResNetDS</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS"><code class="docutils literal notranslate"><span class="pre">SegResNetDS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS.forward"><code class="docutils literal notranslate"><span class="pre">SegResNetDS.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS.is_valid_shape"><code class="docutils literal notranslate"><span class="pre">SegResNetDS.is_valid_shape()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS.shape_factor"><code class="docutils literal notranslate"><span class="pre">SegResNetDS.shape_factor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segresnetds2"><cite>SegResNetDS2</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS2"><code class="docutils literal notranslate"><span class="pre">SegResNetDS2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS2.forward"><code class="docutils literal notranslate"><span class="pre">SegResNetDS2.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetDS2.set_auto_grad"><code class="docutils literal notranslate"><span class="pre">SegResNetDS2.set_auto_grad()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segresnetvae"><cite>SegResNetVAE</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetVAE"><code class="docutils literal notranslate"><span class="pre">SegResNetVAE</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SegResNetVAE.forward"><code class="docutils literal notranslate"><span class="pre">SegResNetVAE.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resnet"><cite>ResNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ResNet"><code class="docutils literal notranslate"><span class="pre">ResNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ResNet.forward"><code class="docutils literal notranslate"><span class="pre">ResNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resnetfeatures"><cite>ResNetFeatures</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ResNetFeatures"><code class="docutils literal notranslate"><span class="pre">ResNetFeatures</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ResNetFeatures.__init__"><code class="docutils literal notranslate"><span class="pre">ResNetFeatures.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ResNetFeatures.forward"><code class="docutils literal notranslate"><span class="pre">ResNetFeatures.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#senet"><cite>SENet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SENet"><code class="docutils literal notranslate"><span class="pre">SENet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SENet.forward"><code class="docutils literal notranslate"><span class="pre">SENet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#senet154"><cite>SENet154</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SENet154"><code class="docutils literal notranslate"><span class="pre">SENet154</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seresnet50"><cite>SEResNet50</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SEResNet50"><code class="docutils literal notranslate"><span class="pre">SEResNet50</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seresnet101"><cite>SEResNet101</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SEResNet101"><code class="docutils literal notranslate"><span class="pre">SEResNet101</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seresnet152"><cite>SEResNet152</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SEResNet152"><code class="docutils literal notranslate"><span class="pre">SEResNet152</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seresnext50"><cite>SEResNext50</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SEResNext50"><code class="docutils literal notranslate"><span class="pre">SEResNext50</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seresnext101"><cite>SEResNext101</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SEResNext101"><code class="docutils literal notranslate"><span class="pre">SEResNext101</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#highresnet"><cite>HighResNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.HighResNet"><code class="docutils literal notranslate"><span class="pre">HighResNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.HighResNet.forward"><code class="docutils literal notranslate"><span class="pre">HighResNet.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.HighResBlock"><code class="docutils literal notranslate"><span class="pre">HighResBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.HighResBlock.__init__"><code class="docutils literal notranslate"><span class="pre">HighResBlock.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.HighResBlock.forward"><code class="docutils literal notranslate"><span class="pre">HighResBlock.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynunet"><cite>DynUNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DynUNet"><code class="docutils literal notranslate"><span class="pre">DynUNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DynUNet.forward"><code class="docutils literal notranslate"><span class="pre">DynUNet.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DynUnet"><code class="docutils literal notranslate"><span class="pre">DynUnet</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Dynunet"><code class="docutils literal notranslate"><span class="pre">Dynunet</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unet"><cite>UNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.UNet"><code class="docutils literal notranslate"><span class="pre">UNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.UNet.forward"><code class="docutils literal notranslate"><span class="pre">UNet.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Unet"><code class="docutils literal notranslate"><span class="pre">Unet</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.unet"><code class="docutils literal notranslate"><span class="pre">unet</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attentionunet"><cite>AttentionUnet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.AttentionUnet"><code class="docutils literal notranslate"><span class="pre">AttentionUnet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.AttentionUnet.forward"><code class="docutils literal notranslate"><span class="pre">AttentionUnet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unetr"><cite>UNETR</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.UNETR"><code class="docutils literal notranslate"><span class="pre">UNETR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.UNETR.__init__"><code class="docutils literal notranslate"><span class="pre">UNETR.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.UNETR.forward"><code class="docutils literal notranslate"><span class="pre">UNETR.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vista3d"><cite>VISTA3D</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D"><code class="docutils literal notranslate"><span class="pre">VISTA3D</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.connected_components_combine"><code class="docutils literal notranslate"><span class="pre">VISTA3D.connected_components_combine()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.convert_point_label"><code class="docutils literal notranslate"><span class="pre">VISTA3D.convert_point_label()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.forward"><code class="docutils literal notranslate"><span class="pre">VISTA3D.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.gaussian_combine"><code class="docutils literal notranslate"><span class="pre">VISTA3D.gaussian_combine()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.get_foreground_class_count"><code class="docutils literal notranslate"><span class="pre">VISTA3D.get_foreground_class_count()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.sample_points_patch_val"><code class="docutils literal notranslate"><span class="pre">VISTA3D.sample_points_patch_val()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.set_auto_grad"><code class="docutils literal notranslate"><span class="pre">VISTA3D.set_auto_grad()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.update_point_to_patch"><code class="docutils literal notranslate"><span class="pre">VISTA3D.update_point_to_patch()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VISTA3D.update_slidingwindow_padding"><code class="docutils literal notranslate"><span class="pre">VISTA3D.update_slidingwindow_padding()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swinunetr"><cite>SwinUNETR</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SwinUNETR"><code class="docutils literal notranslate"><span class="pre">SwinUNETR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SwinUNETR.__init__"><code class="docutils literal notranslate"><span class="pre">SwinUNETR.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.SwinUNETR.forward"><code class="docutils literal notranslate"><span class="pre">SwinUNETR.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basicunet"><cite>BasicUNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUNet"><code class="docutils literal notranslate"><span class="pre">BasicUNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUNet.__init__"><code class="docutils literal notranslate"><span class="pre">BasicUNet.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUNet.forward"><code class="docutils literal notranslate"><span class="pre">BasicUNet.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUnet"><code class="docutils literal notranslate"><span class="pre">BasicUnet</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Basicunet"><code class="docutils literal notranslate"><span class="pre">Basicunet</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basicunetplusplus"><cite>BasicUNetPlusPlus</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUNetPlusPlus"><code class="docutils literal notranslate"><span class="pre">BasicUNetPlusPlus</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUNetPlusPlus.__init__"><code class="docutils literal notranslate"><span class="pre">BasicUNetPlusPlus.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUNetPlusPlus.forward"><code class="docutils literal notranslate"><span class="pre">BasicUNetPlusPlus.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicUnetPlusPlus"><code class="docutils literal notranslate"><span class="pre">BasicUnetPlusPlus</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.BasicunetPlusPlus"><code class="docutils literal notranslate"><span class="pre">BasicunetPlusPlus</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flexibleunet"><cite>FlexibleUNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.FlexibleUNet"><code class="docutils literal notranslate"><span class="pre">FlexibleUNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.FlexibleUNet.__init__"><code class="docutils literal notranslate"><span class="pre">FlexibleUNet.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.FlexibleUNet.forward"><code class="docutils literal notranslate"><span class="pre">FlexibleUNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vnet"><cite>VNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VNet"><code class="docutils literal notranslate"><span class="pre">VNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VNet.forward"><code class="docutils literal notranslate"><span class="pre">VNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regunet"><cite>RegUNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.RegUNet"><code class="docutils literal notranslate"><span class="pre">RegUNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.RegUNet.__init__"><code class="docutils literal notranslate"><span class="pre">RegUNet.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.RegUNet.forward"><code class="docutils literal notranslate"><span class="pre">RegUNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#globalnet"><cite>GlobalNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.GlobalNet"><code class="docutils literal notranslate"><span class="pre">GlobalNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.GlobalNet.__init__"><code class="docutils literal notranslate"><span class="pre">GlobalNet.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localnet"><cite>LocalNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.LocalNet"><code class="docutils literal notranslate"><span class="pre">LocalNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.LocalNet.__init__"><code class="docutils literal notranslate"><span class="pre">LocalNet.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autoencoder"><cite>AutoEncoder</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.AutoEncoder"><code class="docutils literal notranslate"><span class="pre">AutoEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.AutoEncoder.forward"><code class="docutils literal notranslate"><span class="pre">AutoEncoder.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varautoencoder"><cite>VarAutoEncoder</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VarAutoEncoder"><code class="docutils literal notranslate"><span class="pre">VarAutoEncoder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VarAutoEncoder.forward"><code class="docutils literal notranslate"><span class="pre">VarAutoEncoder.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vit"><cite>ViT</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ViT"><code class="docutils literal notranslate"><span class="pre">ViT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ViT.__init__"><code class="docutils literal notranslate"><span class="pre">ViT.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ViT.forward"><code class="docutils literal notranslate"><span class="pre">ViT.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restormer"><cite>Restormer</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.restormer"><code class="docutils literal notranslate"><span class="pre">restormer</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vitautoenc"><cite>ViTAutoEnc</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ViTAutoEnc"><code class="docutils literal notranslate"><span class="pre">ViTAutoEnc</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ViTAutoEnc.__init__"><code class="docutils literal notranslate"><span class="pre">ViTAutoEnc.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.ViTAutoEnc.forward"><code class="docutils literal notranslate"><span class="pre">ViTAutoEnc.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maskedautoencodervit"><cite>MaskedAutoEncoderViT</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.MaskedAutoEncoderViT"><code class="docutils literal notranslate"><span class="pre">MaskedAutoEncoderViT</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.MaskedAutoEncoderViT.__init__"><code class="docutils literal notranslate"><span class="pre">MaskedAutoEncoderViT.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.MaskedAutoEncoderViT.forward"><code class="docutils literal notranslate"><span class="pre">MaskedAutoEncoderViT.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fullyconnectednet"><cite>FullyConnectedNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.FullyConnectedNet"><code class="docutils literal notranslate"><span class="pre">FullyConnectedNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.FullyConnectedNet.__init__"><code class="docutils literal notranslate"><span class="pre">FullyConnectedNet.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varfullyconnectednet"><cite>VarFullyConnectedNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VarFullyConnectedNet"><code class="docutils literal notranslate"><span class="pre">VarFullyConnectedNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VarFullyConnectedNet.forward"><code class="docutils literal notranslate"><span class="pre">VarFullyConnectedNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generator"><cite>Generator</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Generator"><code class="docutils literal notranslate"><span class="pre">Generator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Generator.forward"><code class="docutils literal notranslate"><span class="pre">Generator.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regressor"><cite>Regressor</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Regressor"><code class="docutils literal notranslate"><span class="pre">Regressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Regressor.forward"><code class="docutils literal notranslate"><span class="pre">Regressor.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classifier"><cite>Classifier</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Classifier"><code class="docutils literal notranslate"><span class="pre">Classifier</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discriminator"><cite>Discriminator</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Discriminator"><code class="docutils literal notranslate"><span class="pre">Discriminator</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critic"><cite>Critic</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Critic"><code class="docutils literal notranslate"><span class="pre">Critic</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Critic.forward"><code class="docutils literal notranslate"><span class="pre">Critic.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transchex"><cite>Transchex</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Transchex"><code class="docutils literal notranslate"><span class="pre">Transchex</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Transchex.__init__"><code class="docutils literal notranslate"><span class="pre">Transchex.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Transchex.forward"><code class="docutils literal notranslate"><span class="pre">Transchex.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#netadapter"><cite>NetAdapter</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.NetAdapter"><code class="docutils literal notranslate"><span class="pre">NetAdapter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.NetAdapter.forward"><code class="docutils literal notranslate"><span class="pre">NetAdapter.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torchvisionfcmodel"><cite>TorchVisionFCModel</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TorchVisionFCModel"><code class="docutils literal notranslate"><span class="pre">TorchVisionFCModel</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#milmodel"><cite>MILModel</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.MILModel"><code class="docutils literal notranslate"><span class="pre">MILModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.MILModel.forward"><code class="docutils literal notranslate"><span class="pre">MILModel.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dints"><cite>DiNTS</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DiNTS"><code class="docutils literal notranslate"><span class="pre">DiNTS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DiNTS.forward"><code class="docutils literal notranslate"><span class="pre">DiNTS.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topologyconstruction-for-dints"><cite>TopologyConstruction for DiNTS</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologyConstruction"><code class="docutils literal notranslate"><span class="pre">TopologyConstruction</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologyConstruction.forward"><code class="docutils literal notranslate"><span class="pre">TopologyConstruction.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topologyinstance-for-dints"><cite>TopologyInstance for DiNTS</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologyInstance"><code class="docutils literal notranslate"><span class="pre">TopologyInstance</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologyInstance.__init__"><code class="docutils literal notranslate"><span class="pre">TopologyInstance.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologyInstance.forward"><code class="docutils literal notranslate"><span class="pre">TopologyInstance.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topologysearch-for-dints"><cite>TopologySearch for DiNTS</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch"><code class="docutils literal notranslate"><span class="pre">TopologySearch</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.__init__"><code class="docutils literal notranslate"><span class="pre">TopologySearch.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.decode"><code class="docutils literal notranslate"><span class="pre">TopologySearch.decode()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.forward"><code class="docutils literal notranslate"><span class="pre">TopologySearch.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.gen_mtx"><code class="docutils literal notranslate"><span class="pre">TopologySearch.gen_mtx()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.get_prob_a"><code class="docutils literal notranslate"><span class="pre">TopologySearch.get_prob_a()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.get_ram_cost_usage"><code class="docutils literal notranslate"><span class="pre">TopologySearch.get_ram_cost_usage()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.TopologySearch.get_topology_entropy"><code class="docutils literal notranslate"><span class="pre">TopologySearch.get_topology_entropy()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complexunet"><cite>ComplexUnet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet"><code class="docutils literal notranslate"><span class="pre">ComplexUnet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.complex_unet.ComplexUnet.forward"><code class="docutils literal notranslate"><span class="pre">ComplexUnet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coilsensitivitymodel"><cite>CoilSensitivityModel</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel"><code class="docutils literal notranslate"><span class="pre">CoilSensitivityModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel.forward"><code class="docutils literal notranslate"><span class="pre">CoilSensitivityModel.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.coil_sensitivity_model.CoilSensitivityModel.get_fully_sampled_region"><code class="docutils literal notranslate"><span class="pre">CoilSensitivityModel.get_fully_sampled_region()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e2e-varnet"><cite>e2e-VarNet</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.varnet.VariationalNetworkModel"><code class="docutils literal notranslate"><span class="pre">VariationalNetworkModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.varnet.VariationalNetworkModel.forward"><code class="docutils literal notranslate"><span class="pre">VariationalNetworkModel.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#daf3d"><cite>DAF3D</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DAF3D"><code class="docutils literal notranslate"><span class="pre">DAF3D</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.DAF3D.forward"><code class="docutils literal notranslate"><span class="pre">DAF3D.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quicknat"><cite>Quicknat</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Quicknat"><code class="docutils literal notranslate"><span class="pre">Quicknat</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Quicknat.forward"><code class="docutils literal notranslate"><span class="pre">Quicknat.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Quicknat.get_selayer"><code class="docutils literal notranslate"><span class="pre">Quicknat.get_selayer()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.Quicknat.is_cuda"><code class="docutils literal notranslate"><span class="pre">Quicknat.is_cuda</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#voxelmorph"><cite>VoxelMorph</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VoxelMorphUNet"><code class="docutils literal notranslate"><span class="pre">VoxelMorphUNet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VoxelMorphUNet.forward"><code class="docutils literal notranslate"><span class="pre">VoxelMorphUNet.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VoxelMorph"><code class="docutils literal notranslate"><span class="pre">VoxelMorph</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.nets.VoxelMorph.forward"><code class="docutils literal notranslate"><span class="pre">VoxelMorph.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.CastTempType"><code class="docutils literal notranslate"><span class="pre">CastTempType</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.CastTempType.forward"><code class="docutils literal notranslate"><span class="pre">CastTempType.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.convert_to_onnx"><code class="docutils literal notranslate"><span class="pre">convert_to_onnx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.convert_to_torchscript"><code class="docutils literal notranslate"><span class="pre">convert_to_torchscript()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.convert_to_trt"><code class="docutils literal notranslate"><span class="pre">convert_to_trt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.copy_model_state"><code class="docutils literal notranslate"><span class="pre">copy_model_state()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.eval_mode"><code class="docutils literal notranslate"><span class="pre">eval_mode()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.get_profile_shapes"><code class="docutils literal notranslate"><span class="pre">get_profile_shapes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.get_state_dict"><code class="docutils literal notranslate"><span class="pre">get_state_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.has_nvfuser_instance_norm"><code class="docutils literal notranslate"><span class="pre">has_nvfuser_instance_norm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.icnr_init"><code class="docutils literal notranslate"><span class="pre">icnr_init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.look_up_named_module"><code class="docutils literal notranslate"><span class="pre">look_up_named_module()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.normal_init"><code class="docutils literal notranslate"><span class="pre">normal_init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.normalize_transform"><code class="docutils literal notranslate"><span class="pre">normalize_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.one_hot"><code class="docutils literal notranslate"><span class="pre">one_hot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.pixelshuffle"><code class="docutils literal notranslate"><span class="pre">pixelshuffle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.pixelunshuffle"><code class="docutils literal notranslate"><span class="pre">pixelunshuffle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.predict_segmentation"><code class="docutils literal notranslate"><span class="pre">predict_segmentation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.replace_modules"><code class="docutils literal notranslate"><span class="pre">replace_modules()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.replace_modules_temp"><code class="docutils literal notranslate"><span class="pre">replace_modules_temp()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.save_state"><code class="docutils literal notranslate"><span class="pre">save_state()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.set_named_module"><code class="docutils literal notranslate"><span class="pre">set_named_module()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.to_norm_affine"><code class="docutils literal notranslate"><span class="pre">to_norm_affine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.utils.train_mode"><code class="docutils literal notranslate"><span class="pre">train_mode()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.complex_normalize"><code class="docutils literal notranslate"><span class="pre">complex_normalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.divisible_pad_t"><code class="docutils literal notranslate"><span class="pre">divisible_pad_t()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.floor_ceil"><code class="docutils literal notranslate"><span class="pre">floor_ceil()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.inverse_divisible_pad_t"><code class="docutils literal notranslate"><span class="pre">inverse_divisible_pad_t()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.reshape_batch_channel_to_channel_dim"><code class="docutils literal notranslate"><span class="pre">reshape_batch_channel_to_channel_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.reshape_channel_complex_to_last_dim"><code class="docutils literal notranslate"><span class="pre">reshape_channel_complex_to_last_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.reshape_channel_to_batch_dim"><code class="docutils literal notranslate"><span class="pre">reshape_channel_to_batch_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.reshape_complex_to_channel_dim"><code class="docutils literal notranslate"><span class="pre">reshape_complex_to_channel_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.sensitivity_map_expand"><code class="docutils literal notranslate"><span class="pre">sensitivity_map_expand()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.apps.reconstruction.networks.nets.utils.sensitivity_map_reduce"><code class="docutils literal notranslate"><span class="pre">sensitivity_map_reduce()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.networks.schedulers">Noise Schedulers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scheduler"><cite>Scheduler</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.Scheduler"><code class="docutils literal notranslate"><span class="pre">Scheduler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.Scheduler.add_noise"><code class="docutils literal notranslate"><span class="pre">Scheduler.add_noise()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#noiseschedules"><cite>NoiseSchedules</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.NoiseSchedules"><code class="docutils literal notranslate"><span class="pre">NoiseSchedules</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ddpmscheduler"><cite>DDPMScheduler</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDPMScheduler"><code class="docutils literal notranslate"><span class="pre">DDPMScheduler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDPMScheduler.set_timesteps"><code class="docutils literal notranslate"><span class="pre">DDPMScheduler.set_timesteps()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDPMScheduler.step"><code class="docutils literal notranslate"><span class="pre">DDPMScheduler.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ddimscheduler"><cite>DDIMScheduler</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDIMScheduler"><code class="docutils literal notranslate"><span class="pre">DDIMScheduler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDIMScheduler.reversed_step"><code class="docutils literal notranslate"><span class="pre">DDIMScheduler.reversed_step()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDIMScheduler.set_timesteps"><code class="docutils literal notranslate"><span class="pre">DDIMScheduler.set_timesteps()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.DDIMScheduler.step"><code class="docutils literal notranslate"><span class="pre">DDIMScheduler.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pndmscheduler"><cite>PNDMScheduler</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.PNDMScheduler"><code class="docutils literal notranslate"><span class="pre">PNDMScheduler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.PNDMScheduler.set_timesteps"><code class="docutils literal notranslate"><span class="pre">PNDMScheduler.set_timesteps()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.PNDMScheduler.step"><code class="docutils literal notranslate"><span class="pre">PNDMScheduler.step()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.PNDMScheduler.step_plms"><code class="docutils literal notranslate"><span class="pre">PNDMScheduler.step_plms()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.PNDMScheduler.step_prk"><code class="docutils literal notranslate"><span class="pre">PNDMScheduler.step_prk()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rflowscheduler"><cite>RFlowScheduler</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.RFlowScheduler"><code class="docutils literal notranslate"><span class="pre">RFlowScheduler</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.RFlowScheduler.add_noise"><code class="docutils literal notranslate"><span class="pre">RFlowScheduler.add_noise()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.RFlowScheduler.sample_timesteps"><code class="docutils literal notranslate"><span class="pre">RFlowScheduler.sample_timesteps()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.RFlowScheduler.set_timesteps"><code class="docutils literal notranslate"><span class="pre">RFlowScheduler.set_timesteps()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.networks.schedulers.RFlowScheduler.step"><code class="docutils literal notranslate"><span class="pre">RFlowScheduler.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/networks.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright MONAI Consortium.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>