
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Loss functions &#8212; MONAI 1.5.1 Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=26ac546f" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=cb7e6255"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'losses';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Network architectures" href="networks.html" />
    <link rel="prev" title="monai.transforms.utility.dictionary" href="_gen/monai.transforms.utility.dictionary.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.5.1" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/MONAI-logo-color.png" class="logo__image only-light" alt="MONAI 1.5.1 Documentation - Home"/>
    <img src="_static/MONAI-logo-color.png" class="logo__image only-dark pst-js-only" alt="MONAI 1.5.1 Documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="whatsnew.html">
    What’s New
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="highlights.html">
    Highlights
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="precision_accelerating.html">
    Precision and Accelerating
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="contrib.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="bundle_intro.html">
    Bundle
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="lazy_resampling.html">
    Lazy Resampling
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/Project-MONAI/tutorials">
    Tutorials
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/project-monai/monai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/projectmonai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="whatsnew.html">
    What’s New
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="highlights.html">
    Highlights
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="precision_accelerating.html">
    Precision and Accelerating
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="contrib.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="bundle_intro.html">
    Bundle
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="lazy_resampling.html">
    Lazy Resampling
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/Project-MONAI/tutorials">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/project-monai/monai" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/projectmonai" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="apps.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto3dseg.html">Auto3dseg</a></li>
<li class="toctree-l1"><a class="reference internal" href="fl.html">Federated Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bundle.html">Model Bundle</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Network architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="inferers.html">Inference methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="handlers.html">Event handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize.html">Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="api.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Loss functions</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="loss-functions">
<span id="losses"></span><h1>Loss functions<a class="headerlink" href="#loss-functions" title="Link to this heading">#</a></h1>
<section id="module-monai.losses">
<span id="segmentation-losses"></span><h2>Segmentation Losses<a class="headerlink" href="#module-monai.losses" title="Link to this heading">#</a></h2>
<section id="diceloss">
<h3><cite>DiceLoss</cite><a class="headerlink" href="#diceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.DiceLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">DiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jaccard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L31-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute average Dice loss between two tensors. It can support both multi-classes and multi-labels tasks.
The data <cite>input</cite> (BNHW[D] where N is number of classes) is compared with ground truth <cite>target</cite> (BNHW[D]).</p>
<p>Note that axis N of <cite>input</cite> is expected to be logits or probabilities for each class, if passing logits as input,
must set <cite>sigmoid=True</cite> or <cite>softmax=True</cite>, or specifying <cite>other_act</cite>. And the same axis of <cite>target</cite>
can be 1 or N (one-hot format).</p>
<p>The <cite>smooth_nr</cite> and <cite>smooth_dr</cite> parameters are values added to the intersection and union components of
the inter-over-union calculation to smooth results respectively, these values should be small.</p>
<p>The original papers:</p>
<blockquote>
<div><p>Milletari, F. et. al. (2016) V-Net: Fully Convolutional Neural Networks for Volumetric
Medical Image Segmentation. 3DV 2016.</p>
<p>Wang, Z. et. al. (2023) Jaccard Metric Losses: Optimizing the Jaccard Index with
Soft Labels. NeurIPS 2023.</p>
<p>Wang, Z. et. al. (2023) Dice Semimetric Losses: Optimizing the Dice Score with
Soft Labels. MICCAI 2023.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jaccard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L56-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if False, channel index 0 (background category) is excluded from the calculation.
if the non-background segmentations are small compared to the total image size they can get overwhelmed
by the signal from the background so excluding it in such cases helps convergence.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the <code class="docutils literal notranslate"><span class="pre">target</span></code> into the one-hot format,
using the number of classes inferred from <cite>input</cite> (<code class="docutils literal notranslate"><span class="pre">input.shape[1]</span></code>). Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a sigmoid function to the prediction.</p></li>
<li><p><strong>softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a softmax function to the prediction.</p></li>
<li><p><strong>other_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – callable function to execute other activation layers, Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. for example:
<code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">=</span> <span class="pre">torch.tanh</span></code>.</p></li>
<li><p><strong>squared_pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use squared versions of targets and predictions in the denominator or not.</p></li>
<li><p><strong>jaccard</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – compute Jaccard Index (soft IoU) instead of dice or not.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid zero.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, a Dice loss value is computed independently from each item in the batch
before any <cite>reduction</cite>.</p></li>
<li><p><strong>weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – weights to apply to the voxels of each class. If None no weights are applied.
The input can be a single value (same weight for all classes), a sequence of values (the length
of the sequence should be the same as the number of classes. If not <code class="docutils literal notranslate"><span class="pre">include_background</span></code>,
the number of classes should not include the background category class 0).
The value/values should be no less than 0. Defaults to None.</p></li>
<li><p><strong>soft_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the target contains non-binary values (soft labels) or not.
If True a soft label formulation of the loss will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">other_act</span></code> is not an <code class="docutils literal notranslate"><span class="pre">Optional[Callable]</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When more than 1 of [<code class="docutils literal notranslate"><span class="pre">sigmoid=True</span></code>, <code class="docutils literal notranslate"><span class="pre">softmax=True</span></code>, <code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>].
    Incompatible values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L131-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD], where N is the number of classes.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD] or B1H[WD], where N is the number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – When input and target (after one hot transform if set)
    have different shapes.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses.dice</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses.dice</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiceLoss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">C</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">one_hot</span><span class="p">(</span><span class="n">target_idx</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">num_classes</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">DiceLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="nb">input</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.losses.Dice">
<span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">Dice</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L31-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.Dice" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.losses.DiceLoss" title="monai.losses.dice.DiceLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiceLoss</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.losses.dice">
<span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">dice</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L0-L1067"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.dice" title="Link to this definition">#</a></dt>
<dd><p>alias of &lt;module ‘monai.losses.dice’ from ‘/home/gautham/MONAI/temp/MONAI-1.5.1/monai/losses/dice.py’&gt;</p>
</dd></dl>

</section>
<section id="maskeddiceloss">
<h3><cite>MaskedDiceLoss</cite><a class="headerlink" href="#maskeddiceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.MaskedDiceLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">MaskedDiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L232-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MaskedDiceLoss" title="Link to this definition">#</a></dt>
<dd><p>Add an additional <cite>masking</cite> process before <cite>DiceLoss</cite>, accept a binary mask ([0, 1]) indicating a region,
<cite>input</cite> and <cite>target</cite> will be masked by the region: region with mask <cite>1</cite> will keep the original value,
region with <cite>0</cite> mask will be converted to <cite>0</cite>. Then feed <cite>input</cite> and <cite>target</cite> to normal <cite>DiceLoss</cite> computation.
This has the effect of ensuring only the masked region contributes to the loss computation and
hence gradient calculation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.MaskedDiceLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L242-L247"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MaskedDiceLoss.__init__" title="Link to this definition">#</a></dt>
<dd><p>Args follow <a class="reference internal" href="#monai.losses.DiceLoss" title="monai.losses.DiceLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.losses.DiceLoss</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.MaskedDiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L249-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MaskedDiceLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the shape should B1H[WD] or 11H[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="generalizeddiceloss">
<h3><cite>GeneralizedDiceLoss</cite><a class="headerlink" href="#generalizeddiceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.GeneralizedDiceLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">GeneralizedDiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">square</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L259-L418"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedDiceLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the generalised Dice loss defined in:</p>
<blockquote>
<div><p>Sudre, C. et. al. (2017) Generalised Dice overlap as a deep learning
loss function for highly unbalanced segmentations. DLMIA 2017.</p>
</div></blockquote>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/NifTK/NiftyNet/blob/v0.6.0/niftynet/layer/loss_segmentation.py#L279">NifTK/NiftyNet</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GeneralizedDiceLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">square</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L270-L332"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedDiceLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If False channel index 0 (background category) is excluded from the calculation.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the <code class="docutils literal notranslate"><span class="pre">target</span></code> into the one-hot format,
using the number of classes inferred from <cite>input</cite> (<code class="docutils literal notranslate"><span class="pre">input.shape[1]</span></code>). Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, apply a sigmoid function to the prediction.</p></li>
<li><p><strong>softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, apply a softmax function to the prediction.</p></li>
<li><p><strong>other_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – callable function to execute other activation layers, Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. for example:
<code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">=</span> <span class="pre">torch.tanh</span></code>.</p></li>
<li><p><strong>w_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.Weight" title="monai.utils.enums.Weight"><code class="xref py py-class docutils literal notranslate"><span class="pre">Weight</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – {<code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;simple&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;uniform&quot;</span></code>}
Type of function to transform ground truth volume to a weight factor. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code>.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid zero.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, intersection over union is computed from each item in the batch.
If True, the class-weighted intersection and union areas are first summed across the batches.</p></li>
<li><p><strong>soft_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the target contains non-binary values (soft labels) or not.
If True a soft label formulation of the loss will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">other_act</span></code> is not an <code class="docutils literal notranslate"><span class="pre">Optional[Callable]</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When more than 1 of [<code class="docutils literal notranslate"><span class="pre">sigmoid=True</span></code>, <code class="docutils literal notranslate"><span class="pre">softmax=True</span></code>, <code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>].
    Incompatible values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GeneralizedDiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L341-L418"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedDiceLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.losses.generalized_dice">
<span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">generalized_dice</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L259-L418"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.generalized_dice" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.losses.GeneralizedDiceLoss" title="monai.losses.dice.GeneralizedDiceLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralizedDiceLoss</span></code></a></p>
</dd></dl>

</section>
<section id="generalizedwassersteindiceloss">
<h3><cite>GeneralizedWassersteinDiceLoss</cite><a class="headerlink" href="#generalizedwassersteindiceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.GeneralizedWassersteinDiceLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">GeneralizedWassersteinDiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighting_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L421-L647"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedWassersteinDiceLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the generalized Wasserstein Dice Loss defined in:</p>
<blockquote>
<div><p>Fidon L. et al. (2017) Generalised Wasserstein Dice Score for Imbalanced Multi-class
Segmentation using Holistic Convolutional Networks. BrainLes 2017.</p>
</div></blockquote>
<p>Or its variant (use the option weighting_mode=”GDL”) defined in the Appendix of:</p>
<blockquote>
<div><p>Tilborghs, S. et al. (2020) Comparative study of deep learning methods for the automatic
segmentation of lung, lesion and lesion type in CT scans of COVID-19 patients.
arXiv preprint arXiv:2007.15546</p>
</div></blockquote>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/LucasFidon/GeneralizedWassersteinDiceLoss">LucasFidon/GeneralizedWassersteinDiceLoss</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GeneralizedWassersteinDiceLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighting_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L438-L507"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedWassersteinDiceLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – 2d tensor or 2d numpy array; matrix of distances between the classes.</p></li>
<li><p><strong>classes.</strong> (<em>It must have dimension C x C where C is the number of</em>)</p></li>
<li><p><strong>weighting_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;GDL&quot;</span></code>}
Specifies how to weight the class-specific sum of errors.
Default to <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>.</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>: (recommended) use the original weighting method as in:</dt><dd><p>Fidon L. et al. (2017) Generalised Wasserstein Dice Score for Imbalanced Multi-class
Segmentation using Holistic Convolutional Networks. BrainLes 2017.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;GDL&quot;</span></code>: use a GDL-like weighting method as in the Appendix of:</dt><dd><p>Tilborghs, S. et al. (2020) Comparative study of deep learning methods for the automatic
segmentation of lung, lesion and lesion type in CT scans of COVID-19 patients.
arXiv preprint arXiv:2007.15546</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid zero.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">dist_matrix</span></code> is not a square matrix.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeneralizedWassersteinDiceLoss</span>

<span class="c1"># Example with 3 classes (including the background: label 0).</span>
<span class="c1"># The distance between the background class (label 0) and the other classes is the maximum, equal to 1.</span>
<span class="c1"># The distance between class 1 and class 2 is 0.5.</span>
<span class="n">dist_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">wass_loss</span> <span class="o">=</span> <span class="n">GeneralizedWassersteinDiceLoss</span><span class="p">(</span><span class="n">dist_matrix</span><span class="o">=</span><span class="n">dist_mat</span><span class="p">)</span>

<span class="n">pred_score</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">grnd</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">wass_loss</span><span class="p">(</span><span class="n">pred_score</span><span class="p">,</span> <span class="n">grnd</span><span class="p">)</span>  <span class="c1"># 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GeneralizedWassersteinDiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L509-L558"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedWassersteinDiceLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GeneralizedWassersteinDiceLoss.wasserstein_distance_map">
<span class="sig-name descname"><span class="pre">wasserstein_distance_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flat_proba</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L560-L596"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedWassersteinDiceLoss.wasserstein_distance_map" title="Link to this definition">#</a></dt>
<dd><p>Compute the voxel-wise Wasserstein distance between the
flattened prediction and the flattened labels (ground_truth) with respect
to the distance matrix on the label space M.
This corresponds to eq. 6 in:</p>
<blockquote>
<div><p>Fidon L. et al. (2017) Generalised Wasserstein Dice Score for Imbalanced Multi-class
Segmentation using Holistic Convolutional Networks. BrainLes 2017.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flat_proba</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the probabilities of input(predicted) tensor.</p></li>
<li><p><strong>flat_target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the target tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="monai.losses.generalized_wasserstein_dice">
<span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">generalized_wasserstein_dice</span></span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L421-L647"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.generalized_wasserstein_dice" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#monai.losses.GeneralizedWassersteinDiceLoss" title="monai.losses.dice.GeneralizedWassersteinDiceLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralizedWassersteinDiceLoss</span></code></a></p>
</dd></dl>

</section>
<section id="diceceloss">
<h3><cite>DiceCELoss</cite><a class="headerlink" href="#diceceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.DiceCELoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">DiceCELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jaccard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_dice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_ce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L650-L807"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceCELoss" title="Link to this definition">#</a></dt>
<dd><p>Compute both Dice loss and Cross Entropy Loss, and return the weighted sum of these two losses.
The details of Dice loss is shown in <code class="docutils literal notranslate"><span class="pre">monai.losses.DiceLoss</span></code>.
The details of Cross Entropy Loss is shown in <code class="docutils literal notranslate"><span class="pre">torch.nn.CrossEntropyLoss</span></code> and <code class="docutils literal notranslate"><span class="pre">torch.nn.BCEWithLogitsLoss()</span></code>.
In this implementation, two deprecated parameters <code class="docutils literal notranslate"><span class="pre">size_average</span></code> and <code class="docutils literal notranslate"><span class="pre">reduce</span></code>, and the parameter <code class="docutils literal notranslate"><span class="pre">ignore_index</span></code> are
not supported.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceCELoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jaccard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_dice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_ce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L660-L748"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceCELoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss.</strong> (<em>reduction and weight is used for both losses and other parameters are only used for dice</em>)</p></li>
<li><p><strong>loss.</strong></p></li>
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if False channel index 0 (background category) is excluded from the calculation.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the <code class="docutils literal notranslate"><span class="pre">target</span></code> into the one-hot format,
using the number of classes inferred from <cite>input</cite> (<code class="docutils literal notranslate"><span class="pre">input.shape[1]</span></code>). Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a sigmoid function to the prediction, only used by the <cite>DiceLoss</cite>,
don’t need to specify activation function for <cite>CrossEntropyLoss</cite> and <cite>BCEWithLogitsLoss</cite>.</p></li>
<li><p><strong>softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a softmax function to the prediction, only used by the <cite>DiceLoss</cite>,
don’t need to specify activation function for <cite>CrossEntropyLoss</cite> and <cite>BCEWithLogitsLoss</cite>.</p></li>
<li><p><strong>other_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – callable function to execute other activation layers, Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. for example:
<code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">=</span> <span class="pre">torch.tanh</span></code>. only used by the <cite>DiceLoss</cite>, not for the <cite>CrossEntropyLoss</cite> and <cite>BCEWithLogitsLoss</cite>.</p></li>
<li><p><strong>squared_pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use squared versions of targets and predictions in the denominator or not.</p></li>
<li><p><strong>jaccard</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – compute Jaccard Index (soft IoU) instead of dice or not.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>. The dice loss should
as least reduce the spatial dimensions, which is different from cross entropy loss, thus here
the <code class="docutils literal notranslate"><span class="pre">none</span></code> option cannot be used.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid zero.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, a Dice loss value is computed independently from each item in the batch
before any <cite>reduction</cite>.</p></li>
<li><p><strong>weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a rescaling weight given to each class for cross entropy loss for <cite>CrossEntropyLoss</cite>.
or a weight of positive examples to be broadcasted with target used as <cite>pos_weight</cite> for <cite>BCEWithLogitsLoss</cite>.
See <code class="docutils literal notranslate"><span class="pre">torch.nn.CrossEntropyLoss()</span></code> or <code class="docutils literal notranslate"><span class="pre">torch.nn.BCEWithLogitsLoss()</span></code> for more information.
The weight is also used in <cite>DiceLoss</cite>.</p></li>
<li><p><strong>lambda_dice</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the trade-off weight value for dice loss. The value should be no less than 0.0.
Defaults to 1.0.</p></li>
<li><p><strong>lambda_ce</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the trade-off weight value for cross entropy loss. The value should be no less than 0.0.
Defaults to 1.0.</p></li>
<li><p><strong>label_smoothing</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a value in [0, 1] range. If &gt; 0, the labels are smoothed
by the given factor to reduce overfitting.
Defaults to 0.0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceCELoss.bce">
<span class="sig-name descname"><span class="pre">bce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L766-L774"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceCELoss.bce" title="Link to this definition">#</a></dt>
<dd><p>Compute Binary CrossEntropy loss for the input logits and target in one single class.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceCELoss.ce">
<span class="sig-name descname"><span class="pre">ce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L750-L764"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceCELoss.ce" title="Link to this definition">#</a></dt>
<dd><p>Compute CrossEntropy loss for the input logits and target.
Will remove the channel dim according to PyTorch CrossEntropyLoss:
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html">https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html</a>?#torch.nn.CrossEntropyLoss.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceCELoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L776-L807"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceCELoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD] or B1H[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When number of dimensions for input and target are different.</p></li>
<li><p><strong>ValueError</strong> – When number of channels for target is neither 1 (without one-hot encoding) nor the same as input.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>value of the loss.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="dicefocalloss">
<h3><cite>DiceFocalLoss</cite><a class="headerlink" href="#dicefocalloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.DiceFocalLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">DiceFocalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jaccard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_dice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_focal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L810-L944"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceFocalLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute both Dice loss and Focal Loss, and return the weighted sum of these two losses.
The details of Dice loss is shown in <code class="docutils literal notranslate"><span class="pre">monai.losses.DiceLoss</span></code>.
The details of Focal Loss is shown in <code class="docutils literal notranslate"><span class="pre">monai.losses.FocalLoss</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">gamma</span></code> and <code class="docutils literal notranslate"><span class="pre">lambda_focal</span></code> are only used for the focal loss.
<code class="docutils literal notranslate"><span class="pre">include_background</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code>, <code class="docutils literal notranslate"><span class="pre">reduction</span></code>, and <code class="docutils literal notranslate"><span class="pre">alpha</span></code> are used for both losses,
and other parameters are only used for dice loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceFocalLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jaccard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_dice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_focal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L822-L906"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceFocalLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if False channel index 0 (background category) is excluded from the calculation.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the <code class="docutils literal notranslate"><span class="pre">target</span></code> into the one-hot format,
using the number of classes inferred from <cite>input</cite> (<code class="docutils literal notranslate"><span class="pre">input.shape[1]</span></code>). Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a sigmoid function to the prediction, only used by the <cite>DiceLoss</cite>,
don’t need to specify activation function for <cite>FocalLoss</cite>.</p></li>
<li><p><strong>softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a softmax function to the prediction, only used by the <cite>DiceLoss</cite>,
don’t need to specify activation function for <cite>FocalLoss</cite>.</p></li>
<li><p><strong>other_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – callable function to execute other activation layers, Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
for example: <cite>other_act = torch.tanh</cite>. only used by the <cite>DiceLoss</cite>, not for <cite>FocalLoss</cite>.</p></li>
<li><p><strong>squared_pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – use squared versions of targets and predictions in the denominator or not.</p></li>
<li><p><strong>jaccard</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – compute Jaccard Index (soft IoU) instead of dice or not.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid zero.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, a Dice loss value is computed independently from each item in the batch
before any <cite>reduction</cite>.</p></li>
<li><p><strong>gamma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – value of the exponent gamma in the definition of the Focal loss.</p></li>
<li><p><strong>weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – weights to apply to the voxels of each class. If None no weights are applied.
The input can be a single value (same weight for all classes), a sequence of values (the length
of the sequence should be the same as the number of classes).</p></li>
<li><p><strong>lambda_dice</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the trade-off weight value for dice loss. The value should be no less than 0.0.
Defaults to 1.0.</p></li>
<li><p><strong>lambda_focal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – the trade-off weight value for focal loss. The value should be no less than 0.0.
Defaults to 1.0.</p></li>
<li><p><strong>alpha</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – value of the alpha in the definition of the alpha-balanced Focal loss. The value should be in
[0, 1]. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiceFocalLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L908-L944"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiceFocalLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD]. The input should be the original logits
due to the restriction of <code class="docutils literal notranslate"><span class="pre">monai.losses.FocalLoss</span></code>.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD] or B1H[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When number of dimensions for input and target are different.</p></li>
<li><p><strong>ValueError</strong> – When number of channels for target is neither 1 (without one-hot encoding) nor the same as input.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>value of the loss.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="generalizeddicefocalloss">
<h3><cite>GeneralizedDiceFocalLoss</cite><a class="headerlink" href="#generalizeddicefocalloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.GeneralizedDiceFocalLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">GeneralizedDiceFocalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">square</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_gdl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_focal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L947-L1060"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedDiceFocalLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute both Generalized Dice Loss and Focal Loss, and return their weighted average. The details of Generalized Dice Loss
and Focal Loss are available at <code class="docutils literal notranslate"><span class="pre">monai.losses.GeneralizedDiceLoss</span></code> and <code class="docutils literal notranslate"><span class="pre">monai.losses.FocalLoss</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<em>bool</em><em>, </em><em>optional</em>) – if False channel index 0 (background category) is excluded from the calculation.
Defaults to True.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the <code class="docutils literal notranslate"><span class="pre">target</span></code> into the one-hot format,
using the number of classes inferred from <cite>input</cite> (<code class="docutils literal notranslate"><span class="pre">input.shape[1]</span></code>). Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, apply a sigmoid function to the prediction. Defaults to False.</p></li>
<li><p><strong>softmax</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, apply a softmax function to the prediction. Defaults to False.</p></li>
<li><p><strong>other_act</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – callable function to execute other activation layers,
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. for example: <cite>other_act = torch.tanh</cite>.
only used by the <cite>GeneralizedDiceLoss</cite>, not for the <cite>FocalLoss</cite>.</p></li>
<li><p><strong>w_type</strong> (<em>Union</em><em>[</em><a class="reference internal" href="utils.html#monai.utils.enums.Weight" title="monai.utils.enums.Weight"><em>Weight</em></a><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – {<code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;simple&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;uniform&quot;</span></code>}. Type of function to transform
ground-truth volume to a weight factor. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;square&quot;</span></code>.</p></li>
<li><p><strong>reduction</strong> (<em>Union</em><em>[</em><a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><em>LossReduction</em></a><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – {<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}. Specified the reduction to
apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.
- <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.
- <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
<li><p><strong>smooth_nr</strong> (<em>float</em><em>, </em><em>optional</em>) – a small constant added to the numerator to avoid zero. Defaults to 1e-5.</p></li>
<li><p><strong>smooth_dr</strong> (<em>float</em><em>, </em><em>optional</em>) – a small constant added to the denominator to avoid nan. Defaults to 1e-5.</p></li>
<li><p><strong>batch</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, i.e., the areas are computed for each item in the batch.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>) – value of the exponent gamma in the definition of the Focal loss. Defaults to 2.0.</p></li>
<li><p><strong>weight</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Sequence</em><em>[</em><em>float</em><em>]</em><em>, </em><em>float</em><em>, </em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – weights to apply to
the voxels of each class. If None no weights are applied. The input can be a single value
(same weight for all classes), a sequence of values (the length of the sequence hould be the same as
the number of classes). Defaults to None.</p></li>
<li><p><strong>lambda_gdl</strong> (<em>float</em><em>, </em><em>optional</em>) – the trade-off weight value for Generalized Dice Loss. The value should be
no less than 0.0. Defaults to 1.0.</p></li>
<li><p><strong>lambda_focal</strong> (<em>float</em><em>, </em><em>optional</em>) – the trade-off weight value for Focal Loss. The value should be no less
than 0.0. Defaults to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if either <cite>lambda_gdl</cite> or <cite>lambda_focal</cite> is less than 0.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GeneralizedDiceFocalLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/dice.py#L1030-L1060"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GeneralizedDiceFocalLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>torch.Tensor</em>) – the shape should be BNH[WD]. The input should be the original logits
due to the restriction of <code class="docutils literal notranslate"><span class="pre">monai.losses.FocalLoss</span></code>.</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – the shape should be BNH[WD] or B1H[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When number of dimensions for input and target are different.</p></li>
<li><p><strong>ValueError</strong> – When number of channels for target is neither 1 (without one-hot encoding) nor the same as input.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>value of the loss.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="focalloss">
<h3><cite>FocalLoss</cite><a class="headerlink" href="#focalloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.FocalLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">FocalLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/focal_loss.py#L26-L202"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.FocalLoss" title="Link to this definition">#</a></dt>
<dd><p>FocalLoss is an extension of BCEWithLogitsLoss that down-weights loss from
high confidence correct predictions.</p>
<p>Reimplementation of the Focal Loss described in:</p>
<blockquote>
<div><ul class="simple">
<li><p>[“Focal Loss for Dense Object Detection”](<a class="reference external" href="https://arxiv.org/abs/1708.02002">https://arxiv.org/abs/1708.02002</a>), T. Lin et al., ICCV 2017</p></li>
<li><p>“AnatomyNet: Deep learning for fast and fully automated whole-volume segmentation of head and neck anatomy”,
Zhu et al., Medical Physics 2018</p></li>
</ul>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses</span><span class="w"> </span><span class="kn">import</span> <span class="n">FocalLoss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">BCEWithLogitsLoss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="n">DIMS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Demonstrate equivalence to BCE when gamma=0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_g0_criterion</span> <span class="o">=</span> <span class="n">FocalLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_g0_loss</span> <span class="o">=</span> <span class="n">fl_g0_criterion</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bce_criterion</span> <span class="o">=</span> <span class="n">BCEWithLogitsLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bce_loss</span> <span class="o">=</span> <span class="n">bce_criterion</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">fl_g0_loss</span><span class="p">,</span> <span class="n">bce_loss</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Demonstrate &quot;focus&quot; by setting gamma &gt; 0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_g2_criterion</span> <span class="o">=</span> <span class="n">FocalLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_g2_loss</span> <span class="o">=</span> <span class="n">fl_g2_criterion</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Mark easy and hard cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_easy</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">input</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_hard</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">input</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">easy_loss_g0</span> <span class="o">=</span> <span class="n">fl_g0_loss</span><span class="p">[</span><span class="n">is_easy</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hard_loss_g0</span> <span class="o">=</span> <span class="n">fl_g0_loss</span><span class="p">[</span><span class="n">is_hard</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">easy_loss_g2</span> <span class="o">=</span> <span class="n">fl_g2_loss</span><span class="p">[</span><span class="n">is_easy</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hard_loss_g2</span> <span class="o">=</span> <span class="n">fl_g2_loss</span><span class="p">[</span><span class="n">is_hard</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Gamma &gt; 0 causes the loss function to &quot;focus&quot; on the hard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># cases.  IE, easy cases are downweighted, so hard cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># receive a higher proportion of the loss.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hard_to_easy_ratio_g2</span> <span class="o">=</span> <span class="n">hard_loss_g2</span> <span class="o">/</span> <span class="n">easy_loss_g2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hard_to_easy_ratio_g0</span> <span class="o">=</span> <span class="n">hard_loss_g0</span> <span class="o">/</span> <span class="n">easy_loss_g0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">hard_to_easy_ratio_g2</span> <span class="o">&gt;</span> <span class="n">hard_to_easy_ratio_g0</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.FocalLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/focal_loss.py#L68-L118"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.FocalLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if False, channel index 0 (background category) is excluded from the loss calculation.
If False, <cite>alpha</cite> is invalid when using softmax.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the label <cite>y</cite> into the one-hot format. Defaults to False.</p></li>
<li><p><strong>gamma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – value of the exponent gamma in the definition of the Focal loss. Defaults to 2.</p></li>
<li><p><strong>alpha</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – value of the alpha in the definition of the alpha-balanced Focal loss.
The value should be in [0, 1]. Defaults to None.</p></li>
<li><p><strong>weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – weights to apply to the voxels of each class. If None no weights are applied.
The input can be a single value (same weight for all classes), a sequence of values (the length
of the sequence should be the same as the number of classes. If not <code class="docutils literal notranslate"><span class="pre">include_background</span></code>,
the number of classes should not include the background category class 0).
The value/values should be no less than 0. Defaults to None.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>use_softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to use softmax to transform the original logits into probabilities.
If True, softmax is used. If False, sigmoid is used. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses</span><span class="w"> </span><span class="kn">import</span> <span class="n">FocalLoss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grnd</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span> <span class="o">=</span> <span class="n">FocalLoss</span><span class="p">(</span><span class="n">to_onehot_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">grnd</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.FocalLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/focal_loss.py#L120-L202"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.FocalLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD], where N is the number of classes.
The input should be the original logits since it will be transformed by
a sigmoid/softmax in the forward function.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD] or B1H[WD], where N is the number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When input and target (after one hot transform if set)
    have different shapes.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.weight</span></code> is a sequence and the length is not equal to the
    number of classes.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.weight</span></code> is/contains a value that is less than 0.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="tverskyloss">
<h3><cite>TverskyLoss</cite><a class="headerlink" href="#tverskyloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.TverskyLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">TverskyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/tversky.py#L25-L165"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.TverskyLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the Tversky loss defined in:</p>
<blockquote>
<div><p>Sadegh et al. (2017) Tversky loss function for image segmentation
using 3D fully convolutional deep networks. (<a class="reference external" href="https://arxiv.org/abs/1706.05721">https://arxiv.org/abs/1706.05721</a>)</p>
<p>Wang, Z. et. al. (2023) Dice Semimetric Losses: Optimizing the Dice Score with
Soft Labels. MICCAI 2023.</p>
</div></blockquote>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/NifTK/NiftyNet/blob/v0.6.0/niftynet/layer/loss_segmentation.py#L631">NifTK/NiftyNet</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.TverskyLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/tversky.py#L40-L103"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.TverskyLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If False channel index 0 (background category) is excluded from the calculation.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert <cite>y</cite> into the one-hot format. Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, apply a sigmoid function to the prediction.</p></li>
<li><p><strong>softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, apply a softmax function to the prediction.</p></li>
<li><p><strong>other_act</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if don’t want to use <cite>sigmoid</cite> or <cite>softmax</cite>, use other callable function to execute
other activation layers, Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. for example:
<cite>other_act = torch.tanh</cite>.</p></li>
<li><p><strong>alpha</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – weight of false positives</p></li>
<li><p><strong>beta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – weight of false negatives</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid zero.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, a Dice loss value is computed independently from each item in the batch
before any <cite>reduction</cite>.</p></li>
<li><p><strong>soft_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the target contains non-binary values (soft labels) or not.
If True a soft label formulation of the loss will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">other_act</span></code> is not an <code class="docutils literal notranslate"><span class="pre">Optional[Callable]</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When more than 1 of [<code class="docutils literal notranslate"><span class="pre">sigmoid=True</span></code>, <code class="docutils literal notranslate"><span class="pre">softmax=True</span></code>, <code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>].
    Incompatible values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.TverskyLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/tversky.py#L105-L165"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.TverskyLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="contrastiveloss">
<h3><cite>ContrastiveLoss</cite><a class="headerlink" href="#contrastiveloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.ContrastiveLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">ContrastiveLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/contrastive.py#L21-L81"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.ContrastiveLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the Contrastive loss defined in:</p>
<blockquote>
<div><p>Chen, Ting, et al. “A simple framework for contrastive learning of visual representations.” International
conference on machine learning. PMLR, 2020. (<a class="reference external" href="http://proceedings.mlr.press/v119/chen20j.html">http://proceedings.mlr.press/v119/chen20j.html</a>)</p>
</div></blockquote>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/Sara-Ahmed/SiT/blob/1aacd6adcd39b71efc903d16b4e9095b97dda76f/losses.py#L5">Sara-Ahmed/SiT</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.ContrastiveLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/contrastive.py#L33-L47"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.ContrastiveLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Can be scaled between 0 and 1 for learning from negative samples, ideally set to 0.5.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When an input of dimension length &gt; 2 is passed</p></li>
<li><p><strong>ValueError</strong> – When input and target are of different shapes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.ContrastiveLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/contrastive.py#L49-L81"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.ContrastiveLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be B[F].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be B[F].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="barlowtwinsloss">
<h3><cite>BarlowTwinsLoss</cite><a class="headerlink" href="#barlowtwinsloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.BarlowTwinsLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">BarlowTwinsLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/barlow_twins.py#L18-L84"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.BarlowTwinsLoss" title="Link to this definition">#</a></dt>
<dd><p>The Barlow Twins cost function takes the representations extracted by a neural network from two
distorted views and seeks to make the cross-correlation matrix of the two representations tend
towards identity. This encourages the neural network to learn similar representations with the least
amount of redundancy. This cost function can be used in particular in multimodal learning to work on
representations from two modalities. The most common use case is for unsupervised learning, where data
augmentations are used to generate 2 distorted views of the same sample to force the encoder to
extract useful features for downstream tasks.</p>
<p>Zbontar, Jure, et al. “Barlow Twins: Self-Supervised Learning via Redundancy Reduction” International
conference on machine learning. PMLR, 2020. (<a class="reference external" href="http://proceedings.mlr.press/v139/zbontar21a/zbontar21a.pdf">http://proceedings.mlr.press/v139/zbontar21a/zbontar21a.pdf</a>)</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/facebookresearch/barlowtwins">facebookresearch/barlowtwins</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.BarlowTwinsLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/barlow_twins.py#L36-L48"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.BarlowTwinsLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lamb</strong> – Can be any float to handle the informativeness and invariance trade-off. Ideally set to 5e-3.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When an input of dimension length &gt; 2 is passed</p></li>
<li><p><strong>ValueError</strong> – When input and target are of different shapes</p></li>
<li><p><strong>ValueError</strong> – When batch size is less than or equal to 1</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.BarlowTwinsLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/barlow_twins.py#L50-L84"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.BarlowTwinsLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be B[F].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be B[F].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hausdorffdtloss">
<h3><cite>HausdorffDTLoss</cite><a class="headerlink" href="#hausdorffdtloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.HausdorffDTLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">HausdorffDTLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/hausdorff_loss.py#L30-L210"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.HausdorffDTLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute channel-wise binary Hausdorff loss based on distance transform. It can support both multi-classes and
multi-labels tasks. The data <cite>input</cite> (BNHW[D] where N is number of classes) is compared with ground truth <cite>target</cite>
(BNHW[D]).</p>
<p>Note that axis N of <cite>input</cite> is expected to be logits or probabilities for each class, if passing logits as input,
must set <cite>sigmoid=True</cite> or <cite>softmax=True</cite>, or specifying <cite>other_act</cite>. And the same axis of <cite>target</cite>
can be 1 or N (one-hot format).</p>
<p>The original paper: Karimi, D. et. al. (2019) Reducing the Hausdorff Distance in Medical Image Segmentation with
Convolutional Neural Networks, IEEE Transactions on medical imaging, 39(2), 499-513</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.HausdorffDTLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_onehot_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/hausdorff_loss.py#L44-L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.HausdorffDTLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_background</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if False, channel index 0 (background category) is excluded from the calculation.
if the non-background segmentations are small compared to the total image size they can get overwhelmed
by the signal from the background so excluding it in such cases helps convergence.</p></li>
<li><p><strong>to_onehot_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to convert the <code class="docutils literal notranslate"><span class="pre">target</span></code> into the one-hot format,
using the number of classes inferred from <cite>input</cite> (<code class="docutils literal notranslate"><span class="pre">input.shape[1]</span></code>). Defaults to False.</p></li>
<li><p><strong>sigmoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a sigmoid function to the prediction.</p></li>
<li><p><strong>softmax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, apply a softmax function to the prediction.</p></li>
<li><p><strong>other_act</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – callable function to execute other activation layers, Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. for example:
<code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">=</span> <span class="pre">torch.tanh</span></code>.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>batch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to sum the intersection and union areas over the batch dimension before the dividing.
Defaults to False, a loss value is computed independently from each item in the batch
before any <cite>reduction</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – When <code class="docutils literal notranslate"><span class="pre">other_act</span></code> is not an <code class="docutils literal notranslate"><span class="pre">Optional[Callable]</span></code>.</p></li>
<li><p><strong>ValueError</strong> – When more than 1 of [<code class="docutils literal notranslate"><span class="pre">sigmoid=True</span></code>, <code class="docutils literal notranslate"><span class="pre">softmax=True</span></code>, <code class="docutils literal notranslate"><span class="pre">other_act</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code>].
    Incompatible values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.HausdorffDTLoss.distance_field">
<span class="sig-name descname"><span class="pre">distance_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#monai.losses.HausdorffDTLoss.distance_field" title="Link to this definition">#</a></dt>
<dd><p>Generate distance transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>np.ndarray</em>) – input mask as NCHWD or NCHW.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.HausdorffDTLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/hausdorff_loss.py#L123-L210"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.HausdorffDTLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNHW[D], where N is the number of classes.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNHW[D] or B1HW[D], where N is the number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the input is not 2D (NCHW) or 3D (NCHWD).</p></li>
<li><p><strong>AssertionError</strong> – When input and target (after one hot transform if set)
    have different shapes.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses.hausdorff_loss</span><span class="w"> </span><span class="kn">import</span> <span class="n">HausdorffDTLoss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.networks.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">one_hot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">C</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">one_hot</span><span class="p">(</span><span class="n">target_idx</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">num_classes</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">HausdorffDTLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="nb">input</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="softcldiceloss">
<h3><cite>SoftclDiceLoss</cite><a class="headerlink" href="#softcldiceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.SoftclDiceLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">SoftclDiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/cldice.py#L115-L146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SoftclDiceLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the Soft clDice loss defined in:</p>
<blockquote>
<div><p>Shit et al. (2021) clDice – A Novel Topology-Preserving Loss Function
for Tubular Structure Segmentation. (<a class="reference external" href="https://arxiv.org/abs/2003.07311">https://arxiv.org/abs/2003.07311</a>)</p>
</div></blockquote>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/jocpae/clDice/blob/master/cldice_loss/pytorch/cldice.py#L7">jocpae/clDice</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.SoftclDiceLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/cldice.py#L126-L134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SoftclDiceLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iter</strong> – Number of iterations for skeletonization</p></li>
<li><p><strong>smooth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Smoothing parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.SoftclDiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/cldice.py#L136-L146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SoftclDiceLoss.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="softdicecldiceloss">
<h3><cite>SoftDiceclDiceLoss</cite><a class="headerlink" href="#softdicecldiceloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.SoftDiceclDiceLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">SoftDiceclDiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/cldice.py#L149-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SoftDiceclDiceLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the Soft clDice loss defined in:</p>
<blockquote>
<div><p>Shit et al. (2021) clDice – A Novel Topology-Preserving Loss Function
for Tubular Structure Segmentation. (<a class="reference external" href="https://arxiv.org/abs/2003.07311">https://arxiv.org/abs/2003.07311</a>)</p>
</div></blockquote>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/jocpae/clDice/blob/master/cldice_loss/pytorch/cldice.py#L38">jocpae/clDice</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.SoftDiceclDiceLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/cldice.py#L160-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SoftDiceclDiceLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iter</strong> – Number of iterations for skeletonization</p></li>
<li><p><strong>smooth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Smoothing parameter</p></li>
<li><p><strong>alpha</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Weighing factor for cldice</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.SoftDiceclDiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/cldice.py#L172-L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SoftDiceclDiceLoss.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="naclloss">
<h3><cite>NACLLoss</cite><a class="headerlink" href="#naclloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.NACLLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">NACLLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_ops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/nacl_loss.py#L24-L139"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.NACLLoss" title="Link to this definition">#</a></dt>
<dd><p>Neighbor-Aware Calibration Loss (NACL) is primarily developed for developing calibrated models in image segmentation.
NACL computes standard cross-entropy loss with a linear penalty that enforces the logit distributions
to match a soft class proportion of surrounding pixel.</p>
<p>Murugesan, Balamurali, et al.
“Trust your neighbours: Penalty-based constraints for model calibration.”
International Conference on Medical Image Computing and Computer-Assisted Intervention, MICCAI 2023.
<a class="reference external" href="https://arxiv.org/abs/2303.06268">https://arxiv.org/abs/2303.06268</a></p>
<p>Murugesan, Balamurali, et al.
“Neighbor-Aware Calibration of Segmentation Networks with Penalty-Based Constraints.”
<a class="reference external" href="https://arxiv.org/abs/2401.14487">https://arxiv.org/abs/2401.14487</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.NACLLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_ops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/nacl_loss.py#L40-L83"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.NACLLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of classes</p></li>
<li><p><strong>dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – dimension of data (supports 2d and 3d)</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – size of the spatial kernel</p></li>
<li><p><strong>distance_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – l1/l2 distance between spatial kernel and predicted logits</p></li>
<li><p><strong>alpha</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – weightage between cross entropy and logit constraint</p></li>
<li><p><strong>sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – sigma of gaussian</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.NACLLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/nacl_loss.py#L107-L139"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.NACLLoss.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes standard cross-entropy loss and constraints it neighbor aware logit penalty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD], where N is the number of classes.</p></li>
<li><p><strong>targets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BH[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value of the loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">monai.losses</span><span class="w"> </span><span class="kn">import</span> <span class="n">NACLLoss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">criterion</span> <span class="o">=</span> <span class="n">NACLLoss</span><span class="p">(</span><span class="n">classes</span> <span class="o">=</span> <span class="n">N</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.NACLLoss.get_constr_target">
<span class="sig-name descname"><span class="pre">get_constr_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/nacl_loss.py#L85-L105"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.NACLLoss.get_constr_target" title="Link to this definition">#</a></dt>
<dd><p>Converts the mask to one hot represenation and is smoothened with the selected spatial filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BH[WD].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the shape would be BNH[WD], N being number of classes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="registration-losses">
<h2>Registration Losses<a class="headerlink" href="#registration-losses" title="Link to this heading">#</a></h2>
<section id="bendingenergyloss">
<h3><cite>BendingEnergyLoss</cite><a class="headerlink" href="#bendingenergyloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.BendingEnergyLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">BendingEnergyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/deform.py#L47-L125"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.BendingEnergyLoss" title="Link to this definition">#</a></dt>
<dd><p>Calculate the bending energy based on second-order differentiation of <code class="docutils literal notranslate"><span class="pre">pred</span></code> using central finite difference.</p>
<p>For more information,
see <a class="github reference external" href="https://github.com/Project-MONAI/tutorials/blob/main/modules/bending_energy_diffusion_loss_notes.ipynb">Project-MONAI/tutorials</a>.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.BendingEnergyLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/deform.py#L58-L72"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.BendingEnergyLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to divide out spatial sizes in order to make the computation roughly
invariant to image scale (i.e. vector field sampling resolution). Defaults to False.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.BendingEnergyLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/deform.py#L74-L125"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.BendingEnergyLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BCH(WD)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">pred</span></code> is not 3-d, 4-d or 5-d.</p></li>
<li><p><strong>ValueError</strong> – When any spatial dimension of <code class="docutils literal notranslate"><span class="pre">pred</span></code> has size less than or equal to 4.</p></li>
<li><p><strong>ValueError</strong> – When the number of channels of <code class="docutils literal notranslate"><span class="pre">pred</span></code> does not match the number of spatial dimensions.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="diffusionloss">
<h3><cite>DiffusionLoss</cite><a class="headerlink" href="#diffusionloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.DiffusionLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">DiffusionLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/deform.py#L128-L210"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiffusionLoss" title="Link to this definition">#</a></dt>
<dd><p>Calculate the diffusion based on first-order differentiation of <code class="docutils literal notranslate"><span class="pre">pred</span></code> using central finite difference.
For the original paper, please refer to
VoxelMorph: A Learning Framework for Deformable Medical Image Registration,
Guha Balakrishnan, Amy Zhao, Mert R. Sabuncu, John Guttag, Adrian V. Dalca
IEEE TMI: Transactions on Medical Imaging. 2019. eprint arXiv:1809.05231.</p>
<p>For more information,
see <a class="github reference external" href="https://github.com/Project-MONAI/tutorials/blob/main/modules/bending_energy_diffusion_loss_notes.ipynb">Project-MONAI/tutorials</a>.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>VoxelMorph (<a class="github reference external" href="https://github.com/voxelmorph/voxelmorph">voxelmorph/voxelmorph</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiffusionLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/deform.py#L143-L157"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiffusionLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to divide out spatial sizes in order to make the computation roughly
invariant to image scale (i.e. vector field sampling resolution). Defaults to False.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DiffusionLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/deform.py#L159-L210"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DiffusionLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – Predicted dense displacement field (DDF) with shape BCH[WD],
where C is the number of spatial dimensions.
Note that diffusion loss can only be calculated
when the sizes of the DDF along all spatial dimensions are greater than 2.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">pred</span></code> is not 3-d, 4-d or 5-d.</p></li>
<li><p><strong>ValueError</strong> – When any spatial dimension of <code class="docutils literal notranslate"><span class="pre">pred</span></code> has size less than or equal to 2.</p></li>
<li><p><strong>ValueError</strong> – When the number of channels of <code class="docutils literal notranslate"><span class="pre">pred</span></code> does not match the number of spatial dimensions.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="localnormalizedcrosscorrelationloss">
<h3><cite>LocalNormalizedCrossCorrelationLoss</cite><a class="headerlink" href="#localnormalizedcrosscorrelationloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.LocalNormalizedCrossCorrelationLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">LocalNormalizedCrossCorrelationLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L51-L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.LocalNormalizedCrossCorrelationLoss" title="Link to this definition">#</a></dt>
<dd><p>Local squared zero-normalized cross-correlation.
The loss is based on a moving kernel/window over the y_true/y_pred,
within the window the square of zncc is calculated.
The kernel can be a rectangular / triangular / gaussian window.
The final loss is the averaged loss over all windows.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p><a class="github reference external" href="https://github.com/voxelmorph/voxelmorph/blob/legacy/src/losses.py">voxelmorph/voxelmorph</a>
DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.LocalNormalizedCrossCorrelationLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L64-L104"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.LocalNormalizedCrossCorrelationLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions, {<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>}. Defaults to 3.</p></li>
<li><p><strong>kernel_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – kernel spatial size, must be odd.</p></li>
<li><p><strong>kernel_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;rectangular&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;triangular&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;gaussian&quot;</span></code>}. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;rectangular&quot;</span></code>.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid nan.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.LocalNormalizedCrossCorrelationLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L112-L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.LocalNormalizedCrossCorrelationLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="globalmutualinformationloss">
<h3><cite>GlobalMutualInformationLoss</cite><a class="headerlink" href="#globalmutualinformationloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.GlobalMutualInformationLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">GlobalMutualInformationLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L166-L329"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GlobalMutualInformationLoss" title="Link to this definition">#</a></dt>
<dd><p>Differentiable global mutual information loss via Parzen windowing method.</p>
<dl class="simple">
<dt>Reference:</dt><dd><p><a class="reference external" href="https://dspace.mit.edu/handle/1721.1/123142">https://dspace.mit.edu/handle/1721.1/123142</a>, Section 3.1, equation 3.1-3.5, Algorithm 1</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GlobalMutualInformationLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L174-L221"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GlobalMutualInformationLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;gaussian&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;b-spline&quot;</span></code>}
<code class="docutils literal notranslate"><span class="pre">&quot;gaussian&quot;</span></code>: adapted from DeepReg
Reference: <a class="reference external" href="https://dspace.mit.edu/handle/1721.1/123142">https://dspace.mit.edu/handle/1721.1/123142</a>, Section 3.1, equation 3.1-3.5, Algorithm 1.
<code class="docutils literal notranslate"><span class="pre">&quot;b-spline&quot;</span></code>: based on the method of Mattes et al [1,2] and adapted from ITK
.. rubric:: References</p>
<dl class="simple">
<dt>[1] “Nonrigid multimodality image registration”</dt><dd><p>D. Mattes, D. R. Haynor, H. Vesselle, T. Lewellen and W. Eubank
Medical Imaging 2001: Image Processing, 2001, pp. 1609-1620.</p>
</dd>
<dt>[2] “PET-CT Image Registration in the Chest Using Free-form Deformations”</dt><dd><p>D. Mattes, D. R. Haynor, H. Vesselle, T. Lewellen and W. Eubank
IEEE Transactions in Medical Imaging. Vol.22, No.1,
January 2003. pp.120-128.</p>
</dd>
</dl>
</p></li>
<li><p><strong>num_bins</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of bins for intensity</p></li>
<li><p><strong>sigma_ratio</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a hyper param for gaussian function</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>smooth_nr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the numerator to avoid nan.</p></li>
<li><p><strong>smooth_dr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – a small constant added to the denominator to avoid nan.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GlobalMutualInformationLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L305-L329"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GlobalMutualInformationLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be B[NDHW].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be same as the pred shape.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">self.reduction</span></code> is not one of [“mean”, “sum”, “none”].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GlobalMutualInformationLoss.parzen_windowing_b_spline">
<span class="sig-name descname"><span class="pre">parzen_windowing_b_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L238-L287"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GlobalMutualInformationLoss.parzen_windowing_b_spline" title="Link to this definition">#</a></dt>
<dd><p>Parzen windowing with b-spline kernel (adapted from ITK)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be B[NDHW].</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – int.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.GlobalMutualInformationLoss.parzen_windowing_gaussian">
<span class="sig-name descname"><span class="pre">parzen_windowing_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/image_dissimilarity.py#L289-L303"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.GlobalMutualInformationLoss.parzen_windowing_gaussian" title="Link to this definition">#</a></dt>
<dd><p>Parzen windowing with gaussian kernel (adapted from DeepReg implementation)
Note: the input is expected to range between 0 and 1
:type img: <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>
:param img: the shape should be B[NDHW].</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="reconstruction-losses">
<h2>Reconstruction Losses<a class="headerlink" href="#reconstruction-losses" title="Link to this heading">#</a></h2>
<section id="ssimloss">
<h3><cite>SSIMLoss</cite><a class="headerlink" href="#ssimloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.ssim_loss.SSIMLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.ssim_loss.</span></span><span class="sig-name descname"><span class="pre">SSIMLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">gaussian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ssim_loss.py#L23-L134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.ssim_loss.SSIMLoss" title="Link to this definition">#</a></dt>
<dd><p>Compute the loss function based on the Structural Similarity Index Measure (SSIM) Metric.</p>
<dl class="simple">
<dt>For more info, visit</dt><dd><p><a class="reference external" href="https://vicuesoft.com/glossary/term/ssim-ms-ssim/">https://vicuesoft.com/glossary/term/ssim-ms-ssim/</a></p>
</dd>
<dt>SSIM reference paper:</dt><dd><p>Wang, Zhou, et al. “Image quality assessment: from error visibility to structural
similarity.” IEEE transactions on image processing 13.4 (2004): 600-612.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.ssim_loss.SSIMLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">gaussian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ssim_loss.py#L35-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.ssim_loss.SSIMLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions of the input images.</p></li>
<li><p><strong>data_range</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – value range of input images. (usually 1.0 or 255)</p></li>
<li><p><strong>kernel_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">KernelType</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – type of kernel, can be “gaussian” or “uniform”.</p></li>
<li><p><strong>win_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – window size of kernel</p></li>
<li><p><strong>kernel_sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – standard deviation for Gaussian kernel.</p></li>
<li><p><strong>k1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – stability constant used in the luminance denominator</p></li>
<li><p><strong>k2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – stability constant used in the contrast denominator</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – {<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.
- <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.
- <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.ssim_loss.SSIMLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ssim_loss.py#L97-L134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.ssim_loss.SSIMLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – batch of predicted images with shape (batch_size, channels, spatial_dim1, spatial_dim2[, spatial_dim3])</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – batch of target images with shape (batch_size, channels, spatial_dim1, spatial_dim2[, spatial_dim3])</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>1 minus the ssim index (recall this is meant to be a loss function)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># 2D data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">SSIMLoss</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="c1"># pseudo-3D data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>  <span class="c1"># 5 could represent number of slices</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">SSIMLoss</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="c1"># 3D data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">SSIMLoss</span><span class="p">(</span><span class="n">spatial_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="patchadversarialloss">
<h3><cite>PatchAdversarialLoss</cite><a class="headerlink" href="#patchadversarialloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.PatchAdversarialLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">PatchAdversarialLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">least_squares</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_activation_leastsq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/adversarial_loss.py#L30-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.PatchAdversarialLoss" title="Link to this definition">#</a></dt>
<dd><p>Calculates an adversarial loss on a Patch Discriminator or a Multi-scale Patch Discriminator.
Warning: due to the possibility of using different criterions, the output of the discrimination
mustn’t be passed to a final activation layer. That is taken care of internally within the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
<li><p><strong>criterion</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – which criterion (hinge, least_squares or bce) you want to use on the discriminators outputs.
Depending on the criterion, a different activation layer will be used. Make sure you don’t run the outputs
through an activation layer prior to calling the loss.</p></li>
<li><p><strong>no_activation_leastsq</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, the activation layer in the case of least-squares is removed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.PatchAdversarialLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_is_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">for_discriminator</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/adversarial_loss.py#L112-L164"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.PatchAdversarialLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>]) – output of Multi-Scale Patch Discriminator or Patch Discriminator; being a list of tensors
or a tensor; they shouldn’t have gone through an activation layer.</p></li>
<li><p><strong>target_is_real</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whereas the input corresponds to discriminator output for real or fake images</p></li>
<li><p><strong>for_discriminator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whereas this is being calculated for discriminator or generator loss. In the last
case, target_is_real is set to True, as the generator wants the input to be dimmed as real.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns: if reduction is None, returns a list with the loss tensors of each discriminator if multi-scale</dt><dd><p>discriminator is active, or the loss tensor if there is just one discriminator. Otherwise, it returns the
summed or mean loss over the tensor and discriminator/s.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.PatchAdversarialLoss.get_target_tensor">
<span class="sig-name descname"><span class="pre">get_target_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_is_real</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/adversarial_loss.py#L84-L97"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.PatchAdversarialLoss.get_target_tensor" title="Link to this definition">#</a></dt>
<dd><p>Gets the ground truth tensor for the discriminator depending on whether the input is real or fake.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – input tensor from the discriminator (output of discriminator, or output of one of the multi-scale</p></li>
<li><p><strong>shape.</strong> (<em>discriminator</em><em>)</em><em>. This is used to match the</em>)</p></li>
<li><p><strong>target_is_real</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the input is real or wannabe-real (1s) or fake (0s).</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.PatchAdversarialLoss.get_zero_tensor">
<span class="sig-name descname"><span class="pre">get_zero_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/adversarial_loss.py#L99-L110"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.PatchAdversarialLoss.get_zero_tensor" title="Link to this definition">#</a></dt>
<dd><p>Gets a zero tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – tensor which shape you want the zeros tensor to correspond to.</p>
</dd>
</dl>
<p>Returns:</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="perceptualloss">
<h3><cite>PerceptualLoss</cite><a class="headerlink" href="#perceptualloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.PerceptualLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">PerceptualLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">alex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_fake_3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fake_3d_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_state_dict_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_wise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/perceptual.py#L36-L190"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.PerceptualLoss" title="Link to this definition">#</a></dt>
<dd><p>Perceptual loss using features from pretrained deep neural networks trained. The function supports networks
pretrained on: ImageNet that use the LPIPS approach from Zhang, et al. “The unreasonable effectiveness of deep
features as a perceptual metric.” <a class="reference external" href="https://arxiv.org/abs/1801.03924">https://arxiv.org/abs/1801.03924</a> ; RadImagenet from Mei, et al. “RadImageNet: An
Open Radiologic Deep Learning Research Dataset for Effective Transfer Learning”
<a class="reference external" href="https://pubs.rsna.org/doi/full/10.1148/ryai.210315">https://pubs.rsna.org/doi/full/10.1148/ryai.210315</a> ; MedicalNet from Chen et al. “Med3D: Transfer Learning for
3D Medical Image Analysis” <a class="reference external" href="https://arxiv.org/abs/1904.00625">https://arxiv.org/abs/1904.00625</a> ;
and ResNet50 from Torchvision: <a class="reference external" href="https://pytorch.org/vision/main/models/generated/torchvision.models.resnet50.html">https://pytorch.org/vision/main/models/generated/torchvision.models.resnet50.html</a> .</p>
<p>The fake 3D implementation is based on a 2.5D approach where we calculate the 2D perceptual loss on slices from all
three axes and average. The full 3D approach uses a 3D network to calculate the perceptual loss.
MedicalNet networks are only compatible with 3D inputs and support channel-wise loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>network_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;alex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;vgg&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;squeeze&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;radimagenet_resnet50&quot;</span></code>,</p></li>
<li><p><strong>&quot;medicalnet_resnet10_23datasets&quot;</strong> – Specifies the network architecture to use. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;alex&quot;</span></code>.</p></li>
<li><p><strong>&quot;medicalnet_resnet50_23datasets&quot;</strong> – Specifies the network architecture to use. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;alex&quot;</span></code>.</p></li>
<li><p><strong>&quot;resnet50&quot;}</strong> – Specifies the network architecture to use. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;alex&quot;</span></code>.</p></li>
<li><p><strong>is_fake_3d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True use 2.5D approach for a 3D perceptual loss.</p></li>
<li><p><strong>fake_3d_ratio</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – ratio of how many slices per axis are used in the 2.5D approach.</p></li>
<li><p><strong>cache_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – path to cache directory to save the pretrained network weights.</p></li>
<li><p><strong>pretrained</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to load pretrained weights. This argument only works when using networks from
LIPIS or Torchvision. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;True&quot;</span></code>.</p></li>
<li><p><strong>pretrained_path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if <cite>pretrained</cite> is <cite>True</cite>, users can specify a weights file to be loaded
via using this argument. This argument only works when <code class="docutils literal notranslate"><span class="pre">&quot;network_type&quot;</span></code> is “resnet50”.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>pretrained_state_dict_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – if <cite>pretrained_path</cite> is not <cite>None</cite>, this argument is used to
extract the expected state dict. This argument only works when <code class="docutils literal notranslate"><span class="pre">&quot;network_type&quot;</span></code> is “resnet50”.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>channel_wise</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – if True, the loss is returned per channel. Otherwise the loss is averaged over the channels.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.PerceptualLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/perceptual.py#L166-L190"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.PerceptualLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNHW[D].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNHW[D].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="jukeboxloss">
<h3><cite>JukeboxLoss</cite><a class="headerlink" href="#jukeboxloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.JukeboxLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">JukeboxLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_signal_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ortho'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/spectral_loss.py#L22-L88"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.JukeboxLoss" title="Link to this definition">#</a></dt>
<dd><p>Calculate spectral component based on the magnitude of Fast Fourier Transform (FFT).</p>
<dl class="simple">
<dt>Based on:</dt><dd><p>Dhariwal, et al. ‘Jukebox: A generative model for music.’ <a class="reference external" href="https://arxiv.org/abs/2005.00341">https://arxiv.org/abs/2005.00341</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spatial_dims</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of spatial dimensions.</p></li>
<li><p><strong>fft_signal_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – signal size in the transformed dimensions. See torch.fft.fftn() for more information.</p></li>
<li><p><strong>fft_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;forward&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;backward&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ortho&quot;</span></code>} Specifies the normalization mode in the fft. See
torch.fft.fftn() for more information.</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<a class="reference internal" href="utils.html#monai.utils.enums.LossReduction" title="monai.utils.enums.LossReduction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossReduction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – <p>{<code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>}
Specifies the reduction to apply to the output. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no reduction will be applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>: the sum of the output will be divided by the number of elements in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>: the output will be summed.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.JukeboxLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/spectral_loss.py#L57-L72"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.JukeboxLoss.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="sureloss">
<h3><cite>SURELoss</cite><a class="headerlink" href="#sureloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.SURELoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">SURELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturb_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/sure_loss.py#L111-L200"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SURELoss" title="Link to this definition">#</a></dt>
<dd><p>Calculate the Stein’s Unbiased Risk Estimator (SURE) loss for a given operator.</p>
<p>This is a differentiable loss function that can be used to train/guide an
operator (e.g. neural network), where the pseudo ground truth is available
but the reference ground truth is not. For example, in the MRI
reconstruction, the pseudo ground truth is the zero-filled reconstruction
and the reference ground truth is the fully sampled reconstruction.  Often,
the reference ground truth is not available due to the lack of fully sampled
data.</p>
<p>The original SURE loss is proposed in [1]. The SURE loss used for guiding
the diffusion model based MRI reconstruction is proposed in [2].</p>
<p>Reference</p>
<p>[1] Stein, C.M.: Estimation of the mean of a multivariate normal distribution. Annals of Statistics</p>
<p>[2] B. Ozturkler et al. SMRD: SURE-based Robust MRI Reconstruction with Diffusion Models.
(<a class="reference external" href="https://arxiv.org/pdf/2310.01799.pdf">https://arxiv.org/pdf/2310.01799.pdf</a>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.SURELoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturb_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/sure_loss.py#L134-L145"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SURELoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>perturb_noise</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – The noise vector of shape</p></li>
<li><p><strong>(</strong><strong>B</strong> (<em>B</em><em>, </em><em>2</em><em>, </em><em>H</em><em>, </em><em>W</em>)</p></li>
<li><p><strong>C</strong> (<em>B</em><em>, </em><em>2</em><em>, </em><em>H</em><em>, </em><em>W</em>)</p></li>
<li><p><strong>H</strong> (<em>B</em><em>, </em><em>2</em><em>, </em><em>H</em><em>, </em><em>W</em>)</p></li>
<li><p><strong>input</strong> (<em>For real</em>)</p></li>
<li><p><strong>is</strong> (<em>the shape</em>)</p></li>
<li><p><strong>input</strong></p></li>
<li><p><strong>is</strong></p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – The perturbation scalar. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.SURELoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pseudo_gt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/sure_loss.py#L147-L200"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.SURELoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operator</strong> (<em>function</em>) – The operator function that takes in an input</p></li>
<li><p><strong>compute</strong> (<em>tensor x and returns an output tensor y. We will use this to</em>)</p></li>
<li><p><strong>specifically</strong> (<em>the divergence. More</em>)</p></li>
<li><p><strong>a</strong> (<em>we will perturb the input x by</em>)</p></li>
<li><p><strong>output</strong> (<em>and the reference</em>)</p></li>
<li><p><strong>output</strong></p></li>
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The input tensor of shape (B, C, H, W) to the</p></li>
<li><p><strong>2</strong> (<em>W</em><em>) </em><em>used to compute the L2 loss. C=1 or</em>) – For complex input, the shape is (B, 2, H, W) aka</p></li>
<li><p><strong>input</strong> (<em>B</em><em>, </em><em>2</em><em>, </em><em>H</em><em>, </em><em>W</em>)</p></li>
<li><p><strong>is</strong> (<em>shape</em>)</p></li>
<li><p><strong>y_pseudo_gt</strong> (<em>same shape as</em>) – The pseudo ground truth tensor of shape</p></li>
<li><p><strong>(</strong><strong>B</strong> – For complex</p></li>
<li><p><strong>C</strong> – For complex</p></li>
<li><p><strong>H</strong> – For complex</p></li>
<li><p><strong>2</strong> – For complex</p></li>
<li><p><strong>input</strong></p></li>
<li><p><strong>is</strong></p></li>
<li><p><strong>is</strong></p></li>
<li><p><strong>y_ref</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – The reference output tensor of the</p></li>
<li><p><strong>y_pseudo_gt</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The SURE loss scalar.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sure_loss (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="loss-wrappers">
<h2>Loss Wrappers<a class="headerlink" href="#loss-wrappers" title="Link to this heading">#</a></h2>
<section id="multiscaleloss">
<h3><cite>MultiScaleLoss</cite><a class="headerlink" href="#multiscaleloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.MultiScaleLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">MultiScaleLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/multi_scale.py#L40-L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MultiScaleLoss" title="Link to this definition">#</a></dt>
<dd><p>This is a wrapper class.
It smooths the input and target at different scales before passing them into the wrapped loss function.</p>
<dl class="simple">
<dt>Adapted from:</dt><dd><p>DeepReg (<a class="github reference external" href="https://github.com/DeepRegNet/DeepReg">DeepRegNet/DeepReg</a>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.MultiScaleLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/multi_scale.py#L49-L67"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MultiScaleLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">_Loss</span></code>) – loss function to be wrapped</p></li>
<li><p><strong>scales</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – list of scalars or None, if None, do not apply any scaling.</p></li>
<li><p><strong>kernel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – gaussian or cauchy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.MultiScaleLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/multi_scale.py#L69-L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MultiScaleLoss.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="maskedloss">
<h3><cite>MaskedLoss</cite><a class="headerlink" href="#maskedloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.MaskedLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">MaskedLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">loss_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">loss_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/spatial_mask.py#L25-L70"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MaskedLoss" title="Link to this definition">#</a></dt>
<dd><p>This is a wrapper class for the loss functions.  It allows for additional
weighting masks to be applied to both input and target.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#monai.losses.MaskedDiceLoss" title="monai.losses.MaskedDiceLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">monai.losses.MaskedDiceLoss</span></code></a></p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.MaskedLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">loss_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">loss_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/spatial_mask.py#L34-L48"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MaskedLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">_Loss</span></code>]) – loss function to be wrapped, this could be a loss class or an instance of a loss class.</p></li>
<li><p><strong>loss_args</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – arguments to the loss function’s constructor if <cite>loss</cite> is a class.</p></li>
<li><p><strong>loss_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – keyword arguments to the loss function’s constructor if <cite>loss</cite> is a class.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.MaskedLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/spatial_mask.py#L50-L70"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.MaskedLoss.forward" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – the shape should be BNH[WD].</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – the shape should be B1H[WD] or 11H[WD].</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="deepsupervisionloss">
<h3><cite>DeepSupervisionLoss</cite><a class="headerlink" href="#deepsupervisionloss" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="monai.losses.DeepSupervisionLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">monai.losses.</span></span><span class="sig-name descname"><span class="pre">DeepSupervisionLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ds_loss.py#L21-L83"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DeepSupervisionLoss" title="Link to this definition">#</a></dt>
<dd><p>Wrapper class around the main loss function to accept a list of tensors returned from a deeply
supervised networks. The final loss is computed as the sum of weighted losses for each of deep supervision levels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DeepSupervisionLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ds_loss.py#L27-L43"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DeepSupervisionLoss.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">_Loss</span></code>) – main loss instance, e.g DiceLoss().</p></li>
<li><p><strong>weight_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – {<code class="docutils literal notranslate"><span class="pre">&quot;same&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;exp&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;two&quot;</span></code>}
Specifies the weights calculation for each image level. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;exp&quot;</span></code>.
- <code class="docutils literal notranslate"><span class="pre">&quot;same&quot;</span></code>: all weights are equal to 1.
- <code class="docutils literal notranslate"><span class="pre">&quot;exp&quot;</span></code>: exponentially decreasing weights by a power of 2: 1, 0.5, 0.25, 0.125, etc .
- <code class="docutils literal notranslate"><span class="pre">&quot;two&quot;</span></code>: equal smaller weights for lower levels: 1, 0.5, 0.5, 0.5, 0.5, etc</p></li>
<li><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – a list of weights to apply to each deeply supervised sub-loss, if provided, this will be used
regardless of the weight_mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DeepSupervisionLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ds_loss.py#L73-L83"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DeepSupervisionLoss.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DeepSupervisionLoss.get_loss">
<span class="sig-name descname"><span class="pre">get_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ds_loss.py#L63-L71"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DeepSupervisionLoss.get_loss" title="Link to this definition">#</a></dt>
<dd><p>Calculates a loss output accounting for differences in shapes,
and downsizing targets if necessary (using nearest neighbor interpolation)
Generally downsizing occurs for all level, except for the first (level==0)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="monai.losses.DeepSupervisionLoss.get_weights">
<span class="sig-name descname"><span class="pre">get_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Project-MONAI/MONAI/blob/dev/monai/losses/ds_loss.py#L45-L61"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#monai.losses.DeepSupervisionLoss.get_weights" title="Link to this definition">#</a></dt>
<dd><p>Calculates weights for a given number of scale levels</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="_gen/monai.transforms.utility.dictionary.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">monai.transforms.utility.dictionary</p>
      </div>
    </a>
    <a class="right-next"
       href="networks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Network architectures</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-monai.losses">Segmentation Losses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diceloss"><cite>DiceLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceLoss"><code class="docutils literal notranslate"><span class="pre">DiceLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceLoss.__init__"><code class="docutils literal notranslate"><span class="pre">DiceLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">DiceLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.Dice"><code class="docutils literal notranslate"><span class="pre">Dice</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.dice"><code class="docutils literal notranslate"><span class="pre">dice</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maskeddiceloss"><cite>MaskedDiceLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MaskedDiceLoss"><code class="docutils literal notranslate"><span class="pre">MaskedDiceLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MaskedDiceLoss.__init__"><code class="docutils literal notranslate"><span class="pre">MaskedDiceLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MaskedDiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">MaskedDiceLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalizeddiceloss"><cite>GeneralizedDiceLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedDiceLoss"><code class="docutils literal notranslate"><span class="pre">GeneralizedDiceLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedDiceLoss.__init__"><code class="docutils literal notranslate"><span class="pre">GeneralizedDiceLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedDiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">GeneralizedDiceLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.generalized_dice"><code class="docutils literal notranslate"><span class="pre">generalized_dice</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalizedwassersteindiceloss"><cite>GeneralizedWassersteinDiceLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedWassersteinDiceLoss"><code class="docutils literal notranslate"><span class="pre">GeneralizedWassersteinDiceLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedWassersteinDiceLoss.__init__"><code class="docutils literal notranslate"><span class="pre">GeneralizedWassersteinDiceLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedWassersteinDiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">GeneralizedWassersteinDiceLoss.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedWassersteinDiceLoss.wasserstein_distance_map"><code class="docutils literal notranslate"><span class="pre">GeneralizedWassersteinDiceLoss.wasserstein_distance_map()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.generalized_wasserstein_dice"><code class="docutils literal notranslate"><span class="pre">generalized_wasserstein_dice</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diceceloss"><cite>DiceCELoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceCELoss"><code class="docutils literal notranslate"><span class="pre">DiceCELoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceCELoss.__init__"><code class="docutils literal notranslate"><span class="pre">DiceCELoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceCELoss.bce"><code class="docutils literal notranslate"><span class="pre">DiceCELoss.bce()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceCELoss.ce"><code class="docutils literal notranslate"><span class="pre">DiceCELoss.ce()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceCELoss.forward"><code class="docutils literal notranslate"><span class="pre">DiceCELoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dicefocalloss"><cite>DiceFocalLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceFocalLoss"><code class="docutils literal notranslate"><span class="pre">DiceFocalLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceFocalLoss.__init__"><code class="docutils literal notranslate"><span class="pre">DiceFocalLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiceFocalLoss.forward"><code class="docutils literal notranslate"><span class="pre">DiceFocalLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalizeddicefocalloss"><cite>GeneralizedDiceFocalLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedDiceFocalLoss"><code class="docutils literal notranslate"><span class="pre">GeneralizedDiceFocalLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GeneralizedDiceFocalLoss.forward"><code class="docutils literal notranslate"><span class="pre">GeneralizedDiceFocalLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#focalloss"><cite>FocalLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.FocalLoss"><code class="docutils literal notranslate"><span class="pre">FocalLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.FocalLoss.__init__"><code class="docutils literal notranslate"><span class="pre">FocalLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.FocalLoss.forward"><code class="docutils literal notranslate"><span class="pre">FocalLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tverskyloss"><cite>TverskyLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.TverskyLoss"><code class="docutils literal notranslate"><span class="pre">TverskyLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.TverskyLoss.__init__"><code class="docutils literal notranslate"><span class="pre">TverskyLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.TverskyLoss.forward"><code class="docutils literal notranslate"><span class="pre">TverskyLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#contrastiveloss"><cite>ContrastiveLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.ContrastiveLoss"><code class="docutils literal notranslate"><span class="pre">ContrastiveLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.ContrastiveLoss.__init__"><code class="docutils literal notranslate"><span class="pre">ContrastiveLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.ContrastiveLoss.forward"><code class="docutils literal notranslate"><span class="pre">ContrastiveLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#barlowtwinsloss"><cite>BarlowTwinsLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.BarlowTwinsLoss"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.BarlowTwinsLoss.__init__"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.BarlowTwinsLoss.forward"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hausdorffdtloss"><cite>HausdorffDTLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.HausdorffDTLoss"><code class="docutils literal notranslate"><span class="pre">HausdorffDTLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.HausdorffDTLoss.__init__"><code class="docutils literal notranslate"><span class="pre">HausdorffDTLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.HausdorffDTLoss.distance_field"><code class="docutils literal notranslate"><span class="pre">HausdorffDTLoss.distance_field()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.HausdorffDTLoss.forward"><code class="docutils literal notranslate"><span class="pre">HausdorffDTLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#softcldiceloss"><cite>SoftclDiceLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SoftclDiceLoss"><code class="docutils literal notranslate"><span class="pre">SoftclDiceLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SoftclDiceLoss.__init__"><code class="docutils literal notranslate"><span class="pre">SoftclDiceLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SoftclDiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">SoftclDiceLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#softdicecldiceloss"><cite>SoftDiceclDiceLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SoftDiceclDiceLoss"><code class="docutils literal notranslate"><span class="pre">SoftDiceclDiceLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SoftDiceclDiceLoss.__init__"><code class="docutils literal notranslate"><span class="pre">SoftDiceclDiceLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SoftDiceclDiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">SoftDiceclDiceLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naclloss"><cite>NACLLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.NACLLoss"><code class="docutils literal notranslate"><span class="pre">NACLLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.NACLLoss.__init__"><code class="docutils literal notranslate"><span class="pre">NACLLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.NACLLoss.forward"><code class="docutils literal notranslate"><span class="pre">NACLLoss.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.NACLLoss.get_constr_target"><code class="docutils literal notranslate"><span class="pre">NACLLoss.get_constr_target()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#registration-losses">Registration Losses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bendingenergyloss"><cite>BendingEnergyLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.BendingEnergyLoss"><code class="docutils literal notranslate"><span class="pre">BendingEnergyLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.BendingEnergyLoss.__init__"><code class="docutils literal notranslate"><span class="pre">BendingEnergyLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.BendingEnergyLoss.forward"><code class="docutils literal notranslate"><span class="pre">BendingEnergyLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusionloss"><cite>DiffusionLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiffusionLoss"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiffusionLoss.__init__"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DiffusionLoss.forward"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localnormalizedcrosscorrelationloss"><cite>LocalNormalizedCrossCorrelationLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.LocalNormalizedCrossCorrelationLoss"><code class="docutils literal notranslate"><span class="pre">LocalNormalizedCrossCorrelationLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.LocalNormalizedCrossCorrelationLoss.__init__"><code class="docutils literal notranslate"><span class="pre">LocalNormalizedCrossCorrelationLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.LocalNormalizedCrossCorrelationLoss.forward"><code class="docutils literal notranslate"><span class="pre">LocalNormalizedCrossCorrelationLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#globalmutualinformationloss"><cite>GlobalMutualInformationLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GlobalMutualInformationLoss"><code class="docutils literal notranslate"><span class="pre">GlobalMutualInformationLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GlobalMutualInformationLoss.__init__"><code class="docutils literal notranslate"><span class="pre">GlobalMutualInformationLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GlobalMutualInformationLoss.forward"><code class="docutils literal notranslate"><span class="pre">GlobalMutualInformationLoss.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GlobalMutualInformationLoss.parzen_windowing_b_spline"><code class="docutils literal notranslate"><span class="pre">GlobalMutualInformationLoss.parzen_windowing_b_spline()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.GlobalMutualInformationLoss.parzen_windowing_gaussian"><code class="docutils literal notranslate"><span class="pre">GlobalMutualInformationLoss.parzen_windowing_gaussian()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reconstruction-losses">Reconstruction Losses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ssimloss"><cite>SSIMLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.ssim_loss.SSIMLoss"><code class="docutils literal notranslate"><span class="pre">SSIMLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.ssim_loss.SSIMLoss.__init__"><code class="docutils literal notranslate"><span class="pre">SSIMLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.ssim_loss.SSIMLoss.forward"><code class="docutils literal notranslate"><span class="pre">SSIMLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#patchadversarialloss"><cite>PatchAdversarialLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.PatchAdversarialLoss"><code class="docutils literal notranslate"><span class="pre">PatchAdversarialLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.PatchAdversarialLoss.forward"><code class="docutils literal notranslate"><span class="pre">PatchAdversarialLoss.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.PatchAdversarialLoss.get_target_tensor"><code class="docutils literal notranslate"><span class="pre">PatchAdversarialLoss.get_target_tensor()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.PatchAdversarialLoss.get_zero_tensor"><code class="docutils literal notranslate"><span class="pre">PatchAdversarialLoss.get_zero_tensor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptualloss"><cite>PerceptualLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.PerceptualLoss"><code class="docutils literal notranslate"><span class="pre">PerceptualLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.PerceptualLoss.forward"><code class="docutils literal notranslate"><span class="pre">PerceptualLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jukeboxloss"><cite>JukeboxLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.JukeboxLoss"><code class="docutils literal notranslate"><span class="pre">JukeboxLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.JukeboxLoss.forward"><code class="docutils literal notranslate"><span class="pre">JukeboxLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sureloss"><cite>SURELoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SURELoss"><code class="docutils literal notranslate"><span class="pre">SURELoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SURELoss.__init__"><code class="docutils literal notranslate"><span class="pre">SURELoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.SURELoss.forward"><code class="docutils literal notranslate"><span class="pre">SURELoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loss-wrappers">Loss Wrappers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiscaleloss"><cite>MultiScaleLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MultiScaleLoss"><code class="docutils literal notranslate"><span class="pre">MultiScaleLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MultiScaleLoss.__init__"><code class="docutils literal notranslate"><span class="pre">MultiScaleLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MultiScaleLoss.forward"><code class="docutils literal notranslate"><span class="pre">MultiScaleLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maskedloss"><cite>MaskedLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MaskedLoss"><code class="docutils literal notranslate"><span class="pre">MaskedLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MaskedLoss.__init__"><code class="docutils literal notranslate"><span class="pre">MaskedLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.MaskedLoss.forward"><code class="docutils literal notranslate"><span class="pre">MaskedLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepsupervisionloss"><cite>DeepSupervisionLoss</cite></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DeepSupervisionLoss"><code class="docutils literal notranslate"><span class="pre">DeepSupervisionLoss</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DeepSupervisionLoss.__init__"><code class="docutils literal notranslate"><span class="pre">DeepSupervisionLoss.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DeepSupervisionLoss.forward"><code class="docutils literal notranslate"><span class="pre">DeepSupervisionLoss.forward()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DeepSupervisionLoss.get_loss"><code class="docutils literal notranslate"><span class="pre">DeepSupervisionLoss.get_loss()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#monai.losses.DeepSupervisionLoss.get_weights"><code class="docutils literal notranslate"><span class="pre">DeepSupervisionLoss.get_weights()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/losses.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright MONAI Consortium.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>